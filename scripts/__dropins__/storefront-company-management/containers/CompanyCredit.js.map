{"version":3,"file":"CompanyCredit.js","sources":["/@dropins/storefront-company-management/src/hooks/containers/useCompanyCreditHistory.tsx","/@dropins/storefront-company-management/src/components/CompanyCreditDisplay/CompanyCreditDisplay.tsx","/@dropins/storefront-company-management/src/components/CompanyCreditHistoryDisplay/CompanyCreditHistoryDisplay.tsx","/@dropins/storefront-company-management/src/containers/CompanyCredit/CompanyCredit.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useEffect, useState, useCallback, useRef, useMemo } from 'preact/hooks';\nimport { getCompanyCreditHistory } from '@/company-management/api';\nimport { CompanyCreditHistoryItem } from '@/company-management/data/models';\nimport { GetCompanyCreditHistoryParams } from '@/company-management/types/api/getCompanyCreditHistoryParams.types';\n\n// Constants\nconst DEFAULT_PAGE_SIZE = 10;\nconst FIRST_PAGE = 1;\n\nexport interface UseCompanyCreditHistoryProps {\n  /** Initial parameters for the credit history query */\n  initialParams?: GetCompanyCreditHistoryParams;\n  /** Translations for accessibility announcements */\n  translations: {\n    ariaDataLoaded: string;\n    ariaDataError: string;\n  };\n}\n\nexport interface UseCompanyCreditHistoryReturn {\n  // Core data\n  items: CompanyCreditHistoryItem[];\n  \n  // Pagination state\n  currentPage: number;\n  pageSize: number;\n  totalItems: number;\n  totalPages: number;\n  \n  // Loading states\n  loading: boolean;\n  \n  // UI state\n  announcement: string;\n  \n  // Actions\n  handlePageSizeChange: (event: Event | { target?: { value: string } } | string) => void;\n  handlePreviousPage: () => void;\n  handleNextPage: () => void;\n  handlePageChange: (page: number) => void;\n  refreshCreditHistory: () => Promise<void>;\n}\n\nexport const useCompanyCreditHistory = ({ \n  initialParams = {}, \n  translations \n}: UseCompanyCreditHistoryProps): UseCompanyCreditHistoryReturn => {\n  const [items, setItems] = useState<CompanyCreditHistoryItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [currentPage, setCurrentPage] = useState(initialParams.currentPage || FIRST_PAGE);\n  const [pageSize, setPageSize] = useState(initialParams.pageSize || DEFAULT_PAGE_SIZE);\n  const [totalItems, setTotalItems] = useState(0);\n  const [totalPages, setTotalPages] = useState(1);\n  const [announcement, setAnnouncement] = useState('');\n\n  // Stable reference to translations to prevent unnecessary re-renders\n  const translationsRef = useRef(translations);\n  translationsRef.current = translations;\n\n  // Keep track of initial params\n  const initialParamsRef = useRef(initialParams);\n\n  // Memoized params for API call\n  const apiParams = useMemo((): GetCompanyCreditHistoryParams => ({\n    ...initialParamsRef.current,\n    currentPage,\n    pageSize,\n  }), [currentPage, pageSize]);\n\n  // Fetch credit history data\n  const fetchCreditHistory = useCallback(async () => {\n    setLoading(true);\n    try {\n      const response = await getCompanyCreditHistory(apiParams);\n      \n      if (response) {\n        // Batch state updates for better performance\n        setItems(response.items);\n        setTotalItems(response.totalCount || response.items.length);\n        setTotalPages(response.pageInfo?.totalPages || 1);\n        setAnnouncement(\n          translationsRef.current.ariaDataLoaded.replace(\n            '{count}', \n            response.items.length.toString()\n          )\n        );\n      } else {\n        // Handle null response (treat as no data, not error)\n        setItems([]);\n        setTotalItems(0);\n        setTotalPages(1);\n        setAnnouncement(\n          translationsRef.current.ariaDataLoaded.replace('{count}', '0')\n        );\n      }\n    } catch (error) {\n      console.error('Failed to load company credit history:', error);\n      // Batch error state updates\n      setItems([]);\n      setTotalItems(0);\n      setTotalPages(1);\n      setAnnouncement(translationsRef.current.ariaDataError);\n    } finally {\n      setLoading(false);\n    }\n  }, [apiParams]);\n\n  // Fetch credit history when dependencies change\n  useEffect(() => {\n    fetchCreditHistory();\n  }, [fetchCreditHistory]);\n\n  // Handle page size change\n  const handlePageSizeChange = useCallback((event: Event | { target?: { value: string } } | string) => {\n    let value: string;\n    if (typeof event === 'string') {\n      value = event;\n    } else if ('target' in event && event.target && 'value' in event.target) {\n      value = event.target.value;\n    } else {\n      return;\n    }\n    const newSize = parseInt(value, 10);\n    if (!isNaN(newSize)) {\n      setPageSize(newSize);\n      setCurrentPage(FIRST_PAGE); // Reset to first page when page size changes\n    }\n  }, []);\n\n  // Handle page navigation\n  const handlePreviousPage = useCallback(() => {\n    if (currentPage > 1) {\n      setCurrentPage(currentPage - 1);\n    }\n  }, [currentPage]);\n\n  const handleNextPage = useCallback(() => {\n    if (currentPage < totalPages) {\n      setCurrentPage(currentPage + 1);\n    }\n  }, [currentPage, totalPages]);\n\n  // Handle direct page change (for pagination buttons like First, Last)\n  const handlePageChange = useCallback((page: number) => {\n    if (page >= 1 && page <= totalPages && page !== currentPage) {\n      setCurrentPage(page);\n    }\n  }, [currentPage, totalPages]);\n\n  // Expose refresh function for external use (e.g., after company context changes)\n  const refreshCreditHistory = useCallback(async () => {\n    await fetchCreditHistory();\n  }, [fetchCreditHistory]);\n\n  return {\n    // Core data\n    items,\n    \n    // Pagination state\n    currentPage,\n    pageSize,\n    totalItems,\n    totalPages,\n    \n    // Loading states\n    loading,\n    \n    // UI state\n    announcement,\n    \n    // Actions\n    handlePageSizeChange,\n    handlePreviousPage,\n    handleNextPage,\n    handlePageChange,\n    refreshCreditHistory,\n  };\n};","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { FunctionComponent } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\nimport '@/company-management/components/CompanyCreditDisplay/CompanyCreditDisplay.css';\nimport { Card, IllustratedMessage, Price } from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { events } from '@adobe-commerce/event-bus';\nimport { CompanyCreditInfo } from '@/company-management/data/models';\nimport { getCompanyCredit } from '@/company-management/api/getCompanyCredit';\nimport { CompanyCreditLoader } from '@/company-management/components/CompanyLoaders';\n\nexport interface CompanyCreditDisplayProps extends HTMLAttributes<HTMLDivElement> {\n  // No props needed - component manages its own data\n}\n\nexport const CompanyCreditDisplay: FunctionComponent<CompanyCreditDisplayProps> = ({\n  className,\n  ...props\n}) => {\n  const translations = useText({\n    creditAvailable: 'Company.CompanyCredit.creditAvailable',\n    creditLimit: 'Company.CompanyCredit.creditLimit',\n    outstandingBalance: 'Company.CompanyCredit.outstandingBalance',\n    loading: 'Company.shared.messages.loading',\n    loadError: 'Company.CompanyCredit.messages.loadError',\n    emptyTitle: 'Company.CompanyCredit.emptyState.title',\n    emptyMessage: 'Company.CompanyCredit.emptyState.message',\n  });\n\n  const [companyCreditData, setCompanyCreditData] = useState<CompanyCreditInfo | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Keep stable references to avoid re-creating callbacks/effects\n  const inFlightRef = useRef<boolean>(false);\n  const didInitialFetchRef = useRef<boolean>(false);\n\n  const fetchCompanyCredit = useCallback(async () => {\n    if (inFlightRef.current) {\n      return;\n    }\n    inFlightRef.current = true;\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const companyCreditInfo: CompanyCreditInfo | null = await getCompanyCredit();\n      setCompanyCreditData(companyCreditInfo);\n    } catch (error) {\n      console.error('Failed to load company credit:', error);\n      setError(translations.loadError);\n      setCompanyCreditData(null);\n    } finally {\n      setLoading(false);\n      inFlightRef.current = false;\n    }\n  }, [translations.loadError]);\n\n  // Initial data fetch\n  useEffect(() => {\n    if (!didInitialFetchRef.current) {\n      didInitialFetchRef.current = true;\n      fetchCompanyCredit();\n    }\n  }, [fetchCompanyCredit]);\n\n  // Listen to company context changes\n  useEffect(() => {\n    const handleCompanyContextChange = () => {\n      setCompanyCreditData(null);\n      didInitialFetchRef.current = false; // Allow re-fetch on context change\n      fetchCompanyCredit();\n    };\n\n    // Use the same event pattern as other company components\n    const subscription = events.on(\n      'companyContext/changed',\n      handleCompanyContextChange,\n      { eager: true }\n    );\n    \n    return () => {\n      subscription?.off?.();\n    };\n  }, [fetchCompanyCredit]);\n\n  if (loading) {\n    return (\n      <div {...props} className={className}>\n        <Card\n          variant=\"primary\"\n          className=\"company-management-company-credit-loading\"\n        >\n          <CompanyCreditLoader testId=\"companyCreditLoader\"/>\n        </Card>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div {...props} className={className}>\n        <div className=\"company-management-company-credit-empty\">\n          <IllustratedMessage\n            heading={error}\n            message={<p>{error}</p>}\n          />\n        </div>\n      </div>\n    );\n  }\n  return (\n    <div {...props} className={className}>\n      {companyCreditData === null || !companyCreditData.credit ? (\n        <div className=\"company-management-company-credit-empty\">\n          <IllustratedMessage\n            heading={translations.emptyTitle || 'No Credit Information'}\n            message={<p>{translations.emptyMessage || 'There is no credit information to display.'}</p>}\n          />\n        </div>\n      ) : (\n        <div className=\"company-management-company-credit-grid\">\n          <Card\n            variant=\"secondary\"\n            className=\"company-management-company-credit-outstanding-balance\"\n          >\n            <p>{translations.outstandingBalance}<br/>\n            <Price \n              size='large'\n              amount={companyCreditData.credit.outstanding_balance?.value ?? 0} \n              currency={companyCreditData.credit.outstanding_balance?.currency ?? ''} \n              className={(companyCreditData.credit.outstanding_balance?.value ?? 0) < 0 ? 'company-management-company-credit-negative' : undefined}\n            /></p>\n          </Card>\n          <Card\n            variant=\"secondary\"\n            className=\"company-management-company-credit-available-credit\"\n          >\n            <p>{translations.creditAvailable}<br/>\n            <Price\n              size='large'\n              amount={companyCreditData.credit.available_credit?.value ?? 0} \n              currency={companyCreditData.credit.available_credit?.currency ?? ''} \n              className={(companyCreditData.credit.available_credit?.value ?? 0) < 0 ? 'company-management-company-credit-negative' : undefined}\n            /></p>\n          </Card>\n          <Card\n            variant=\"secondary\"\n            className=\"company-management-company-credit-credit-limit\"\n            >\n              <p>{translations.creditLimit}<br/>\n              <Price \n                size='large'\n                amount={companyCreditData.credit.credit_limit?.value ?? 0} \n                currency={companyCreditData.credit.credit_limit?.currency ?? ''} \n                className={(companyCreditData.credit.credit_limit?.value ?? 0) < 0 ? '.company-management-company-credit-grid .company-management-company-credit-negative' : undefined}\n              /></p>\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { FunctionComponent } from 'preact';\nimport { useMemo, useEffect } from 'preact/hooks';\nimport { HTMLAttributes } from 'preact/compat';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport { IllustratedMessage, Pagination, Picker, Price, ProgressSpinner, Table } from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { events } from '@adobe-commerce/event-bus';\nimport { useCompanyCreditHistory } from '@/company-management/hooks/containers';\nimport './CompanyCreditHistoryDisplay.css';\n\nexport interface CompanyCreditHistoryDisplayProps extends Omit<HTMLAttributes<HTMLDivElement>, 'loading'> {\n  /**\n   * Optional initial parameters for credit history filtering and pagination\n   */\n  initialParams?: {\n    pageSize?: number;\n    currentPage?: number;\n    filter?: any;\n  };\n}\n\n// Constants\nconst PAGE_SIZE_OPTIONS = [\n  { text: '10', value: '10' },\n  { text: '20', value: '20' },\n  { text: '50', value: '50' },\n  { text: '100', value: '100' }\n];\n\nconst SKELETON_ROW_COUNT = 10;\n\n/**\n * Converts operation type from SCREAMING_SNAKE_CASE to Title Case\n * @param operationType - The operation type string (e.g., \"CREDIT_ADJUSTMENT\", \"PURCHASE\")\n * @returns Formatted string in title case (e.g., \"Credit Adjustment\", \"Purchase\")\n */\nconst formatOperationType = (operationType: string): string => {\n  return operationType\n    .split('_')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join(' ');\n};\n\n/**\n * Formats a date string to the standardized format \"Nov 4, 2025 3:04 AM\"\n * @param dateString - ISO date string\n * @returns Formatted date string\n */\nconst formatDate = (dateString: string): string => {\n  const date = new Date(dateString);\n  return date.toLocaleDateString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric',\n    hour: 'numeric',\n    minute: '2-digit',\n    hour12: true\n  });\n};\n\nexport const CompanyCreditHistoryDisplay: FunctionComponent<CompanyCreditHistoryDisplayProps> = ({\n  className,\n  initialParams = {},\n  ...props\n}) => {\n  const translations = useText({\n    // Empty state\n    emptyTitle: 'Company.CompanyCreditHistory.emptyState.title',\n    emptyMessage: 'Company.CompanyCreditHistory.emptyState.message',\n    // Table columns\n    dateColumn: 'Company.CompanyCreditHistory.columns.date',\n    operationColumn: 'Company.CompanyCreditHistory.columns.operation',\n    amountColumn: 'Company.CompanyCreditHistory.columns.amount', \n    outstandingBalanceColumn: 'Company.CompanyCreditHistory.columns.outstandingBalance',\n    availableCreditColumn: 'Company.CompanyCreditHistory.columns.availableCredit',\n    creditLimitColumn: 'Company.CompanyCreditHistory.columns.creditLimit',\n    customReferenceColumn: 'Company.CompanyCreditHistory.columns.customReference',\n    updatedByColumn: 'Company.CompanyCreditHistory.columns.updatedBy',\n    // Pagination\n    itemsRangeText: 'Company.CompanyCreditHistory.pagination.itemsRange',\n    showLabel: 'Company.CompanyCreditHistory.pagination.show',\n    // Accessibility labels\n    ariaDataLoaded: 'Company.CompanyCreditHistory.ariaLabels.dataLoaded',\n    ariaDataError: 'Company.CompanyCreditHistory.ariaLabels.dataError',\n    ariaHistoryTable: 'Company.CompanyCreditHistory.ariaLabels.historyTable',\n    ariaPaginationNav: 'Company.CompanyCreditHistory.ariaLabels.paginationNav',\n    ariaPageSizeSelector: 'Company.CompanyCreditHistory.ariaLabels.pageSizeSelector',\n    ariaShowingHistory: 'Company.CompanyCreditHistory.ariaLabels.showingHistory',\n  });\n\n  // Use the credit history hook - component now manages its own data\n  const {\n    items,\n    loading,\n    currentPage,\n    pageSize,\n    totalItems,\n    totalPages,\n    announcement,\n    handlePageSizeChange,\n    handlePageChange,\n    refreshCreditHistory,\n  } = useCompanyCreditHistory({\n    initialParams,\n    translations: {\n      ariaDataLoaded: translations.ariaDataLoaded,\n      ariaDataError: translations.ariaDataError\n    }\n  });\n\n  // Calculate item range for display\n  const startItem = totalItems === 0 ? 0 : (currentPage - 1) * pageSize + 1;\n  const endItem = Math.min(currentPage * pageSize, totalItems);\n\n  // Listen to company context changes\n  useEffect(() => {\n    const handleCompanyContextChange = () => {\n      refreshCreditHistory();\n    };\n\n    const subscription = events.on(\n      'companyContext/changed',\n      handleCompanyContextChange,\n      { eager: true }\n    );\n    \n    return () => {\n      subscription?.off?.();\n    };\n  }, [refreshCreditHistory]);\n\n  // Prepare table columns - memoized to prevent unnecessary re-renders\n  const columns = useMemo(() => [\n    { key: 'date', label: translations.dateColumn },\n    { key: 'operation', label: translations.operationColumn },\n    { key: 'amount', label: translations.amountColumn },\n    { key: 'outstandingBalance', label: translations.outstandingBalanceColumn },\n    { key: 'availableCredit', label: translations.availableCreditColumn },\n    { key: 'creditLimit', label: translations.creditLimitColumn },\n    { key: 'customReference', label: translations.customReferenceColumn },\n    { key: 'updatedBy', label: translations.updatedByColumn }\n  ], [\n    translations.dateColumn,\n    translations.operationColumn, \n    translations.amountColumn,\n    translations.outstandingBalanceColumn,\n    translations.availableCreditColumn,\n    translations.creditLimitColumn,\n    translations.customReferenceColumn,\n    translations.updatedByColumn\n  ]);\n\n  // Prepare table row data - memoized for performance\n  const rowData = useMemo(() => items.map((item) => ({\n    date: formatDate(item.date),\n    operation: formatOperationType(item.type),\n    amount: item.amount.value === 0 ? '' : (\n        <Price \n          amount={item.amount.value} \n          currency={item.amount.currency}\n        className=\"company-management-credit-history-price\"\n        />\n    ),\n    outstandingBalance: (\n      <Price \n        amount={item.balance.outstandingBalance.value} \n        currency={item.balance.outstandingBalance.currency}\n        className=\"company-management-credit-history-price\"\n      />\n    ),\n    availableCredit: (\n      <Price \n        amount={item.balance.availableCredit.value} \n        currency={item.balance.availableCredit.currency}\n        className=\"company-management-credit-history-price\"\n      />\n    ),\n    creditLimit: (\n      <Price \n        amount={item.balance.creditLimit.value} \n        currency={item.balance.creditLimit.currency}\n        className=\"company-management-credit-history-price\"\n      />\n    ),\n    customReference: item.customReferenceNumber || '',\n    updatedBy: item.updatedBy.name\n  })), [items]);\n\n  // Check if we should show empty state\n  const showEmptyState = !loading && items.length === 0;\n\n  // Render empty state with IllustratedMessage\n  if (showEmptyState) {\n    return (\n      <section {...props} className={classes(['company-management-company-credit-history-display', className])}>\n        <div className=\"sr-only\" role=\"status\" aria-live=\"polite\" aria-atomic=\"true\">\n          {announcement}\n        </div>\n        <div className=\"company-management-credit-history-empty\">\n          <IllustratedMessage\n            heading={translations.emptyTitle || 'No Credit History'}\n            message={<p>{translations.emptyMessage || 'There is no credit history to display.'}</p>}\n          />\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    <section {...props} className={classes(['company-management-company-credit-history-display', className])}>\n      {/* Screen reader announcements */}\n      <div className=\"sr-only\" role=\"status\" aria-live=\"polite\" aria-atomic=\"true\">\n        {announcement}\n      </div>\n\n      {/* Table with loading state */}\n      <div aria-busy={loading}>\n        <Table\n          className=\"company-management-company-credit-history-table\"\n          columns={columns}\n          rowData={rowData}\n          mobileLayout=\"stacked\"\n          loading={loading}\n          skeletonRowCount={SKELETON_ROW_COUNT}\n          aria-label={translations.ariaHistoryTable}\n          summary={translations.ariaShowingHistory.replace('{count}', items.length.toString())}\n          tabIndex={0}\n        />\n      </div>\n\n      {/* Table Footer with Items Range and Pagination */}\n      {!loading && (\n        <nav aria-label={translations.ariaPaginationNav} className=\"table-footer\">\n          {/* Items range on the left */}\n          <div className=\"table-footer-left\">\n            <span className=\"item-count\" aria-live=\"polite\" aria-atomic=\"true\">\n              {(translations.itemsRangeText || 'Items {start}-{end} of {total}')\n              .replace('{start}', startItem.toString())\n              .replace('{end}', endItem.toString())\n              .replace('{total}', totalItems.toString())}\n            </span>\n          </div>\n\n          {/* Pagination in the center (only show when multiple pages) */}\n          {totalPages > 1 && (\n            <div className=\"table-footer-center\">\n              <Pagination\n                currentPage={currentPage}\n                totalPages={totalPages}\n                onChange={handlePageChange}\n              />\n            </div>\n          )}\n\n          {/* Page size picker on the right */}\n          <div className=\"table-footer-right\">\n            <div className=\"pagination-controls\">\n              <span className=\"pagination-label\">\n                {translations.showLabel || 'Show'}\n              </span>\n              {loading ? (\n                <div className=\"page-size-loading\">\n                  <ProgressSpinner size=\"small\" />\n                </div>\n              ) : (\n            <Picker\n              value={pageSize.toString()}\n                  onChange={handlePageSizeChange}\n              options={PAGE_SIZE_OPTIONS}\n                  className=\"page-size-picker\"\n                  aria-label={translations.ariaPageSizeSelector || 'Items per page'}\n            />\n              )}\n            </div>\n          </div>\n        </nav>\n      )}\n    </section>\n  );\n};","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { HTMLAttributes } from 'preact/compat';\nimport { Container } from '@adobe-commerce/elsie/lib';\nimport { CompanyCreditDisplay } from '@/company-management/components/CompanyCreditDisplay';\nimport { CompanyCreditHistoryDisplay } from '@/company-management/components/CompanyCreditHistoryDisplay';\nimport { GetCompanyCreditHistoryParams } from '@/company-management/types/api/getCompanyCreditHistoryParams.types';\n\nexport interface CompanyCreditProps extends HTMLAttributes<HTMLDivElement> {\n  /**\n   * Optional parameters for credit history filtering and pagination\n   */\n  creditHistoryParams?: GetCompanyCreditHistoryParams;\n  \n  /**\n   * Whether to show the credit history section\n   */\n  showCreditHistory?: boolean;\n}\n    \nexport const CompanyCredit: Container<CompanyCreditProps> = ({ \n  creditHistoryParams = {}, \n  showCreditHistory = true,\n  className,\n  children,\n  ...props \n}) => {\n  return (\n    <section {...props} className={className}>\n      <CompanyCreditDisplay />\n      \n      {showCreditHistory && (\n        <CompanyCreditHistoryDisplay\n          initialParams={creditHistoryParams}\n        />\n      )}\n\n      {children}\n    </section>\n  );\n};\n"],"names":["DEFAULT_PAGE_SIZE","FIRST_PAGE","useCompanyCreditHistory","initialParams","translations","items","setItems","useState","loading","setLoading","currentPage","setCurrentPage","pageSize","setPageSize","totalItems","setTotalItems","totalPages","setTotalPages","announcement","setAnnouncement","translationsRef","useRef","initialParamsRef","apiParams","useMemo","fetchCreditHistory","useCallback","response","getCompanyCreditHistory","_a","error","useEffect","handlePageSizeChange","event","value","newSize","handlePreviousPage","handleNextPage","handlePageChange","page","refreshCreditHistory","CompanyCreditDisplay","className","props","useText","companyCreditData","setCompanyCreditData","setError","inFlightRef","didInitialFetchRef","fetchCompanyCredit","companyCreditInfo","getCompanyCredit","handleCompanyContextChange","subscription","events","jsx","Card","CompanyCreditLoader","IllustratedMessage","jsxs","Price","_b","_c","_d","_e","_f","_g","_h","_i","PAGE_SIZE_OPTIONS","SKELETON_ROW_COUNT","formatOperationType","operationType","word","formatDate","dateString","CompanyCreditHistoryDisplay","startItem","endItem","columns","rowData","item","classes","Table","Pagination","ProgressSpinner","Picker","CompanyCredit","creditHistoryParams","showCreditHistory","children"],"mappings":"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"}