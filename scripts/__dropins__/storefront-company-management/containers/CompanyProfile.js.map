{"version":3,"file":"CompanyProfile.js","sources":["/@dropins/storefront-company-management/src/components/CompanyProfileCard/CompanyProfileCard.tsx","/@dropins/storefront-company-management/src/hooks/containers/useCompanyProfile.ts","/@dropins/storefront-company-management/src/hooks/useCountries.ts","/@dropins/storefront-company-management/src/components/EditCompanyProfile/CompanyAccountFields.tsx","/@dropins/storefront-company-management/src/components/EditCompanyProfile/LegalAddressFields.tsx","/@dropins/storefront-company-management/src/components/EditCompanyProfile/EditCompanyProfile.tsx","/@dropins/storefront-company-management/src/containers/CompanyProfile/CompanyProfile.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { FunctionComponent } from 'preact';\nimport { Card, Button, IllustratedMessage } from '@adobe-commerce/elsie/components';\nimport { classes, Slot } from '@adobe-commerce/elsie/lib';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { CompanyProfileCardProps } from '../../types/companyProfile.types';\nimport './CompanyProfileCard.css';\n\nexport const CompanyProfileCard: FunctionComponent<CompanyProfileCardProps> = ({\n  company,\n  slots,\n  showEditForm,\n  handleShowEditForm,\n}) => {\n  const translations = useText({\n    editButton: 'Company.shared.buttons.edit',\n    noDataMessage: 'Company.CompanyProfile.companyProfileCard.noDataMessage',\n    companyName: 'Company.shared.fields.companyName',\n    email: 'Company.shared.fields.email',\n    legalName: 'Company.shared.fields.legalName',\n    vatTaxId: 'Company.shared.fields.vatTaxId',\n    resellerId: 'Company.shared.fields.resellerId',\n    legalAddress: 'Company.shared.fields.legalAddress',\n    contacts: 'Company.CompanyProfile.companyProfileCard.contacts',\n    companyAdministrator: 'Company.CompanyProfile.companyProfileCard.companyAdministrator',\n    salesRepresentative: 'Company.CompanyProfile.companyProfileCard.salesRepresentative',\n    paymentInformation: 'Company.CompanyProfile.companyProfileCard.paymentInformation',\n    shippingInformation: 'Company.CompanyProfile.companyProfileCard.shippingInformation',\n    availablePaymentMethods: 'Company.CompanyProfile.companyProfileCard.availablePaymentMethods',\n    availableShippingMethods: 'Company.CompanyProfile.companyProfileCard.availableShippingMethods',\n    noPaymentMethods: 'Company.CompanyProfile.companyProfileCard.noPaymentMethods',\n    noShippingMethods: 'Company.CompanyProfile.companyProfileCard.noShippingMethods',\n  });\n    \n  if (!company) {\n    return (\n      <Card variant=\"secondary\" className=\"account-company-profile-card\">\n        <div className=\"account-company-profile-card__wrapper\">\n          <div className=\"account-company-profile-card__content\">\n            <div className=\"account-company-profile-card__no-data\">\n              <IllustratedMessage\n                message={<p>{translations.noDataMessage}</p>}\n              />\n            </div>\n          </div>\n        </div>\n      </Card>\n    );\n  }\n\n  const perms = company.permissionsFlags || {\n    canViewAccount: true,\n    canEditAccount: false,\n    canViewAddress: true,\n    canEditAddress: false,\n    canViewContacts: true,\n    canViewPaymentInformation: true,\n    canViewShippingInformation: true,\n  };\n\n  const companyData = [\n    perms.canViewAccount ? { \n      name: 'name', \n      label: translations.companyName, \n      value: company.name || '',\n      legalName: company.legalName || ''\n    } : null,\n    perms.canViewAccount ? { name: 'email', label: translations.email, value: company.email || '' } : null,\n    perms.canViewAccount ? { name: 'vatTaxId', label: translations.vatTaxId, value: company.vatTaxId || '' } : null,\n    perms.canViewAccount ? { name: 'resellerId', label: translations.resellerId, value: company.resellerId || '' } : null,\n  ].filter(Boolean) as { name: string; label: string; value: string; legalName?: string }[];\n\n  return (\n    <Card\n      variant=\"secondary\"\n      className={classes([\n        'account-company-profile-card',\n        [\n          'account-company-profile-card-short',\n          showEditForm,\n        ],\n      ])}\n    >\n      <div className=\"account-company-profile-card__wrapper\">\n        <div className=\"account-company-profile-card__actions\">\n          {(company.canEditAccount || company.canEditAddress) && (\n            <Button\n              // @ts-ignore\n              type=\"button\"\n              variant=\"tertiary\"\n              onClick={handleShowEditForm}\n            >\n              {translations.editButton}\n            </Button>\n          )}\n        </div>\n        <div className=\"account-company-profile-card__content\">\n          {(() => {\n            const Default = (\n              <>\n              {companyData.map((el, index) => {\n                if (!el.value) return null;\n                \n                let value;\n                if (el.name === 'name' && el.legalName) {\n                  // Show company name with legal name in parentheses\n                  value = `${el.label}: ${el.value} (${el.legalName})`;\n                } else {\n                  value = !el.label\n                    ? el.value\n                    : `${el.label}: ${el.value}`;\n                }\n\n                return (\n                  <p\n                    key={`${el.name}_${index}`}\n                    data-testid={`${el.name}_${index}`}\n                  >\n                    {value}\n                  </p>\n                );\n              })}\n\n              {perms.canViewAddress && company.legalAddress && (\n                <div className=\"company-legal-address\">\n                  <p><strong>{translations.legalAddress}:</strong></p>\n                  {company.legalAddress.street?.map((line: string, i: number) => (\n                    <p key={i}>{line}</p>\n                  ))}\n                  <p>\n                    {company.legalAddress.city}, {company.legalAddress.region?.region} {company.legalAddress.postcode}\n                  </p>\n                  <p>{company.legalAddress.countryCode}</p>\n                  {company.legalAddress.telephone && (\n                    <p>Phone: {company.legalAddress.telephone}</p>\n                  )}\n                </div>\n              )}\n\n              {perms.canViewContacts && (company.companyAdmin || company.salesRepresentative) && (\n                <div className=\"company-contacts\">\n                  <p><strong>{translations.contacts}:</strong></p>\n                  \n                  {company.companyAdmin && (\n                    <div className=\"company-contact\">\n                      <p><strong>{translations.companyAdministrator}:</strong></p>\n                      <p>{company.companyAdmin.firstname} {company.companyAdmin.lastname}</p>\n                      {company.companyAdmin.jobTitle && <p>{company.companyAdmin.jobTitle}</p>}\n                      <p>{company.companyAdmin.email}</p>\n                    </div>\n                  )}\n\n                  {company.salesRepresentative && (\n                    <div className=\"company-contact\">\n                      <p><strong>{translations.salesRepresentative}:</strong></p>\n                      <p>{company.salesRepresentative.firstname} {company.salesRepresentative.lastname}</p>\n                      <p>{company.salesRepresentative.email}</p>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {perms.canViewPaymentInformation && (\n                <div className=\"company-payment-methods\">\n                  <p><strong>{translations.paymentInformation}:</strong></p>\n                  {company.availablePaymentMethods && company.availablePaymentMethods.length > 0 ? (\n                    <>\n                      <p><strong>{translations.availablePaymentMethods}:</strong></p>\n                      <ul className=\"payment-methods-list\">\n                        {company.availablePaymentMethods.map((m, index) => (\n                          <li key={`payment_${index}`}>{m.title}</li>\n                        ))}\n                      </ul>\n                    </>\n                  ) : (\n                    <div className=\"message message-notice notice\">\n                      <div>{translations.noPaymentMethods}</div>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {perms.canViewShippingInformation && (\n                <div className=\"company-shipping-methods\">\n                  <p><strong>{translations.shippingInformation}:</strong></p>\n                  {company.availableShippingMethods && company.availableShippingMethods.length > 0 ? (\n                    <>\n                      <p><strong>{translations.availableShippingMethods}:</strong></p>\n                      <ul className=\"shipping-methods-list\">\n                        {company.availableShippingMethods.map((m, index) => (\n                          <li key={`shipping_${index}`}>{m.title}</li>\n                        ))}\n                      </ul>\n                    </>\n                  ) : (\n                    <div className=\"message message-notice notice\">\n                      <div>{translations.noShippingMethods}</div>\n                    </div>\n                  )}\n                </div>\n              )}\n              </>\n            );\n            if (slots?.CompanyData) {\n              return (\n                <Slot name=\"CompanyData\" slot={slots.CompanyData} context={{ companyData, Default }} />\n              );\n            }\n            return Default;\n          })()}\n        </div>\n      </div>\n    </Card>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks';\nimport { events } from '@adobe-commerce/event-bus';\nimport { getCompany, updateCompany, getCountries } from '../../api';\nimport { CompanyModel } from '../../data/models';\nimport { Country } from '../../data/models/country';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { EventsList, publishEvents } from '../../lib/acdl';\nimport { useCompanyContextListener } from '@/company-management/hooks/useCompanyContextListener';\n\nimport { UseCompanyProfileProps } from '../../types/hook.types';\n\nexport const useCompanyProfile = ({ \n  handleSetInLineAlert,\n  editFormRef\n}: UseCompanyProfileProps) => {\n  const translations = useText({\n    companySuccess: 'Company.CompanyProfile.editCompanyProfile.companySuccess',\n    companyError: 'Company.CompanyProfile.editCompanyProfile.companyError',\n    loadError: 'Company.CompanyProfile.messages.loadError',\n    updateError: 'Company.CompanyProfile.messages.updateError',\n    noDataToUpdate: 'Company.CompanyProfile.messages.noDataToUpdate',\n  });\n  const { companySuccess, companyError, loadError, updateError, noDataToUpdate } = translations;\n\n  const [company, setCompany] = useState<CompanyModel | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [submitLoading, setSubmitLoading] = useState<boolean>(false);\n  const [showEditForm, setShowEditForm] = useState<boolean>(false);\n  const [countries, setCountries] = useState<Country[]>([]);\n  const [inputChange, setInputChange] = useState<Record<string, string | number | boolean>>({});\n\n  // Keep stable references to avoid re-creating callbacks/effects and double fetch\n  const alertFnRef = useRef<UseCompanyProfileProps['handleSetInLineAlert']>(handleSetInLineAlert);\n  const inFlightRef = useRef<boolean>(false);\n  const didInitialFetchRef = useRef<boolean>(false);\n  useEffect(() => {\n    alertFnRef.current = handleSetInLineAlert;\n  }, [handleSetInLineAlert]);\n\n  const handleInputChange = useCallback(\n    (value: Record<string, string | number | boolean>) => {\n      setInputChange(value);\n    },\n    []\n  );\n\n  const renderAlertMessage = useCallback(\n    (type: 'success' | 'error', message?: string) => {\n      if (!handleSetInLineAlert) return;\n\n      if (type === 'success') {\n        handleSetInLineAlert({\n          type: 'success',\n          text: message ?? companySuccess,\n        });\n      } else if (type === 'error') {\n        handleSetInLineAlert({\n          type: 'error',\n          text: message ?? companyError,\n        });\n      } else {\n        handleSetInLineAlert();\n      }\n\n      setSubmitLoading(false);\n    },\n    [handleSetInLineAlert, companySuccess, companyError]\n  );\n\n  const fetchCompany = useCallback(async (): Promise<CompanyModel | null> => {\n    if (inFlightRef.current) {\n      return null;\n    }\n    inFlightRef.current = true;\n    setLoading(true);\n    \n    try {\n      const companyData = await getCompany();\n      if (companyData) {\n        setCompany(companyData);\n      }\n      setLoading(false);\n      return companyData;\n    } catch (error) {\n      console.error('Failed to load company:', error);\n      setLoading(false);\n      if (alertFnRef.current) {\n        alertFnRef.current({ type: 'error', text: loadError });\n      }\n      return null;\n    } finally {\n      inFlightRef.current = false;\n    }\n  }, [loadError]);\n\n  useEffect(() => {\n    if (!didInitialFetchRef.current) {\n      didInitialFetchRef.current = true;\n      fetchCompany();\n    }\n    // Intentionally depend only on loadError through fetchCompany to avoid re-fetching on alert changes\n  }, [fetchCompany]);\n\n  // Re-fetch company when company context changes/restores (e.g., user switches company)\n  useCompanyContextListener(\n    useCallback(() => {\n      setLoading(true);\n      setShowEditForm(false);\n      setInputChange({});\n      // Re-fetch with updated GraphQL headers\n      fetchCompany();\n    }, [fetchCompany])\n  );\n\n  useEffect(() => {\n    getCountries().then((countriesResponse) => {\n      setCountries(countriesResponse.availableCountries);\n    }).catch((error) => {\n      console.error('Failed to load countries:', error);\n    });\n  }, []);\n\n  const handleShowEditForm = useCallback(() => {\n    setShowEditForm(true);\n    renderAlertMessage('success', ''); // Clear any existing alerts\n    setInputChange({});\n  }, [renderAlertMessage]);\n\n  // Auto-scroll to edit form when it becomes visible\n  useEffect(() => {\n    if (showEditForm && editFormRef?.current) {\n      setTimeout(() => {\n        editFormRef.current?.scrollIntoView({\n          behavior: 'smooth',\n          block: 'start',\n          inline: 'nearest'\n        });\n      }, 100);\n    }\n  }, [showEditForm, editFormRef]);\n\n  const handleHideEditForm = useCallback((clearStates?: () => void) => {\n    clearStates?.();\n    setShowEditForm(false);\n    setInputChange({});\n  }, []);\n\n  const handleUpdateCompany = useCallback(async (data: Partial<CompanyModel>) => {\n    try {\n      setSubmitLoading(true);\n      \n      if (!data) {\n        renderAlertMessage('error', noDataToUpdate);\n        return;\n      }\n      \n      const updatedCompany = await updateCompany(data as any);\n      \n      // Permissions are now correctly set by transformCompany based on role data\n      \n      setCompany(updatedCompany);\n      setShowEditForm(false);\n      setInputChange({});\n      \n      renderAlertMessage('success');\n      \n      // Publish analytics event\n      publishEvents(EventsList.EDIT_COMPANY_EVENT, {\n        ...data,\n        companyId: company?.id,\n      });\n      \n      // No need to refresh - updateCompany already returns complete updated data\n      \n      // Notify other components that company was updated (emit complete data if available)\n      events.emit('company/updated', { company: updatedCompany });\n    \n    } catch (error: any) {\n      console.error('Failed to update company:', error);\n      renderAlertMessage('error', error.message || updateError);\n    } finally {\n      setSubmitLoading(false);\n    }\n  }, [company, renderAlertMessage, updateError, noDataToUpdate]);\n\n  return {\n    // Core data\n    company,\n    countries,\n    \n    // Loading states\n    loading,\n    submitLoading,\n    \n    // UI states\n    showEditForm,\n    \n    // Form data\n    inputChange,\n    \n    // Actions\n    handleShowEditForm,\n    handleHideEditForm,\n    handleUpdateCompany,\n    handleInputChange,\n    renderAlertMessage,\n    \n    // Legacy support (deprecated - use submitLoading instead)\n    saving: submitLoading,\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { useEffect, useMemo, useState } from 'preact/hooks';\nimport { getCountries } from '../api';\nimport type { Country } from '../data/models';\n\ninterface UseCountriesResult {\n  countryOptions: Country[];\n  regionOptions: { text: string; value: string }[];\n  isRegionRequired: boolean;\n  hasRegionOptions: boolean;\n  loadingCountries: boolean;\n}\n\nexport const useCountries = (selectedCountryCode: string | undefined): UseCountriesResult => {\n  const [countriesData, setCountriesData] = useState<{\n    availableCountries: Country[];\n    countriesWithRequiredRegion: string[];\n    optionalZipCountries: string[];\n  } | null>(null);\n  const [loadingCountries, setLoadingCountries] = useState<boolean>(true);\n\n  useEffect(() => {\n    let isMounted = true;\n    getCountries()\n      .then(({ availableCountries, countriesWithRequiredRegion, optionalZipCountries }) => {\n        if (!isMounted) return;\n        setCountriesData({ availableCountries, countriesWithRequiredRegion, optionalZipCountries });\n        setLoadingCountries(false);\n      })\n      .catch(() => {\n        if (!isMounted) return;\n        setLoadingCountries(false);\n      });\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  const countryOptions = useMemo(() => {\n    return countriesData?.availableCountries || [];\n  }, [countriesData]);\n\n  const regionOptions = useMemo(() => {\n    if (!selectedCountryCode || !countriesData) return [] as { text: string; value: string }[];\n    const selectedCountry = countriesData.availableCountries.find((country) => country.value === selectedCountryCode);\n    if (!selectedCountry?.availableRegions || selectedCountry.availableRegions.length === 0) return [];\n    return selectedCountry.availableRegions.map((region) => ({ text: region.name, value: `${region.code},${region.id}` }));\n  }, [selectedCountryCode, countriesData]);\n\n  const isRegionRequired = useMemo(() => {\n    if (!selectedCountryCode || !countriesData) return false;\n    return countriesData.countriesWithRequiredRegion.includes(selectedCountryCode);\n  }, [selectedCountryCode, countriesData]);\n\n  const hasRegionOptions = useMemo(() => regionOptions.length > 0, [regionOptions]);\n\n  return {\n    countryOptions,\n    regionOptions,\n    isRegionRequired,\n    hasRegionOptions,\n    loadingCountries,\n  };\n};\n\n\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { FunctionComponent } from 'preact';\nimport { Field, Input } from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\n\ninterface CompanyAccountFieldsProps {\n  loading?: boolean;\n  value: {\n    name: string;\n    email: string;\n    legalName: string;\n    vatTaxId: string;\n    resellerId: string;\n  };\n  errors: Record<string, string>;\n  touched: Record<string, boolean>;\n  onBlur: (field: string, value?: string) => void;\n  /** Optional input name prefix for DOM names (defaults to none) */\n  namePrefix?: string;\n  /** Optional field path prefix used for change/blur handlers (defaults to none) */\n  fieldPathPrefix?: string;\n}\n\nexport const CompanyAccountFields: FunctionComponent<CompanyAccountFieldsProps> = ({\n  loading,\n  value,\n  errors,\n  touched,\n  onBlur,\n  namePrefix = '',\n  fieldPathPrefix = '',\n}) => {\n  const translations = useText({\n    accountInformation: 'Company.shared.fields.accountInformation',\n    companyName: 'Company.shared.fields.companyName',\n    email: 'Company.shared.fields.email',\n    legalName: 'Company.shared.fields.legalName',\n    vatTaxId: 'Company.shared.fields.vatTaxId',\n    resellerId: 'Company.shared.fields.resellerId',\n  });\n  \n  const prefix = namePrefix ? `${namePrefix}_` : '';\n  const path = (f: string) => (fieldPathPrefix ? `${fieldPathPrefix}.${f}` : f);\n  \n  const handleBlur = (fieldName: string) => (e: Event) => {\n    const target = e.target as HTMLInputElement;\n    onBlur(path(fieldName), target.value);\n  };\n  \n  const commonInputProps = {\n    disabled: !!loading,\n    variant: 'primary' as const,\n    size: 'medium' as const,\n  };\n  \n  return (\n    <div className=\"account-edit-company-profile-form__group\">\n      <h3 className=\"account-edit-company-profile-form__section-title\">{translations.accountInformation}</h3>\n      <Field \n        label={translations.companyName} \n        required\n        className=\"account-edit-company-profile-form__field\"\n        error={touched.name && errors.name ? errors.name : undefined}\n      >\n        <Input\n          name={`${prefix}name`}\n          type=\"text\"\n          value={value.name}\n          onBlur={handleBlur('name')}\n          {...commonInputProps}\n          maxLength={40}\n        />\n      </Field>\n\n      <Field label={translations.legalName} className=\"account-edit-company-profile-form__field\">\n        <Input\n          name={`${prefix}legalName`}\n          type=\"text\"\n          value={value.legalName}\n          onBlur={handleBlur('legalName')}\n          {...commonInputProps}\n          maxLength={80}\n        />\n      </Field>\n\n      <Field \n        label={translations.email} \n        required\n        className=\"account-edit-company-profile-form__field\"\n        error={touched.email && errors.email ? errors.email : undefined}\n      >\n        <Input\n          name={`${prefix}email`}\n          type=\"email\"\n          value={value.email}\n          onBlur={handleBlur('email')}\n          {...commonInputProps}\n        />\n      </Field>\n\n      <Field label={translations.vatTaxId} className=\"account-edit-company-profile-form__field\">\n        <Input\n          name={`${prefix}vatTaxId`}\n          type=\"text\"\n          value={value.vatTaxId}\n          onBlur={handleBlur('vatTaxId')}\n          {...commonInputProps}\n          maxLength={40}\n        />\n      </Field>\n\n      <Field label={translations.resellerId} className=\"account-edit-company-profile-form__field\">\n        <Input\n          name={`${prefix}resellerId`}\n          type=\"text\"\n          value={value.resellerId}\n          onBlur={handleBlur('resellerId')}\n          {...commonInputProps}\n          maxLength={40}\n        />\n      </Field>\n    </div>\n  );\n};\n\nexport default CompanyAccountFields;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { FunctionComponent } from 'preact';\nimport { Field, Input, Picker } from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\n\ninterface LegalAddressFieldsProps {\n  loading?: boolean;\n  loadingCountries: boolean;\n  value: {\n    street: string;\n    street2: string;\n    city: string;\n    region: string;\n    regionCode: string;\n    countryCode: string;\n    postcode: string;\n    telephone: string;\n  };\n  errors: Record<string, string>;\n  touched: Record<string, boolean>;\n  onChange: (field: string) => (value: string) => void;\n  onBlur: (field: string, value?: string) => void;\n  countryOptions: { text: string; value: string }[];\n  regionOptions: { text: string; value: string }[];\n  isRegionRequired: boolean;\n  hasRegionOptions: boolean;\n  /**\n   * Optional input name prefix for DOM names (defaults to 'legal_address')\n   */\n  namePrefix?: string;\n  /**\n   * Optional field path prefix used for change/blur handlers (defaults to 'legal_address')\n   */\n  fieldPathPrefix?: string;\n  /**\n   * Optional per-field required overrides for non-edit flows\n   */\n  requiredConfig?: Partial<{\n    street: boolean;\n    city: boolean;\n    postcode: boolean;\n    telephone: boolean;\n  }>;\n}\n\nexport const LegalAddressFields: FunctionComponent<LegalAddressFieldsProps> = ({\n  loading,\n  loadingCountries,\n  value,\n  errors,\n  touched,\n  onChange,\n  onBlur,\n  countryOptions,\n  regionOptions,\n  isRegionRequired,\n  hasRegionOptions,\n  namePrefix = 'legalAddress',\n  fieldPathPrefix = 'legalAddress',\n  requiredConfig,\n}) => {\n  const translations = useText({\n    legalAddress: 'Company.shared.fields.legalAddress',\n    streetAddress: 'Company.shared.fields.streetAddress',\n    city: 'Company.shared.fields.city',\n    country: 'Company.shared.fields.country',\n    stateProvince: 'Company.shared.fields.stateProvince',\n    zipPostalCode: 'Company.shared.fields.zipPostalCode',\n    phoneNumber: 'Company.shared.fields.phoneNumber',\n  });\n  \n  const names = {\n    street: `${namePrefix}_street`,\n    street2: `${namePrefix}_street2`,\n    city: `${namePrefix}_city`,\n    countryCode: `${namePrefix}_countryCode`,\n    region: `${namePrefix}_region`,\n    postcode: `${namePrefix}_postcode`,\n    telephone: `${namePrefix}_telephone`,\n  } as const;\n\n  const paths = {\n    street: `${fieldPathPrefix}.street`,\n    street2: `${fieldPathPrefix}.street2`,\n    city: `${fieldPathPrefix}.city`,\n    countryCode: `${fieldPathPrefix}.countryCode`,\n    region: `${fieldPathPrefix}.region`,\n    regionCode: `${fieldPathPrefix}.regionCode`,\n    postcode: `${fieldPathPrefix}.postcode`,\n    telephone: `${fieldPathPrefix}.telephone`,\n  } as const;\n\n  const isRequired = {\n    street: requiredConfig?.street ?? true,\n    city: requiredConfig?.city ?? true,\n    postcode: requiredConfig?.postcode ?? true,\n    telephone: requiredConfig?.telephone ?? true,\n  } as const;\n\n  const handleBlur = (fieldPath: string) => (e: Event) => {\n    const target = e.target as HTMLInputElement;\n    onBlur(fieldPath, target.value);\n  };\n\n  const commonInputProps = {\n    disabled: !!loading,\n    variant: 'primary' as const,\n    size: 'medium' as const,\n  };\n\n  return (\n    <div className=\"account-edit-company-profile-form__section\">\n      <h3 className=\"account-edit-company-profile-form__section-title\">{translations.legalAddress}</h3>\n\n      <Field \n        label={translations.streetAddress} \n        required={isRequired.street}\n        className=\"account-edit-company-profile-form__field\"\n        error={touched[paths.street] && errors[paths.street] ? errors[paths.street] : undefined}\n      >\n        <Input\n          name={names.street}\n          type=\"text\"\n          value={value.street}\n          onBlur={handleBlur(paths.street)}\n          {...commonInputProps}\n        />\n      </Field>\n\n      <Field \n        label={`${translations.streetAddress} 2`} \n        className=\"account-edit-company-profile-form__field\"\n      >\n        <Input\n          name={names.street2}\n          type=\"text\"\n          value={value.street2}\n          onBlur={handleBlur(paths.street2)}\n          {...commonInputProps}\n        />\n      </Field>\n\n      <Field \n        label={translations.city} \n        required={isRequired.city}\n        className=\"account-edit-company-profile-form__field\"\n        error={touched[paths.city] && errors[paths.city] ? errors[paths.city] : undefined}\n      >\n        <Input\n          name={names.city}\n          type=\"text\"\n          value={value.city}\n          onBlur={handleBlur(paths.city)}\n          {...commonInputProps}\n        />\n      </Field>\n\n      <Field \n        label={translations.country} \n        required\n        className=\"account-edit-company-profile-form__field\"\n        error={touched[paths.countryCode] && errors[paths.countryCode] ? errors[paths.countryCode] : undefined}\n      >\n        <Picker\n          name={names.countryCode}\n          floatingLabel={`${translations.country} *`}\n          placeholder={translations.country}\n          options={countryOptions}\n          value={value.countryCode}\n          handleSelect={(event: Event) => {\n            const target = event.target as HTMLSelectElement;\n            onChange(paths.countryCode)(target.value);\n          }}\n          onBlur={() => onBlur(paths.countryCode)}\n          disabled={!!loading || loadingCountries}\n        />\n      </Field>\n\n      <Field \n        label={translations.stateProvince} \n        required={isRegionRequired}\n        className=\"account-edit-company-profile-form__field\"\n        error={touched['legalAddress.region'] && errors['legalAddress.region'] ? errors['legalAddress.region'] : undefined}\n      >\n        {hasRegionOptions ? (\n          <Picker\n            key={`region_picker_${value.countryCode}`}\n            name=\"legalAddress_region\"\n            floatingLabel={`${translations.stateProvince} ${isRegionRequired ? '*' : ''}`}\n            placeholder={translations.stateProvince}\n            options={regionOptions}\n            value={value.regionCode ? (regionOptions.find(r => r.value.split(',')[0] === value.regionCode)?.value || '') : ''}\n            handleSelect={(event: Event) => {\n              const target = event.target as HTMLSelectElement;\n              const [regionCode] = target.value.split(',');\n              const regionName = regionOptions.find(r => r.value === target.value)?.text || '';\n              onChange(paths.region)(regionName);\n              onChange(paths.regionCode)(regionCode);\n            }}\n            onBlur={() => onBlur(paths.region)}\n            disabled={!!loading || loadingCountries}\n          />\n        ) : (\n          <Input\n            key={`region_input_${value.countryCode}`}\n            name={names.region}\n            type=\"text\"\n            value={value.region}\n            onBlur={handleBlur(paths.region)}\n            {...commonInputProps}\n            disabled={!!loading || loadingCountries}\n          />\n        )}\n      </Field>\n\n      <Field \n        label={translations.zipPostalCode} \n        required={isRequired.postcode}\n        className=\"account-edit-company-profile-form__field\"\n        error={touched[paths.postcode] && errors[paths.postcode] ? errors[paths.postcode] : undefined}\n      >\n        <Input\n          name={names.postcode}\n          type=\"text\"\n          value={value.postcode}\n          onBlur={handleBlur(paths.postcode)}\n          {...commonInputProps}\n        />\n      </Field>\n\n      <Field \n        label={translations.phoneNumber} \n        required={isRequired.telephone}\n        className=\"account-edit-company-profile-form__field\"\n        error={touched[paths.telephone] && errors[paths.telephone] ? errors[paths.telephone] : undefined}\n      >\n        <Input\n          name={names.telephone}\n          type=\"tel\"\n          value={value.telephone}\n          onBlur={handleBlur(paths.telephone)}\n          {...commonInputProps}\n        />\n      </Field>\n    </div>\n  );\n};\n\nexport default LegalAddressFields;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { FunctionComponent } from 'preact';\nimport { useState } from 'preact/hooks';\nimport {\n  Button,\n  Card,\n  Header,\n  InLineAlert,\n  ProgressSpinner,\n} from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { validateCompanyEmail } from '../../api';\nimport { EditCompanyProfileProps } from '../../types/companyProfile.types';\nimport './EditCompanyProfile.css';\nimport { useCountries } from '../../hooks/useCountries';\nimport { CompanyAccountFields } from './CompanyAccountFields';\nimport { LegalAddressFields } from './LegalAddressFields';\n\nexport const EditCompanyProfile: FunctionComponent<EditCompanyProfileProps> = ({\n  inLineAlertProps,\n  company,\n  loading = false,\n  onSubmit,\n  onCancel,\n}) => {\n  const translations = useText({\n    title: 'Company.EditCompanyProfile.title',\n    cancel: 'Company.shared.buttons.cancel',\n    save: 'Company.shared.buttons.save',\n    saving: 'Company.shared.buttons.saving',\n    required: 'Company.shared.validation.required',\n    invalidEmail: 'Company.shared.validation.invalidEmail',\n    companyNameRequired: 'Company.shared.validation.companyNameRequired',\n    emailRequired: 'Company.shared.validation.emailRequired',\n    emailNotAvailable: 'Company.shared.validation.emailNotAvailable',\n    companyNameLengthError: 'Company.shared.validation.companyNameLengthError',\n    legalNameLengthError: 'Company.shared.validation.legalNameLengthError',\n    vatTaxIdLengthError: 'Company.shared.validation.vatTaxIdLengthError',\n    resellerIdLengthError: 'Company.shared.validation.resellerIdLengthError',\n  });\n  \n  const [formData, setFormData] = useState({\n    name: company?.name || '',\n    email: company?.email || '',\n    legalName: company?.legalName || '',\n    vatTaxId: company?.vatTaxId || '',\n    resellerId: company?.resellerId || '',\n    legalAddress: {\n      street: company?.legalAddress?.street?.[0] || '',\n      street2: company?.legalAddress?.street?.[1] || '',\n      city: company?.legalAddress?.city || '',\n      region: company?.legalAddress?.region?.region || '',\n      regionCode: company?.legalAddress?.region?.regionCode || '',\n      countryCode: company?.legalAddress?.countryCode || '',\n      postcode: company?.legalAddress?.postcode || '',\n      telephone: company?.legalAddress?.telephone || '',\n    },\n  });\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [touched, setTouched] = useState<Record<string, boolean>>({});\n\n  // Permission flags for editing\n  // Strictly gate by granular permissions; do not fallback to overall canEdit here\n  const canEditAccount = company?.permissionsFlags?.canEditAccount === true;\n  const canEditAddress = company?.permissionsFlags?.canEditAddress === true;\n  \n  // Country and region data via hook\n  const {\n    countryOptions,\n    regionOptions,\n    isRegionRequired,\n    hasRegionOptions,\n    loadingCountries,\n  } = useCountries(formData.legalAddress.countryCode);\n\n  // Validation functions\n  const validateField = (name: string, value: string): string | null => {\n    if (name === 'name') {\n      if (!value.trim()) return translations.companyNameRequired;\n      if (value.length > 40) return translations.companyNameLengthError;\n      return null;\n    }\n    if (name === 'email') {\n      if (!value.trim()) return translations.emailRequired;\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n      if (!emailRegex.test(value)) return translations.invalidEmail;\n      return null;\n    }\n    if (name === 'legalName') {\n      if (value.length > 80) return translations.legalNameLengthError;\n      return null;\n    }\n    if (name === 'vatTaxId') {\n      if (value.length > 40) return translations.vatTaxIdLengthError;\n      return null;\n    }\n    if (name === 'resellerId') {\n      if (value.length > 40) return translations.resellerIdLengthError;\n      return null;\n    }\n    if (\n      name === 'legalAddress.street' ||\n      name === 'legalAddress.city' ||\n      name === 'legalAddress.postcode' ||\n      name === 'legalAddress.telephone' ||\n      name === 'legalAddress.countryCode'\n    ) {\n      if (!value.trim()) return translations.required;\n      return null;\n    }\n    if (name === 'legalAddress.region') {\n      if (isRegionRequired && !value.trim()) return translations.required;\n      return null;\n    }\n    return null;\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    let isValid = true;\n\n    // Determine permissions for editing\n    const canEditAccount = company?.permissionsFlags?.canEditAccount === true;\n    const canEditAddress = company?.permissionsFlags?.canEditAddress === true;\n\n    // Validate required account fields only if editing account is allowed\n    if (canEditAccount) {\n      const nameError = validateField('name', formData.name);\n      if (nameError) {\n        newErrors.name = nameError;\n        isValid = false;\n      }\n\n      const emailError = validateField('email', formData.email);\n      if (emailError) {\n        newErrors.email = emailError;\n        isValid = false;\n      }\n\n      // Validate optional fields if they have values\n      if (formData.legalName) {\n        const legalNameError = validateField('legalName', formData.legalName);\n        if (legalNameError) {\n          newErrors.legalName = legalNameError;\n          isValid = false;\n        }\n      }\n\n      if (formData.vatTaxId) {\n        const vatTaxIdError = validateField('vatTaxId', formData.vatTaxId);\n        if (vatTaxIdError) {\n          newErrors.vatTaxId = vatTaxIdError;\n          isValid = false;\n        }\n      }\n\n      if (formData.resellerId) {\n        const resellerIdError = validateField('resellerId', formData.resellerId);\n        if (resellerIdError) {\n          newErrors.resellerId = resellerIdError;\n          isValid = false;\n        }\n      }\n    }\n\n    // Validate required address fields only if editing address is allowed\n    if (canEditAddress) {\n      const streetError = validateField('legalAddress.street', formData.legalAddress.street);\n      if (streetError) {\n        newErrors['legalAddress.street'] = streetError;\n        isValid = false;\n      }\n\n      const cityError = validateField('legalAddress.city', formData.legalAddress.city);\n      if (cityError) {\n        newErrors['legalAddress.city'] = cityError;\n        isValid = false;\n      }\n\n      const postcodeError = validateField('legalAddress.postcode', formData.legalAddress.postcode);\n      if (postcodeError) {\n        newErrors['legalAddress.postcode'] = postcodeError;\n        isValid = false;\n      }\n\n      const telephoneError = validateField('legalAddress.telephone', formData.legalAddress.telephone);\n      if (telephoneError) {\n        newErrors['legalAddress.telephone'] = telephoneError;\n        isValid = false;\n      }\n\n      const countryError = validateField('legalAddress.countryCode', formData.legalAddress.countryCode);\n      if (countryError) {\n        newErrors['legalAddress.countryCode'] = countryError;\n        isValid = false;\n      }\n\n      // Validate region field\n      const regionError = validateField('legalAddress.region', formData.legalAddress.region);\n      if (regionError) {\n        newErrors['legalAddress.region'] = regionError;\n        isValid = false;\n      }\n    }\n\n    setErrors(newErrors);\n    return isValid;\n  };\n\n  const handleSubmit = async (event: Event) => {\n    event.preventDefault();\n    \n    // Mark only editable fields as touched\n    // Use granular permission flags defined for this session\n    const canEditAccount = company?.permissionsFlags?.canEditAccount === true;\n    const canEditAddress = company?.permissionsFlags?.canEditAddress === true;\n    const touchedFields: Record<string, boolean> = {};\n    if (canEditAccount) {\n      touchedFields.name = true;\n      touchedFields.email = true;\n      touchedFields.legalName = true;\n      touchedFields.vatTaxId = true;\n      touchedFields.resellerId = true;\n    }\n    if (canEditAddress) {\n      touchedFields['legalAddress.street'] = true;\n      touchedFields['legalAddress.street2'] = true;\n      touchedFields['legalAddress.city'] = true;\n      touchedFields['legalAddress.region'] = true;\n      touchedFields['legalAddress.regionCode'] = true;\n      touchedFields['legalAddress.countryCode'] = true;\n      touchedFields['legalAddress.postcode'] = true;\n      touchedFields['legalAddress.telephone'] = true;\n    }\n    setTouched(touchedFields);\n\n    if (!validateForm()) {\n      return;\n    }\n\n    // Check if email has changed and validate availability (only if allowed to edit account)\n    if (canEditAccount && formData.email !== company?.email) {\n      const emailValidation = await validateCompanyEmail(formData.email);\n      if (!emailValidation.isValid) {\n        setErrors(prev => ({\n          ...prev,\n          email: emailValidation.error || translations.emailNotAvailable,\n        }));\n        return;\n      }\n    }\n\n    if (onSubmit) {\n      // Transform form data to match API expectations\n      const transformedData: any = {};\n      if (canEditAccount) {\n        transformedData.name = formData.name;\n        transformedData.email = formData.email;\n        transformedData.legalName = formData.legalName;\n        transformedData.vatTaxId = formData.vatTaxId;\n        transformedData.resellerId = formData.resellerId;\n      }\n      if (canEditAddress) {\n        transformedData.legalAddress = {\n          street: [formData.legalAddress.street, formData.legalAddress.street2].filter(Boolean),\n          city: formData.legalAddress.city,\n          region: {\n            region: formData.legalAddress.region,\n            regionCode: formData.legalAddress.regionCode,\n          },\n          countryCode: formData.legalAddress.countryCode,\n          postcode: formData.legalAddress.postcode,\n          telephone: formData.legalAddress.telephone,\n        };\n      }\n      await onSubmit(transformedData);\n    }\n  };\n\n  // Common form update logic\n  const updateFormData = (field: string, value: string) => {\n    if (field.startsWith('legalAddress.')) {\n      const addressField = field.split('.')[1];\n      \n      // Special handling for country change - reset region when country changes\n      if (addressField === 'countryCode') {\n        setFormData(prev => ({\n          ...prev,\n          legalAddress: {\n            ...prev.legalAddress,\n            [addressField]: value,\n            region: '', // Reset region text\n            regionCode: '', // Reset region code\n          },\n        }));\n        \n        // Clear region errors when country changes\n        setErrors(prev => {\n          const newErrors = { ...prev };\n          delete newErrors['legalAddress.region'];\n          delete newErrors['legalAddress.regionCode'];\n          return newErrors;\n        });\n        \n        // Clear region touched state when country changes\n        setTouched(prev => {\n          const newTouched = { ...prev };\n          delete newTouched['legalAddress.region'];\n          delete newTouched['legalAddress.regionCode'];\n          return newTouched;\n        });\n      } else if (addressField === 'region') {\n        // Handle region field (both text input and dropdown use this)\n        setFormData(prev => ({\n          ...prev,\n          legalAddress: {\n            ...prev.legalAddress,\n            region: value,\n            // For text input regions, use the same value for regionCode\n            // For dropdown regions, this gets overridden in the handleSelect\n            regionCode: hasRegionOptions ? prev.legalAddress.regionCode : value,\n          },\n        }));\n      } else {\n        setFormData(prev => ({\n          ...prev,\n          legalAddress: {\n            ...prev.legalAddress,\n            [addressField]: value,\n          },\n        }));\n      }\n    } else {\n      setFormData(prev => ({ ...prev, [field]: value }));\n    }\n  };\n\n  const handleInputChange = (field: string) => (value: string) => {\n    // Permission guard: block changes to forbidden fields even if events fire\n    const accountFields = new Set(['name', 'email', 'legalName', 'vatTaxId', 'resellerId']);\n    const isAddress = field.startsWith('legalAddress.');\n    const isAccount = accountFields.has(field);\n    if ((isAccount && !canEditAccount) || (isAddress && !canEditAddress)) {\n      return;\n    }\n    \n    updateFormData(field, value);\n    \n    // Clear error when user starts typing\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  const handleBlur = (field: string, value?: string) => {\n    // Permission guard: block changes to forbidden fields even if events fire\n    const accountFields = new Set(['name', 'email', 'legalName', 'vatTaxId', 'resellerId']);\n    const isAddress = field.startsWith('legalAddress.');\n    const isAccount = accountFields.has(field);\n    if ((isAccount && !canEditAccount) || (isAddress && !canEditAddress)) {\n      return;\n    }\n    \n    // Update form state if value is provided\n    if (value !== undefined) {\n      updateFormData(field, value);\n    }\n    \n    setTouched(prev => ({ ...prev, [field]: true }));\n    \n    // Get current value for validation\n    let currentValue = value;\n    if (currentValue === undefined) {\n      if (field.startsWith('legalAddress.')) {\n        const addressField = field.split('.')[1];\n        const addressValue = formData.legalAddress[addressField as keyof typeof formData.legalAddress];\n        currentValue = typeof addressValue === 'string' ? addressValue : '';\n      } else {\n        const fieldValue = formData[field as keyof typeof formData];\n        currentValue = typeof fieldValue === 'string' ? fieldValue : '';\n      }\n    }\n    \n    const error = validateField(field, currentValue);\n    \n    if (error) {\n      setErrors(prev => ({ ...prev, [field]: error }));\n    } else {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  return (\n    <Card variant=\"secondary\" className={'account-edit-company-profile'}>\n      <Header\n        title={translations.title}\n        divider={false}\n        className={'account-edit-company-profile__title'}\n      />\n      {inLineAlertProps?.text ? (\n        <InLineAlert\n          className=\"account-edit-company-profile__notification\"\n          type={inLineAlertProps.type}\n          variant=\"secondary\"\n          heading={inLineAlertProps.text}\n          icon={inLineAlertProps.icon}\n          data-testid=\"editCompanyInLineAlert\"\n        />\n      ) : null}\n      <form\n        className=\"account-edit-company-profile-form\"\n        onSubmit={handleSubmit}\n      >\n        {canEditAccount && (\n          <CompanyAccountFields\n            loading={loading}\n            value={{\n              name: formData.name,\n              email: formData.email,\n              legalName: formData.legalName,\n              vatTaxId: formData.vatTaxId,\n              resellerId: formData.resellerId,\n            }}\n            errors={errors}\n            touched={touched}\n            onBlur={handleBlur}\n          />\n        )}\n\n        {/* Legal Address Section */}\n        {canEditAddress && (\n          <LegalAddressFields\n            loading={loading}\n            loadingCountries={loadingCountries}\n            value={formData.legalAddress}\n            errors={errors}\n            touched={touched}\n            onChange={handleInputChange}\n            onBlur={handleBlur}\n            countryOptions={countryOptions}\n            regionOptions={regionOptions}\n            isRegionRequired={isRegionRequired}\n            hasRegionOptions={hasRegionOptions}\n          />\n        )}\n\n        <div className=\"account-edit-company-profile__actions\">\n          <Button\n            disabled={loading}\n            // @ts-ignore\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={() => onCancel?.()}\n          >\n            {translations.cancel}\n          </Button>\n          <Button disabled={loading || (!canEditAccount && !canEditAddress)} type=\"submit\" variant=\"primary\">\n            {translations.save}\n          </Button>\n        </div>\n      </form>\n      \n      {/* Loading overlay that covers the entire form */}\n      {loading && (\n        <div \n          className=\"account-edit-company-profile__loading-overlay\"\n          data-testid=\"editCompanyLoadingOverlay\"\n        >\n          <ProgressSpinner size=\"large\" />\n          <div className=\"account-edit-company-profile__loading-text\">\n            {translations.saving}\n          </div>\n        </div>\n      )}\n    </Card>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { classes, Container } from '@adobe-commerce/elsie/lib';\nimport { useRef } from 'preact/hooks';\nimport { CompanyProfileCard } from '../../components/CompanyProfileCard';\nimport { EditCompanyProfile } from '../../components/EditCompanyProfile';\nimport { CompanyCardLoader } from '../../components/CompanyLoaders';\nimport { useCompanyProfile } from '../../hooks/containers/useCompanyProfile';\nimport { useInLineAlert } from '../../hooks/useInLineAlert';\nimport { CompanyProfileProps } from '../../types/companyProfile.types';\n\nexport const CompanyProfile: Container<CompanyProfileProps> = ({\n  className,\n  slots,\n}) => {\n  const { inLineAlertProps, handleSetInLineAlert } = useInLineAlert();\n  const editFormRef = useRef<HTMLDivElement>(null);\n  const {\n    company,\n    loading,\n    saving,\n    showEditForm,\n    handleShowEditForm,\n    handleHideEditForm,\n    handleUpdateCompany,\n  } = useCompanyProfile({ handleSetInLineAlert, editFormRef });\n\n  if (loading)\n    return (\n      <div data-testid=\"companyProfileLoader\">\n        <CompanyCardLoader withCard />\n      </div>\n    );\n\n  return (\n    <div className={classes(['account-company-profile', className])}>\n      <CompanyProfileCard\n        company={company}\n        slots={slots}\n        showEditForm={showEditForm}\n        handleShowEditForm={handleShowEditForm}\n      />\n      {showEditForm ? (\n        <div ref={editFormRef}>\n          <EditCompanyProfile\n            inLineAlertProps={inLineAlertProps}\n            company={company}\n            loading={saving}\n            onSubmit={handleUpdateCompany}\n            onCancel={handleHideEditForm}\n          />\n        </div>\n      ) : null}\n    </div>\n  );\n};\n"],"names":["CompanyProfileCard","company","slots","showEditForm","handleShowEditForm","translations","useText","Card","jsx","IllustratedMessage","perms","companyData","classes","jsxs","Button","Default","Fragment","el","index","value","_a","line","i","_b","m","Slot","useCompanyProfile","handleSetInLineAlert","editFormRef","companySuccess","companyError","loadError","updateError","noDataToUpdate","setCompany","useState","loading","setLoading","submitLoading","setSubmitLoading","setShowEditForm","countries","setCountries","inputChange","setInputChange","alertFnRef","useRef","inFlightRef","didInitialFetchRef","useEffect","handleInputChange","useCallback","renderAlertMessage","type","message","fetchCompany","getCompany","error","useCompanyContextListener","getCountries","countriesResponse","handleHideEditForm","clearStates","handleUpdateCompany","data","updatedCompany","updateCompany","publishEvents","EventsList","events","useCountries","selectedCountryCode","countriesData","setCountriesData","loadingCountries","setLoadingCountries","isMounted","availableCountries","countriesWithRequiredRegion","optionalZipCountries","countryOptions","useMemo","regionOptions","selectedCountry","country","region","isRegionRequired","hasRegionOptions","CompanyAccountFields","errors","touched","onBlur","namePrefix","fieldPathPrefix","prefix","path","f","handleBlur","fieldName","e","target","commonInputProps","Field","Input","LegalAddressFields","onChange","requiredConfig","names","paths","isRequired","fieldPath","Picker","event","r","regionCode","regionName","EditCompanyProfile","inLineAlertProps","onSubmit","onCancel","formData","setFormData","_d","_c","_e","_g","_f","_i","_h","_j","_k","_l","setErrors","setTouched","canEditAccount","_m","canEditAddress","_n","validateField","name","validateForm","newErrors","isValid","nameError","emailError","legalNameError","vatTaxIdError","resellerIdError","streetError","cityError","postcodeError","telephoneError","countryError","regionError","handleSubmit","touchedFields","emailValidation","validateCompanyEmail","prev","transformedData","updateFormData","field","addressField","newTouched","accountFields","isAddress","currentValue","addressValue","fieldValue","Header","InLineAlert","ProgressSpinner","CompanyProfile","className","useInLineAlert","saving","CompanyCardLoader"],"mappings":"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"}