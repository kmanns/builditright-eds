{"version":3,"file":"getCompanyCreditHistory.js","sources":["/@dropins/storefront-company-management/src/data/transforms/transform-company-credit.ts","/@dropins/storefront-company-management/src/data/transforms/transform-company-credit-history.ts","/@dropins/storefront-company-management/src/api/getCompanyCredit/graphql/getCompanyCredit.graphql.ts","/@dropins/storefront-company-management/src/api/getCompanyCredit/getCompanyCredit.ts","/@dropins/storefront-company-management/src/api/getCompanyCreditHistory/graphql/getCompanyCreditHistory.graphql.ts","/@dropins/storefront-company-management/src/api/getCompanyCreditHistory/getCompanyCreditHistory.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { CompanyCreditResponse } from '@/company-management/types/api/getCompanyCredit.types';\nimport { CompanyCreditInfo } from '@/company-management/data/models/company-credit-info';\n\nexport const transformCompanyCredit = (\n  response: CompanyCreditResponse\n): CompanyCreditInfo => {\n  return {\n    credit: {\n      available_credit: {\n        currency: response?.data?.company?.credit?.available_credit?.currency || '',\n        value: response?.data?.company?.credit?.available_credit?.value || 0,\n      },\n      credit_limit: {\n        currency: response?.data?.company?.credit?.credit_limit?.currency || '',\n        value: response?.data?.company?.credit?.credit_limit?.value || 0,\n      },\n      outstanding_balance: {\n        currency: response?.data?.company?.credit?.outstanding_balance?.currency || '',\n        value: response?.data?.company?.credit?.outstanding_balance?.value || 0,\n      },\n    },\n  };\n};","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { CompanyCreditHistoryResponse } from '@/company-management/types/api/getCompanyCreditHistory.types';\nimport { CompanyCreditHistory } from '@/company-management/data/models/company-credit-history';\n\nexport const transformCompanyCreditHistory = (\n  response: CompanyCreditHistoryResponse\n): CompanyCreditHistory => {\n  const creditHistory = response?.data?.company?.credit_history;\n\n  return {\n    items: creditHistory?.items?.map(item => ({\n      amount: {\n        currency: item?.amount?.currency || '',\n        value: item?.amount?.value || 0,\n      },\n      balance: {\n        availableCredit: {\n          currency: item?.balance?.available_credit?.currency || '',\n          value: item?.balance?.available_credit?.value || 0,\n        },\n        creditLimit: {\n          currency: item?.balance?.credit_limit?.currency || '',\n          value: item?.balance?.credit_limit?.value || 0,\n        },\n        outstandingBalance: {\n          currency: item?.balance?.outstanding_balance?.currency || '',\n          value: item?.balance?.outstanding_balance?.value || 0,\n        },\n      },\n      customReferenceNumber: item?.custom_reference_number || undefined,\n      date: item?.date || '',\n      type: item?.type || '',\n      updatedBy: {\n        name: item?.updated_by?.name || '',\n        type: item?.updated_by?.type || '',\n      },\n    })) || [],\n    pageInfo: {\n      currentPage: creditHistory?.page_info?.current_page || 1,\n      pageSize: creditHistory?.page_info?.page_size || 20,\n      totalPages: creditHistory?.page_info?.total_pages || 0,\n    },\n    totalCount: creditHistory?.total_count || 0,\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_COMPANY_CREDIT = /* GraphQL */ `\n  query GET_COMPANY_CREDIT \n    {\n        company {\n            credit {\n                available_credit {\n                    currency\n                    value\n                }\n                credit_limit {\n                    currency\n                    value\n                }\n                outstanding_balance {\n                    currency\n                    value\n                }\n            }\n        }\n    }\n`;","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { GET_COMPANY_CREDIT } from \"./graphql/getCompanyCredit.graphql\";\nimport { CompanyCreditResponse } from '@/company-management/types/api/getCompanyCredit.types';\nimport { transformCompanyCredit } from '@/company-management/data/transforms';\nimport { handleNetworkError } from '@/company-management/lib';\nimport { CompanyCreditInfo } from '@/company-management/data/models';\nimport { fetchGraphQl } from '../fetch-graphql';\n\nexport const getCompanyCredit = async (): Promise<CompanyCreditInfo | null> => {\n\n  return await fetchGraphQl(GET_COMPANY_CREDIT, {\n    method: 'GET',\n    cache: 'no-cache',\n  })\n    .then((response: CompanyCreditResponse) => {\n      if (response.errors?.length) {\n        return null;\n      }\n\n      const transformedData = transformCompanyCredit(response);\n\n      return transformedData;\n    })\n    .catch(handleNetworkError);\n};","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_COMPANY_CREDIT_HISTORY = /* GraphQL */ `\n  query GET_COMPANY_CREDIT_HISTORY($filter: CompanyCreditHistoryFilterInput, $pageSize: Int, $currentPage: Int) {\n    company {\n      credit_history(\n        filter: $filter\n        pageSize: $pageSize\n        currentPage: $currentPage\n      ) {\n        items {\n          amount {\n            currency\n            value\n          }\n          balance {\n            available_credit {\n              currency\n              value\n            }\n            credit_limit {\n              currency\n              value\n            }\n            outstanding_balance {\n              currency\n              value\n            }\n          }\n          custom_reference_number\n          date\n          type\n          updated_by {\n            name\n            type\n          }\n        }\n        page_info {\n          current_page\n          page_size\n          total_pages\n        }\n        total_count\n      }\n    }\n  }\n`;","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { GET_COMPANY_CREDIT_HISTORY } from \"./graphql/getCompanyCreditHistory.graphql\";\nimport { CompanyCreditHistoryResponse } from '@/company-management/types/api/getCompanyCreditHistory.types';\nimport { GetCompanyCreditHistoryParams } from '@/company-management/types/api/getCompanyCreditHistoryParams.types';\nimport { transformCompanyCreditHistory } from '@/company-management/data/transforms';\nimport { handleNetworkError } from '@/company-management/lib';\nimport { CompanyCreditHistory } from '@/company-management/data/models';\nimport { fetchGraphQl } from '../fetch-graphql';\n\n/**\n * Retrieves paginated company credit transaction history.\n * \n * Returns credit operations including allocations, purchases, refunds, and manual\n * adjustments with transaction details, amounts, and running balance.\n * \n * @param params - Optional query parameters for filtering and pagination\n * @returns Promise resolving to credit history data or null if unavailable\n * \n * Returns `null` if:\n * - Company Credit is not enabled for this company\n * - User lacks permission to view credit information\n * - GraphQL query fails\n * \n * @example\n * ```typescript\n * const history = await getCompanyCreditHistory({\n *   pageSize: 10,\n *   currentPage: 1,\n *   filter: { operationType: 'PURCHASE' }\n * });\n * \n * if (history) {\n *   console.log(`Found ${history.totalCount} transactions`);\n *   history.items.forEach(item => {\n *     console.log(`${item.date}: ${item.operation} - ${item.amount}`);\n *   });\n * }\n * ```\n */\nexport const getCompanyCreditHistory = async (params: GetCompanyCreditHistoryParams = {}): Promise<CompanyCreditHistory | null> => {\n  const { filter, pageSize = 20, currentPage = 1 } = params;\n\n  // Transform camelCase filter to snake_case for GraphQL\n  const graphqlFilter = filter ? {\n    custom_reference_number: filter.customReferenceNumber,\n    operation_type: filter.operationType,\n    updated_by: filter.updatedBy,\n  } : null;\n\n  return await fetchGraphQl(GET_COMPANY_CREDIT_HISTORY, {\n    method: 'GET',\n    cache: 'no-cache',\n    variables: {\n      filter: graphqlFilter,\n      pageSize,\n      currentPage,\n    },\n  })\n    .then((response: CompanyCreditHistoryResponse) => {\n      if (response.errors?.length) {\n        return null;\n      }\n\n      const transformedData = transformCompanyCreditHistory(response);\n\n      return transformedData;\n    })\n    .catch(handleNetworkError);\n};\n"],"names":["transformCompanyCredit","response","_d","_c","_b","_a","_h","_g","_f","_e","_l","_k","_j","_i","_p","_o","_n","_m","_t","_s","_r","_q","_x","_w","_v","_u","transformCompanyCreditHistory","creditHistory","item","GET_COMPANY_CREDIT","getCompanyCredit","fetchGraphQl","handleNetworkError","GET_COMPANY_CREDIT_HISTORY","getCompanyCreditHistory","params","filter","pageSize","currentPage","graphqlFilter"],"mappings":"8CAoBO,MAAMA,EACXC,GACsB,qDACtB,MAAO,CACL,OAAQ,CACN,iBAAkB,CAChB,WAAUC,GAAAC,GAAAC,GAAAC,EAAAJ,GAAA,YAAAA,EAAU,OAAV,YAAAI,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,mBAAjC,YAAAD,EAAmD,WAAY,GACzE,QAAOI,GAAAC,GAAAC,GAAAC,EAAAR,GAAA,YAAAA,EAAU,OAAV,YAAAQ,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,mBAAjC,YAAAD,EAAmD,QAAS,CAAA,EAErE,aAAc,CACZ,WAAUI,GAAAC,GAAAC,GAAAC,EAAAZ,GAAA,YAAAA,EAAU,OAAV,YAAAY,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,eAAjC,YAAAD,EAA+C,WAAY,GACrE,QAAOI,GAAAC,GAAAC,GAAAC,EAAAhB,GAAA,YAAAA,EAAU,OAAV,YAAAgB,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,eAAjC,YAAAD,EAA+C,QAAS,CAAA,EAEjE,oBAAqB,CACnB,WAAUI,GAAAC,GAAAC,GAAAC,EAAApB,GAAA,YAAAA,EAAU,OAAV,YAAAoB,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,sBAAjC,YAAAD,EAAsD,WAAY,GAC5E,QAAOI,GAAAC,GAAAC,GAAAC,EAAAxB,GAAA,YAAAA,EAAU,OAAV,YAAAwB,EAAgB,UAAhB,YAAAD,EAAyB,SAAzB,YAAAD,EAAiC,sBAAjC,YAAAD,EAAsD,QAAS,CAAA,CACxE,CACF,CAEJ,ECnBaI,EACXzB,GACyB,iBACzB,MAAM0B,GAAgBvB,GAAAC,EAAAJ,GAAA,YAAAA,EAAU,OAAV,YAAAI,EAAgB,UAAhB,YAAAD,EAAyB,eAE/C,MAAO,CACL,QAAOD,EAAAwB,GAAA,YAAAA,EAAe,QAAf,YAAAxB,EAAsB,IAAIyB,GAAA,qCAAS,OACxC,OAAQ,CACN,WAAUvB,EAAAuB,GAAA,YAAAA,EAAM,SAAN,YAAAvB,EAAc,WAAY,GACpC,QAAOD,EAAAwB,GAAA,YAAAA,EAAM,SAAN,YAAAxB,EAAc,QAAS,CAAA,EAEhC,QAAS,CACP,gBAAiB,CACf,WAAUF,GAAAC,EAAAyB,GAAA,YAAAA,EAAM,UAAN,YAAAzB,EAAe,mBAAf,YAAAD,EAAiC,WAAY,GACvD,QAAOM,GAAAC,EAAAmB,GAAA,YAAAA,EAAM,UAAN,YAAAnB,EAAe,mBAAf,YAAAD,EAAiC,QAAS,CAAA,EAEnD,YAAa,CACX,WAAUF,GAAAC,EAAAqB,GAAA,YAAAA,EAAM,UAAN,YAAArB,EAAe,eAAf,YAAAD,EAA6B,WAAY,GACnD,QAAOM,GAAAC,EAAAe,GAAA,YAAAA,EAAM,UAAN,YAAAf,EAAe,eAAf,YAAAD,EAA6B,QAAS,CAAA,EAE/C,mBAAoB,CAClB,WAAUF,GAAAC,EAAAiB,GAAA,YAAAA,EAAM,UAAN,YAAAjB,EAAe,sBAAf,YAAAD,EAAoC,WAAY,GAC1D,QAAOM,GAAAC,EAAAW,GAAA,YAAAA,EAAM,UAAN,YAAAX,EAAe,sBAAf,YAAAD,EAAoC,QAAS,CAAA,CACtD,EAEF,uBAAuBY,GAAA,YAAAA,EAAM,0BAA2B,OACxD,MAAMA,GAAA,YAAAA,EAAM,OAAQ,GACpB,MAAMA,GAAA,YAAAA,EAAM,OAAQ,GACpB,UAAW,CACT,OAAMb,EAAAa,GAAA,YAAAA,EAAM,aAAN,YAAAb,EAAkB,OAAQ,GAChC,OAAMD,EAAAc,GAAA,YAAAA,EAAM,aAAN,YAAAd,EAAkB,OAAQ,EAAA,CAClC,MACK,CAAA,EACP,SAAU,CACR,cAAaZ,EAAAyB,GAAA,YAAAA,EAAe,YAAf,YAAAzB,EAA0B,eAAgB,EACvD,WAAUO,EAAAkB,GAAA,YAAAA,EAAe,YAAf,YAAAlB,EAA0B,YAAa,GACjD,aAAYD,EAAAmB,GAAA,YAAAA,EAAe,YAAf,YAAAnB,EAA0B,cAAe,CAAA,EAEvD,YAAYmB,GAAA,YAAAA,EAAe,cAAe,CAAA,CAE9C,EC3CaE,EAAmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECOnCC,EAAmB,SAEvB,MAAMC,EAAaF,EAAoB,CAC5C,OAAQ,MACR,MAAO,UAAA,CACR,EACE,KAAM5B,GAAoC,OACzC,OAAII,EAAAJ,EAAS,SAAT,MAAAI,EAAiB,OACZ,KAGeL,EAAuBC,CAAQ,CAGzD,CAAC,EACA,MAAM+B,CAAkB,ECtBhBC,EAA2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECsC3CC,EAA0B,MAAOC,EAAwC,KAA6C,CACjI,KAAM,CAAE,OAAAC,EAAQ,SAAAC,EAAW,GAAI,YAAAC,EAAc,GAAMH,EAG7CI,EAAgBH,EAAS,CAC7B,wBAAyBA,EAAO,sBAChC,eAAgBA,EAAO,cACvB,WAAYA,EAAO,SAAA,EACjB,KAEJ,OAAO,MAAML,EAAaE,EAA4B,CACpD,OAAQ,MACR,MAAO,WACP,UAAW,CACT,OAAQM,EACR,SAAAF,EACA,YAAAC,CAAA,CACF,CACD,EACE,KAAMrC,GAA2C,OAChD,OAAII,EAAAJ,EAAS,SAAT,MAAAI,EAAiB,OACZ,KAGeqB,EAA8BzB,CAAQ,CAGhE,CAAC,EACA,MAAM+B,CAAkB,CAC7B"}