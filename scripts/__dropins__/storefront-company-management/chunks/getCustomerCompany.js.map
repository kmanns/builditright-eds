{"version":3,"file":"getCustomerCompany.js","sources":["/@dropins/storefront-company-management/src/api/companyEnabled/graphql/companyEnabled.graphql.ts","/@dropins/storefront-company-management/src/api/companyEnabled/companyEnabled.ts","/@dropins/storefront-company-management/src/data/transforms/transform-customer-company-info.ts","/@dropins/storefront-company-management/src/api/getCustomerCompany/graphql/getCustomerCompanyInfo.graphql.ts","/@dropins/storefront-company-management/src/api/getCustomerCompany/getCustomerCompany.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_COMPANY_ENABLED = /* GraphQL */ `\n  query GET_COMPANY_ENABLED {\n    storeConfig {\n      company_enabled\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { fetchGraphQl } from '../fetch-graphql';\nimport { GET_COMPANY_ENABLED } from './graphql/companyEnabled.graphql';\n\nexport const companyEnabled = async (): Promise<boolean> => { \n  const response = await fetchGraphQl(GET_COMPANY_ENABLED, { method: 'POST' });\n\n  if ((response as any)?.errors?.length) {\n    throw new Error((response as any).errors[0]?.message || 'Failed to load store configuration');\n  }\n\n  const node = (response as any)?.data?.storeConfig;\n  if (!node) {\n    throw new Error('Invalid response: missing storeConfig');\n  }\n\n  return Boolean(node.company_enabled);\n}\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { CustomerCompanyInfo } from '../models/customer-company-info';\nimport { GetCustomerCompanyInfoResponse } from '../../types/api/getCustomerCompanyInfo.types';\n\n/**\n * Transforms GraphQL response to CustomerCompanyInfo model\n * @param response - GraphQL response containing customer and company data\n * @returns Transformed customer company info or null if data is incomplete\n */\nexport const transformCustomerCompanyInfo = (response: GetCustomerCompanyInfoResponse): CustomerCompanyInfo | null => {\n  const customer = response?.data?.customer;\n  const company = response?.data?.company;\n  \n  if (!customer || !company) {\n    return null;\n  }\n\n  const companyInfo: CustomerCompanyInfo = {\n    customerId: customer?.id,\n    companyName: company?.name ?? '',\n    jobTitle: customer?.job_title ?? '',\n    workPhoneNumber: customer?.telephone ?? '',\n    userRole: customer?.role?.name ?? '',\n  };\n\n  // Only return data if we have at least a company name\n  return companyInfo.companyName ? companyInfo : null;\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_CUSTOMER_COMPANY_INFO = `\n  query GET_CUSTOMER_COMPANY_INFO {\n    customer {\n      id\n      job_title\n      telephone\n      role {\n        id\n        name\n      }\n    }\n    company {\n      id\n      name\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { fetchGraphQl } from '../fetch-graphql';\nimport { companyEnabled } from '../companyEnabled';\nimport { handleNetworkError } from '../../lib/network-error';\nimport { handleFetchError } from '../../lib/fetch-error';\nimport { CustomerCompanyInfo } from '../../data/models';\nimport { GetCustomerCompanyInfoResponse } from '../../types/api/getCustomerCompanyInfo.types';\nimport { transformCustomerCompanyInfo } from '../../data/transforms';\nimport { GET_CUSTOMER_COMPANY_INFO } from './graphql/getCustomerCompanyInfo.graphql';\n\n/**\n * Gets customer company information for display on account information page\n * This is a simplified API that only returns the essential company info needed\n * for the customer account page, without requiring full company permissions\n * \n * @returns Promise resolving to CustomerCompanyInfo or null if company functionality is disabled\n * @throws {Error} When network errors or GraphQL errors occur\n */\nexport async function getCustomerCompany(): Promise<CustomerCompanyInfo | null> {\n  try {\n    // First check if company functionality is enabled\n    const isCompanyEnabled = await companyEnabled();\n    if (!isCompanyEnabled) {\n      return null;\n    }\n\n    // Fetch customer company information\n    const response: GetCustomerCompanyInfoResponse = await fetchGraphQl(GET_CUSTOMER_COMPANY_INFO, { \n      method: 'GET', \n      cache: 'no-cache' \n    });\n\n    if (response.errors?.length) {\n      return handleFetchError(response.errors);\n    }\n\n    // Transform the response using the transformer\n    return transformCustomerCompanyInfo(response);\n\n  } catch (error) {\n    return handleNetworkError(error as Error);\n  }\n}\n"],"names":["GET_COMPANY_ENABLED","companyEnabled","response","fetchGraphQl","_a","_b","node","_c","transformCustomerCompanyInfo","customer","company","companyInfo","GET_CUSTOMER_COMPANY_INFO","getCustomerCompany","handleFetchError","error","handleNetworkError"],"mappings":"mFAiBO,MAAMA,EAAoC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECGpCC,EAAiB,SAA8B,WAC1D,MAAMC,EAAW,MAAMC,EAAaH,EAAqB,CAAE,OAAQ,OAAQ,EAE3E,IAAKI,EAAAF,GAAA,YAAAA,EAAkB,SAAlB,MAAAE,EAA0B,OAC7B,MAAM,IAAI,QAAOC,EAAAH,EAAiB,OAAO,CAAC,IAAzB,YAAAG,EAA4B,UAAW,oCAAoC,EAG9F,MAAMC,GAAQC,EAAAL,GAAA,YAAAA,EAAkB,OAAlB,YAAAK,EAAwB,YACtC,GAAI,CAACD,EACH,MAAM,IAAI,MAAM,uCAAuC,EAGzD,MAAO,EAAQA,EAAK,eACtB,ECTaE,EAAgCN,GAAyE,WACpH,MAAMO,GAAWL,EAAAF,GAAA,YAAAA,EAAU,OAAV,YAAAE,EAAgB,SAC3BM,GAAUL,EAAAH,GAAA,YAAAA,EAAU,OAAV,YAAAG,EAAgB,QAEhC,GAAI,CAACI,GAAY,CAACC,EAChB,OAAO,KAGT,MAAMC,EAAmC,CACvC,WAAYF,GAAA,YAAAA,EAAU,GACtB,aAAaC,GAAA,YAAAA,EAAS,OAAQ,GAC9B,UAAUD,GAAA,YAAAA,EAAU,YAAa,GACjC,iBAAiBA,GAAA,YAAAA,EAAU,YAAa,GACxC,WAAUF,EAAAE,GAAA,YAAAA,EAAU,OAAV,YAAAF,EAAgB,OAAQ,EAAA,EAIpC,OAAOI,EAAY,YAAcA,EAAc,IACjD,ECzBaC,EAA4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECgBzC,eAAsBC,GAA0D,OAC9E,GAAI,CAGF,GAAI,CADqB,MAAMZ,EAAA,EAE7B,OAAO,KAIT,MAAMC,EAA2C,MAAMC,EAAaS,EAA2B,CAC7F,OAAQ,MACR,MAAO,UAAA,CACR,EAED,OAAIR,EAAAF,EAAS,SAAT,MAAAE,EAAiB,OACZU,EAAiBZ,EAAS,MAAM,EAIlCM,EAA6BN,CAAQ,CAE9C,OAASa,EAAO,CACd,OAAOC,EAAmBD,CAAc,CAC1C,CACF"}