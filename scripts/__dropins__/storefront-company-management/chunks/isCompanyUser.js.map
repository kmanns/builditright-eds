{"version":3,"file":"isCompanyUser.js","sources":["/@dropins/storefront-company-management/src/api/allowCompanyRegistration/graphql/allowCompanyRegistration.graphql.ts","/@dropins/storefront-company-management/src/api/allowCompanyRegistration/allowCompanyRegistration.ts","/@dropins/storefront-company-management/src/api/isCompanyUser/graphql/isCompanyUser.graphql.ts","/@dropins/storefront-company-management/src/api/isCompanyUser/isCompanyUser.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_ALLOW_COMPANY_REGISTRATION = /* GraphQL */ `\n  query GET_ALLOW_COMPANY_REGISTRATION {\n    storeConfig {\n      allow_company_registration\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { fetchGraphQl } from '../fetch-graphql';\nimport { GET_ALLOW_COMPANY_REGISTRATION } from './graphql/allowCompanyRegistration.graphql';\n\nexport const allowCompanyRegistration = async (): Promise<boolean> => { \n  const response = await fetchGraphQl(GET_ALLOW_COMPANY_REGISTRATION, { method: 'POST' });\n\n  if ((response as any)?.errors?.length) {\n    throw new Error((response as any).errors[0]?.message || 'Failed to load store configuration');\n  }\n\n  const node = (response as any)?.data?.storeConfig;\n  if (!node) {\n    throw new Error('Invalid response: missing storeConfig');\n  }\n\n  // Backend guarantees that companyEnabled is true if allowCompanyRegistration is true\n  return Boolean(node.allow_company_registration);\n}\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nexport const GET_CUSTOMER_COMPANIES = /* GraphQL */ `\n  query GET_CUSTOMER_COMPANIES {\n    customer {\n      companies(input: {}) {\n        items {\n          id\n          name\n        }\n      }\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n  \nimport { fetchGraphQl } from '../fetch-graphql';\nimport { GET_CUSTOMER_COMPANIES } from './graphql/isCompanyUser.graphql';\n\ninterface CompanyItem {\n  id: string;\n  name: string;\n}\n\ninterface CustomerCompaniesResponse {\n  customer: {\n    companies: {\n      items: CompanyItem[];\n    };\n  } | null;\n}\n\n/**\n * Check if the current authenticated customer belongs to any company\n * @returns Promise<boolean> - true if customer belongs to one or more companies, false otherwise\n */\nexport const isCompanyUser = async (): Promise<boolean> => {\n  try {\n    const response = await fetchGraphQl<CustomerCompaniesResponse>(GET_CUSTOMER_COMPANIES, {\n      method: 'POST',\n    });\n\n    if (response.errors?.length) {\n      return false;\n    }\n\n    const companies = (response as any)?.data?.customer?.companies?.items ?? [];\n    return Array.isArray(companies) && companies.length > 0;\n  } catch (error) {\n    return false;\n  }\n};\n"],"names":["GET_ALLOW_COMPANY_REGISTRATION","allowCompanyRegistration","response","fetchGraphQl","_a","_b","node","_c","GET_CUSTOMER_COMPANIES","isCompanyUser","companies","_d"],"mappings":"uCAiBO,MAAMA,EAA+C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECG/CC,EAA2B,SAA8B,WACpE,MAAMC,EAAW,MAAMC,EAAaH,EAAgC,CAAE,OAAQ,OAAQ,EAEtF,IAAKI,EAAAF,GAAA,YAAAA,EAAkB,SAAlB,MAAAE,EAA0B,OAC7B,MAAM,IAAI,QAAOC,EAAAH,EAAiB,OAAO,CAAC,IAAzB,YAAAG,EAA4B,UAAW,oCAAoC,EAG9F,MAAMC,GAAQC,EAAAL,GAAA,YAAAA,EAAkB,OAAlB,YAAAK,EAAwB,YACtC,GAAI,CAACD,EACH,MAAM,IAAI,MAAM,uCAAuC,EAIzD,MAAO,EAAQA,EAAK,0BACtB,ECjBaE,EAAuC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECoBvCC,EAAgB,SAA8B,aACzD,GAAI,CACF,MAAMP,EAAW,MAAMC,EAAwCK,EAAwB,CACrF,OAAQ,MAAA,CACT,EAED,IAAIJ,EAAAF,EAAS,SAAT,MAAAE,EAAiB,OACnB,MAAO,GAGT,MAAMM,IAAaC,GAAAJ,GAAAF,EAAAH,GAAA,YAAAA,EAAkB,OAAlB,YAAAG,EAAwB,WAAxB,YAAAE,EAAkC,YAAlC,YAAAI,EAA6C,QAAS,CAAA,EACzE,OAAO,MAAM,QAAQD,CAAS,GAAKA,EAAU,OAAS,CACxD,MAAgB,CACd,MAAO,EACT,CACF"}