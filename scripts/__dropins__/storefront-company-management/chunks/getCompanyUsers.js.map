{"version":3,"file":"getCompanyUsers.js","sources":["/@dropins/storefront-company-management/src/api/deleteCompanyUser/graphql/deleteCompanyUser.graphql.ts","/@dropins/storefront-company-management/src/api/deleteCompanyUser/deleteCompanyUser.ts","/@dropins/storefront-company-management/src/api/getCompanyUsers/graphql/companyUsers.graphql.ts","/@dropins/storefront-company-management/src/api/getCompanyUsers/getCompanyUsers.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nexport const DELETE_COMPANY_USER_MUTATION = /* GraphQL */ `\n  mutation DELETE_COMPANY_USER($id: ID!) {\n    deleteCompanyUserV2(id: $id) {\n      success\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { fetchGraphQl } from '@/company-management/api';\nimport { handleNetworkError, handleFetchError } from '@/company-management/lib';\nimport { DELETE_COMPANY_USER_MUTATION } from './graphql/deleteCompanyUser.graphql';\nimport { DeleteCompanyUserMutation, DeleteCompanyUserParams, DeleteCompanyUserResponse } from '@/company-management/types';\n\n/**\n * Deletes a company user by their ID\n * @param params - The parameters containing user ID\n * @param params.id - The ID of the user to delete (base64 encoded UID from GraphQL)\n * @returns Promise<DeleteCompanyUserResponse> - Object containing success status\n */\nexport const deleteCompanyUser = async (params: DeleteCompanyUserParams): Promise<DeleteCompanyUserResponse> => {\n  const { id } = params;\n\n  if (!id) {\n    throw new Error('User ID is required to delete a company user');\n  }\n\n  const response = await fetchGraphQl<DeleteCompanyUserMutation>(\n    DELETE_COMPANY_USER_MUTATION,\n    {\n      method: 'POST',\n      cache: 'no-cache',\n      variables: {\n        id\n      }\n    }\n  ).catch(handleNetworkError);\n\n  if (response.errors?.length) {\n    handleFetchError(response.errors);\n  }\n\n  if (!response.data?.deleteCompanyUserV2) {\n    return {\n      success: false\n    };\n  }\n\n  return {\n    success: response.data.deleteCompanyUserV2.success\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nexport const COMPANY_USERS_QUERY = /* GraphQL */ `\n  query COMPANY_USERS($pageSize: Int!, $currentPage: Int!, $filter: CompanyUsersFilterInput) {\n    company {\n      users(pageSize: $pageSize, currentPage: $currentPage, filter: $filter) {\n        items {\n          id\n          firstname\n          lastname\n          email\n          role {\n            name\n          }\n          status\n          team {\n            name\n          }\n        }\n        page_info {\n          page_size\n          current_page\n          total_pages\n        }\n        total_count\n      }\n    }\n  }\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\nimport { fetchGraphQl } from '@/company-management/api';\nimport { handleNetworkError, handleFetchError } from '@/company-management/lib';\nimport { COMPANY_USERS_QUERY } from './graphql/companyUsers.graphql';\nimport { CompanyUsersQuery, CompanyUser, CompanyUsersParams, CompanyUsersResponse } from '@/company-management/types';\n\n/**\n * Fetches the list of company users with pagination and optional filtering\n * @param params - Query parameters\n * @param params.pageSize - Number of items per page (default: 20)\n * @param params.currentPage - Current page number (default: 1)\n * @param params.filter - Optional filter to apply (e.g., { status: 'ACTIVE' })\n * @returns Promise<CompanyUsersResponse> - Object containing array of company users with base64-encoded IDs and pagination info\n */\nexport const getCompanyUsers = async (params: CompanyUsersParams = {}): Promise<CompanyUsersResponse> => {\n  const { pageSize = 20, currentPage = 1, filter } = params;\n\n  try {\n    const response = await fetchGraphQl<CompanyUsersQuery>(\n      COMPANY_USERS_QUERY,\n      {\n        method: 'GET',\n        cache: 'no-cache',\n        variables: {\n          pageSize,\n          currentPage,\n          filter\n        }\n      }\n    ).catch(handleNetworkError);\n\n    if (response.errors?.length) {\n      handleFetchError(response.errors);\n    }\n\n    if (!response.data?.company?.users?.items) {\n      return {\n        users: [],\n        pageInfo: {\n          pageSize,\n          currentPage,\n          totalPages: 1\n        }\n      };\n    }\n\n    // Transform the GraphQL response to CompanyUser interface\n    // Keep IDs base64-encoded for consistency with other APIs\n    const users: CompanyUser[] = response.data.company.users.items.map((item) => {\n      return {\n        id: item.id,\n        firstName: item.firstname,\n        lastName: item.lastname,\n        email: item.email,\n        role: item.role.name,\n        status: item.status,\n        ...(item.team && { team: item.team.name })\n      };\n    });\n\n    return {\n      users,\n      pageInfo: {\n        pageSize: response.data.company.users.page_info.page_size,\n        currentPage: response.data.company.users.page_info.current_page,\n        totalPages: response.data.company.users.page_info.total_pages\n      },\n      totalCount: response.data.company.users.total_count\n    };\n  } catch (error) {\n    // Both handleNetworkError and handleFetchError throw errors\n    // We return empty users array with default page info as fallback\n    return {\n      users: [],\n      pageInfo: {\n        pageSize,\n        currentPage,\n        totalPages: 1\n      }\n    };\n  }\n};\n"],"names":["DELETE_COMPANY_USER_MUTATION","deleteCompanyUser","params","id","response","fetchGraphQl","handleNetworkError","_a","handleFetchError","_b","COMPANY_USERS_QUERY","getCompanyUsers","pageSize","currentPage","filter","_d","_c","item"],"mappings":"mFAgBO,MAAMA,EAA6C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECW7CC,EAAoB,MAAOC,GAAwE,SAC9G,KAAM,CAAE,GAAAC,GAAOD,EAEf,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,8CAA8C,EAGhE,MAAMC,EAAW,MAAMC,EACrBL,EACA,CACE,OAAQ,OACR,MAAO,WACP,UAAW,CACT,GAAAG,CAAA,CACF,CACF,EACA,MAAMG,CAAkB,EAM1B,OAJIC,EAAAH,EAAS,SAAT,MAAAG,EAAiB,QACnBC,EAAiBJ,EAAS,MAAM,GAG7BK,EAAAL,EAAS,OAAT,MAAAK,EAAe,oBAMb,CACL,QAASL,EAAS,KAAK,oBAAoB,OAAA,EANpC,CACL,QAAS,EAAA,CAOf,EC1CaM,EAAoC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECapCC,EAAkB,MAAOT,EAA6B,KAAsC,aACvG,KAAM,CAAE,SAAAU,EAAW,GAAI,YAAAC,EAAc,EAAG,OAAAC,GAAWZ,EAEnD,GAAI,CACF,MAAME,EAAW,MAAMC,EACrBK,EACA,CACE,OAAQ,MACR,MAAO,WACP,UAAW,CACT,SAAAE,EACA,YAAAC,EACA,OAAAC,CAAA,CACF,CACF,EACA,MAAMR,CAAkB,EAM1B,OAJIC,EAAAH,EAAS,SAAT,MAAAG,EAAiB,QACnBC,EAAiBJ,EAAS,MAAM,GAG7BW,GAAAC,GAAAP,EAAAL,EAAS,OAAT,YAAAK,EAAe,UAAf,YAAAO,EAAwB,QAAxB,MAAAD,EAA+B,MAyB7B,CACL,MAb2BX,EAAS,KAAK,QAAQ,MAAM,MAAM,IAAKa,IAC3D,CACL,GAAIA,EAAK,GACT,UAAWA,EAAK,UAChB,SAAUA,EAAK,SACf,MAAOA,EAAK,MACZ,KAAMA,EAAK,KAAK,KAChB,OAAQA,EAAK,OACb,GAAIA,EAAK,MAAQ,CAAE,KAAMA,EAAK,KAAK,IAAA,CAAK,EAE3C,EAIC,SAAU,CACR,SAAUb,EAAS,KAAK,QAAQ,MAAM,UAAU,UAChD,YAAaA,EAAS,KAAK,QAAQ,MAAM,UAAU,aACnD,WAAYA,EAAS,KAAK,QAAQ,MAAM,UAAU,WAAA,EAEpD,WAAYA,EAAS,KAAK,QAAQ,MAAM,WAAA,EA/BjC,CACL,MAAO,CAAA,EACP,SAAU,CACR,SAAAQ,EACA,YAAAC,EACA,WAAY,CAAA,CACd,CA2BN,MAAgB,CAGd,MAAO,CACL,MAAO,CAAA,EACP,SAAU,CACR,SAAAD,EACA,YAAAC,EACA,WAAY,CAAA,CACd,CAEJ,CACF"}