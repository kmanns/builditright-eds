{"version":3,"file":"AddressValidation.js","sources":["/@dropins/storefront-account/src/components/AddressValidation/AddressValidation.tsx","/@dropins/storefront-account/src/containers/AddressValidation/AddressValidation.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport '@/account/components/AddressValidation/AddressValidation.css';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { FunctionComponent } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport { Header, ToggleButton } from '@adobe-commerce/elsie/components';\nimport { CustomerAddressesModel } from '@/account/data/models';\n\nexport interface AddressValidationProps extends HTMLAttributes<HTMLDivElement> {\n  busy?: boolean;\n  originalAddress: CustomerAddressesModel | null;\n  selection: 'suggested' | 'original' | null;\n  suggestedAddress: CustomerAddressesModel | null;\n  onSelectionChange: (selection: 'suggested' | 'original') => void;\n}\n\nexport function formatAddressLine(\n  address: CustomerAddressesModel | null | undefined\n): string[] {\n  if (!address) return [];\n  const name = `${address.firstName} ${address.lastName}`.trim();\n  const street = address.street ?? '';\n  const city = address.city ?? '';\n  const region = address.region || undefined;\n  const post = address.postcode ?? '';\n  const country = address.countryCode ?? '';\n\n  let cityRegion = '';\n  if (city && region) {\n    cityRegion = `${city}, ${region?.regionCode ?? ''}`.trim();\n  } else if (city) {\n    cityRegion = city;\n  } else if (region) {\n    cityRegion = region?.regionCode ?? '';\n  }\n\n  let cityRegionPost = cityRegion;\n  if (post) {\n    cityRegionPost = cityRegion ? `${cityRegion} ${post}` : post;\n  }\n\n  let line3 = cityRegionPost;\n  if (country) {\n    line3 = cityRegionPost ? `${cityRegionPost}, ${country}` : country;\n  }\n\n  return [name, street, line3];\n}\n\nconst AddressBlock: FunctionComponent<{\n  title: string;\n  address: CustomerAddressesModel | null | undefined;\n  selected: boolean;\n  busy?: boolean;\n  onChange: () => void;\n}> = ({ title, address, selected, busy, onChange }) => {\n  const [line1, line2, line3] = formatAddressLine(address);\n  const label = (\n    <div>\n      <div className=\"account-address-validation__option-title\">\n        <strong>{title}</strong>\n      </div>\n      {line1 && <div>{line1}</div>}\n      {line2 && <div>{line2}</div>}\n      {line3 && <div>{line3}</div>}\n    </div>\n  );\n  return (\n    <div className=\"account-address-validation__option\">\n      <ToggleButton\n        busy={busy}\n        className=\"account-address-validation__radio\"\n        label={label}\n        name=\"address-validation-choice\"\n        selected={selected}\n        value={title}\n        onChange={onChange}\n      />\n    </div>\n  );\n};\n\nexport const AddressValidation: FunctionComponent<AddressValidationProps> = ({\n  busy = false,\n  className,\n  originalAddress,\n  onSelectionChange,\n  selection,\n  suggestedAddress,\n}) => {\n  const hasSuggestion = !!suggestedAddress;\n  const translations = useText({\n    title: 'Account.AddressValidation.title',\n    subtitle: 'Account.AddressValidation.subtitle',\n    suggestedAddress: 'Account.AddressValidation.suggestedAddress',\n    originalAddress: 'Account.AddressValidation.originalAddress',\n  });\n\n  return (\n    <div className={classes(['account-address-validation', className])}>\n      <Header\n        className=\"account-address-validation__title\"\n        divider={false}\n        title={translations.title}\n      />\n      <div className=\"account-address-validation__subtitle\">\n        {translations.subtitle}\n      </div>\n\n      <div\n        className={classes([\n          'account-address-validation__options',\n          busy && 'account-address-validation__options--busy',\n        ])}\n      >\n        {hasSuggestion && (\n          <AddressBlock\n            address={suggestedAddress}\n            busy={busy}\n            selected={selection === 'suggested'}\n            title={translations.suggestedAddress}\n            onChange={() => onSelectionChange('suggested')}\n          />\n        )}\n\n        <AddressBlock\n          address={originalAddress}\n          busy={busy}\n          selected={selection === 'original'}\n          title={translations.originalAddress}\n          onChange={() => onSelectionChange('original')}\n        />\n      </div>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { Container } from '@adobe-commerce/elsie/lib';\nimport { useCallback, useEffect, useMemo, useState } from 'preact/hooks';\nimport { AddressValidation as AddressValidationComponent } from '@/account/components';\nimport { CustomerAddressesModel } from '@/account/data/models';\n\nexport interface AddressValidationProps {\n  selectedAddress?: 'suggested' | 'original' | null;\n  suggestedAddress: Partial<CustomerAddressesModel> | null;\n  originalAddress: CustomerAddressesModel | null;\n  handleSelectedAddress?: (payload: {\n    selection: 'suggested' | 'original';\n    address: CustomerAddressesModel | null | undefined;\n  }) => void;\n}\n\nexport const AddressValidation: Container<AddressValidationProps> = ({\n  selectedAddress = null,\n  suggestedAddress,\n  originalAddress,\n  handleSelectedAddress,\n}) => {\n  const [selection, setSelection] = useState<'suggested' | 'original' | null>(\n    selectedAddress\n  );\n  const [busy, setBusy] = useState(false);\n\n  const mergedSuggestedAddress = useMemo<CustomerAddressesModel | null>(() => {\n    if (!suggestedAddress || !originalAddress) return null;\n    return { ...originalAddress, ...suggestedAddress };\n  }, [originalAddress, suggestedAddress]);\n\n  const onSelectionChange = useCallback(\n    async (sel: 'suggested' | 'original') => {\n      setSelection(sel);\n      const chosen =\n        sel === 'suggested' ? mergedSuggestedAddress : originalAddress;\n      setBusy(true);\n      try {\n        await handleSelectedAddress?.({ selection: sel, address: chosen });\n      } finally {\n        setBusy(false);\n      }\n    },\n    [mergedSuggestedAddress, originalAddress, handleSelectedAddress]\n  );\n\n  useEffect(() => {\n    if (!selection) return;\n    onSelectionChange(selection);\n  }, [selection, onSelectionChange]);\n\n  return (\n    <AddressValidationComponent\n      busy={busy}\n      originalAddress={originalAddress}\n      selection={selection}\n      suggestedAddress={mergedSuggestedAddress}\n      onSelectionChange={onSelectionChange}\n    />\n  );\n};\n"],"names":["formatAddressLine","address","name","street","city","region","post","country","cityRegion","cityRegionPost","line3","AddressBlock","title","selected","busy","onChange","line1","line2","jsx","ToggleButton","AddressValidation","className","originalAddress","onSelectionChange","selection","suggestedAddress","hasSuggestion","translations","useText","jsxs","classes","Header","selectedAddress","handleSelectedAddress","setSelection","useState","setBusy","mergedSuggestedAddress","useMemo","useCallback","sel","chosen","useEffect","AddressValidationComponent"],"mappings":"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"}