{"version":3,"file":"RequisitionListForm.js","sources":["/@dropins/storefront-requisition-list/src/lib/constants.ts","/@dropins/storefront-requisition-list/src/components/RequisitionListForm/RequisitionListForm.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\n/**\n * Default page size for pagination in requisition lists\n */\nexport const DEFAULT_PAGE_SIZE = 10;\n\n/**\n * Validation constants for requisition list forms\n */\nexport const NAME_MIN_LENGTH = 3;\nexport const NAME_MAX_LENGTH = 40;\nexport const DESCRIPTION_MAX_LENGTH = 255;\n// Allow letters, numbers, spaces, and common punctuation: . , - _ ! ? ' \" ( ) &\nexport const NAME_VALID_CHARS = /^[a-zA-Z0-9\\s.,\\-_!?'\"()&]+$/;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport { useState } from 'preact/hooks';\nimport {\n  Field,\n  Input,\n  TextArea,\n  Button,\n  InLineAlert,\n  ProgressSpinner,\n} from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport {\n  RequisitionListFormMode,\n  RequisitionListFormValues,\n} from '@/requisitionList/hooks/useRequisitionListForm';\nimport {\n  NAME_MIN_LENGTH,\n  NAME_MAX_LENGTH,\n  DESCRIPTION_MAX_LENGTH,\n  NAME_VALID_CHARS,\n} from '@/requisitionList/lib/constants';\n\nimport '@/requisitionList/components/RequisitionListForm/RequisitionListForm.css';\n\nexport interface RequisitionListFormProps\n  extends HTMLAttributes<HTMLDivElement> {\n  className?: string;\n  mode: RequisitionListFormMode;\n  defaultValues?: RequisitionListFormValues;\n  error?: string | null;\n  onSubmit: (values: RequisitionListFormValues) => Promise<void> | void;\n  onCancel: () => void;\n}\n\nexport const RequisitionListForm: FunctionComponent<\n  RequisitionListFormProps\n> = ({\n  className,\n  mode,\n  defaultValues = { name: '', description: '' },\n  error = null,\n  onSubmit,\n  onCancel,\n  ...props\n}) => {\n  const [values, setValues] =\n    useState<RequisitionListFormValues>(defaultValues);\n  const [touched, setTouched] = useState({\n    name: false,\n  });\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const translations = useText({\n    actionCancel: `RequisitionList.RequisitionListForm.actionCancel`,\n    actionSave: `RequisitionList.RequisitionListForm.actionSave`,\n    requiredField: `RequisitionList.RequisitionListForm.requiredField`,\n    nameMinLength: `RequisitionList.RequisitionListForm.nameMinLength`,\n    nameInvalidCharacters: `RequisitionList.RequisitionListForm.nameInvalidCharacters`,\n    floatingLabel: `RequisitionList.RequisitionListForm.floatingLabel`,\n    placeholder: `RequisitionList.RequisitionListForm.placeholder`,\n    label: `RequisitionList.RequisitionListForm.label`,\n    updateTitle: `RequisitionList.RequisitionListForm.updateTitle`,\n    createTitle: `RequisitionList.RequisitionListForm.createTitle`,\n  });\n\n  // Validation functions\n  const validateName = (name: string): string => {\n    const trimmedName = name.trim();\n\n    if (!trimmedName) {\n      return translations.requiredField;\n    }\n\n    if (trimmedName.length < NAME_MIN_LENGTH) {\n      return translations.nameMinLength.replace(\n        '{min}',\n        NAME_MIN_LENGTH.toString()\n      );\n    }\n\n    if (!NAME_VALID_CHARS.test(trimmedName)) {\n      return translations.nameInvalidCharacters;\n    }\n\n    return '';\n  };\n\n  const handleChange =\n    (field: keyof RequisitionListFormValues) => (e: Event) => {\n      const target = e.target as HTMLInputElement | HTMLTextAreaElement;\n      setValues((prevValues) => ({\n        ...prevValues,\n        [field]: target.value,\n      }));\n    };\n\n  const handleBlur = (field: keyof RequisitionListFormValues) => () => {\n    setTouched((prev) => ({ ...prev, [field]: true }));\n  };\n\n  const handleSubmit = async (e: Event) => {\n    e.preventDefault();\n\n    // Mark all fields as touched on submit attempt\n    setTouched({ name: true, description: true });\n\n    // Validate all fields\n    const nameError = validateName(values.name);\n\n    if (nameError || isSubmitting) return;\n\n    setIsSubmitting(true);\n    try {\n      await onSubmit({\n        name: values.name.trim(),\n        description: values.description?.trim() ?? '',\n      });\n    } catch {\n      setIsSubmitting(false);\n    }\n  };\n\n  // Calculate error messages\n  const nameError = touched.name ? validateName(values.name) : '';\n\n  const title =\n    mode === 'update' ? translations.updateTitle : translations.createTitle;\n\n  return (\n    <div {...props} className={classes(['requisition-list-form', className])}>\n      <div className=\"requisition-list-form__title\">\n        {title}\n        {isSubmitting ? (\n          <div\n            className={classes([\n              'requisition-list-form_progress-spinner',\n              className,\n            ])}\n            data-testid=\"requisition-list-form-progress-spinner\"\n          >\n            <ProgressSpinner stroke={'4'} size={'small'} />\n          </div>\n        ) : null}\n      </div>\n\n      {error ? (\n        <InLineAlert\n          type=\"error\"\n          className=\"requisition-list-form__notification\"\n          variant=\"secondary\"\n          heading={error}\n          data-testid=\"requisition-list-alert\"\n        />\n      ) : null}\n\n      <form\n        className={classes(['requisition-list-form__form', className])}\n        onSubmit={handleSubmit}\n      >\n        <Field error={nameError} disabled={isSubmitting}>\n          <Input\n            id=\"requisition-list-form-name\"\n            name=\"name\"\n            type=\"text\"\n            floatingLabel={translations.floatingLabel}\n            placeholder={translations.placeholder}\n            maxLength={NAME_MAX_LENGTH}\n            value={values.name}\n            onChange={handleChange('name')}\n            onBlur={handleBlur('name')}\n          />\n        </Field>\n\n        <Field disabled={isSubmitting}>\n          <TextArea\n            id=\"requisition-list-form-description\"\n            name=\"description\"\n            label={translations.label}\n            placeholder={translations.label}\n            maxLength={DESCRIPTION_MAX_LENGTH}\n            value={values.description}\n            onChange={handleChange('description')}\n            onBlur={handleBlur('description')}\n          />\n        </Field>\n\n        <div className=\"requisition-list-form__actions\">\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            onClick={onCancel}\n            disabled={isSubmitting}\n            data-testid=\"requisition-list-form-cancel\"\n          >\n            {translations.actionCancel}\n          </Button>\n          <Button\n            type=\"submit\"\n            disabled={isSubmitting}\n            data-testid=\"requisition-list-form-save\"\n          >\n            {translations.actionSave}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n};\n"],"names":["DEFAULT_PAGE_SIZE","NAME_MIN_LENGTH","NAME_MAX_LENGTH","DESCRIPTION_MAX_LENGTH","NAME_VALID_CHARS","RequisitionListForm","className","mode","defaultValues","error","onSubmit","onCancel","props","values","setValues","useState","touched","setTouched","isSubmitting","setIsSubmitting","translations","useText","validateName","name","trimmedName","handleChange","field","e","target","prevValues","handleBlur","prev","handleSubmit","nameError","_a","title","jsxs","classes","jsx","ProgressSpinner","InLineAlert","Field","Input","TextArea","Button"],"mappings":"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"}