{"version":3,"file":"RequisitionListHeader.js","sources":["/@dropins/storefront-requisition-list/src/components/RequisitionListHeader/RequisitionListHeader.tsx","/@dropins/storefront-requisition-list/src/containers/RequisitionListHeader/RequisitionListHeader.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport '@/requisitionList/components/RequisitionListHeader/RequisitionListHeader.css';\n\nexport interface RequisitionListHeaderProps\n  extends HTMLAttributes<HTMLDivElement> {\n  name: string;\n  description?: string;\n  backLink?: {\n    url: string;\n    label: string;\n    onClick?: (e: Event) => void;\n  };\n  actions?: {\n    onRename?: () => void;\n    onDelete?: () => void;\n    renameLabel?: string;\n    deleteLabel?: string;\n  };\n}\n\nexport const RequisitionListHeader: FunctionComponent<\n  RequisitionListHeaderProps\n> = ({ name, description, backLink, actions, className, ...props }) => {\n  return (\n    <div {...props} className={`requisition-list-header ${className || ''}`}>\n      {/* Back Link */}\n      {backLink && (\n        <div className=\"requisition-list-header__back\">\n          <a\n            href={backLink.url}\n            className=\"requisition-list-header__back-link\"\n            onClick={backLink.onClick}\n          >\n            <span className=\"requisition-list-header__back-arrow\">&lt;</span>\n            {backLink.label}\n          </a>\n        </div>\n      )}\n\n      {/* Title and Actions Row */}\n      <div className=\"requisition-list-header__main\">\n        <div className=\"requisition-list-header__title-section\">\n          <h1 className=\"requisition-list-header__title\">{name}</h1>\n          {description && (\n            <p className=\"requisition-list-header__description\">\n              {description}\n            </p>\n          )}\n        </div>\n\n        {/* Action Links */}\n        {actions && (actions.onRename || actions.onDelete) && (\n          <div className=\"requisition-list-header__actions\">\n            {actions.onRename && (\n              <a\n                href=\"#\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  actions.onRename?.();\n                }}\n                className=\"requisition-list-header__action-link\"\n                data-testid=\"rename-list-btn\"\n              >\n                {actions.renameLabel}\n              </a>\n            )}\n            {actions.onDelete && (\n              <a\n                href=\"#\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  actions.onDelete?.();\n                }}\n                className=\"requisition-list-header__action-link\"\n                data-testid=\"delete-list-btn\"\n              >\n                {actions.deleteLabel}\n              </a>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useState, useCallback } from 'preact/hooks';\nimport { Container } from '@adobe-commerce/elsie/lib';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { RequisitionListHeader as RequisitionListHeaderComponent } from '@/requisitionList/components/RequisitionListHeader/RequisitionListHeader';\nimport { RequisitionListForm } from '@/requisitionList/components/RequisitionListForm/RequisitionListForm';\nimport { RequisitionListModal } from '@/requisitionList/components/RequisitionListModal/RequisitionListModal';\nimport { updateRequisitionList } from '@/requisitionList/api/updateRequisitionList';\nimport { deleteRequisitionList } from '@/requisitionList/api/deleteRequisitionList';\nimport { RequisitionList } from '@/requisitionList/data/models/requisitionList';\n\nexport interface RequisitionListHeaderProps {\n  requisitionList: RequisitionList;\n  routeRequisitionListGrid?: () => string | void;\n  onUpdate?: (updatedList: RequisitionList) => void | Promise<void>;\n  onAlert?: (payload: {\n    action: string;\n    type: string;\n    context: string;\n  }) => void;\n}\n\nexport const RequisitionListHeader: Container<RequisitionListHeaderProps> = ({\n  requisitionList,\n  routeRequisitionListGrid,\n  onUpdate,\n  onAlert,\n}) => {\n  const [showRenameModal, setShowRenameModal] = useState<boolean>(false);\n  const [showDeleteModal, setShowDeleteModal] = useState<boolean>(false);\n  const [isDeleting, setIsDeleting] = useState<boolean>(false);\n\n  const translations = useText({\n    actionBackToRequisitionLists: `RequisitionList.RequisitionListView.actionBackToRequisitionLists`,\n    actionRename: `RequisitionList.RequisitionListView.actionRename`,\n    actionDeleteList: `RequisitionList.RequisitionListView.actionDeleteList`,\n    deleteListTitle: `RequisitionList.RequisitionListView.deleteListTitle`,\n    deleteListMessage: `RequisitionList.RequisitionListView.deleteListMessage`,\n    confirmAction: `RequisitionList.RequisitionListWrapper.confirmAction`,\n    cancelAction: `RequisitionList.RequisitionListWrapper.cancelAction`,\n    updateTitle: `RequisitionList.RequisitionListForm.updateTitle`,\n  });\n\n  const handleRename = useCallback(() => {\n    setShowRenameModal(true);\n  }, []);\n\n  const handleRenameSubmit = useCallback(\n    async (values: { name: string; description?: string }) => {\n      try {\n        const updatedList = await updateRequisitionList(\n          requisitionList.uid,\n          values.name,\n          values.description,\n          requisitionList.page_info?.page_size,\n          requisitionList.page_info?.current_page\n        );\n        if (updatedList) {\n          onUpdate?.(updatedList);\n          setShowRenameModal(false);\n          onAlert?.({\n            action: 'update',\n            type: 'success',\n            context: 'requisitionList',\n          });\n        } else {\n          onAlert?.({\n            action: 'update',\n            type: 'error',\n            context: 'requisitionList',\n          });\n        }\n      } catch (error) {\n        onAlert?.({\n          action: 'update',\n          type: 'error',\n          context: 'requisitionList',\n        });\n      }\n    },\n    [requisitionList.uid, requisitionList.page_info, onUpdate, onAlert]\n  );\n\n  const handleDeleteList = useCallback(() => {\n    setShowDeleteModal(true);\n  }, []);\n\n  const handleDeleteConfirm = useCallback(async () => {\n    setIsDeleting(true);\n    try {\n      const result = await deleteRequisitionList(requisitionList.uid);\n      if (result) {\n        const alertPayload = {\n          action: 'delete',\n          type: 'success',\n          context: 'requisitionList',\n        };\n\n        // Store alert in localStorage before redirecting\n        // This ensures the alert is shown after redirect to grid view\n        try {\n          localStorage.setItem(\n            'requisitionListPendingAlert',\n            JSON.stringify(alertPayload)\n          );\n        } catch (e) {\n          // Ignore localStorage errors (e.g., in private browsing mode)\n        }\n\n        if (routeRequisitionListGrid) {\n          const url = routeRequisitionListGrid();\n          // If a URL is returned, navigate to it\n          if (url && typeof url === 'string') {\n            window.location.href = url;\n          }\n        }\n      } else {\n        onAlert?.({\n          action: 'delete',\n          type: 'error',\n          context: 'requisitionList',\n        });\n      }\n    } catch (error) {\n      onAlert?.({\n        action: 'delete',\n        type: 'error',\n        context: 'requisitionList',\n      });\n    } finally {\n      setIsDeleting(false);\n      setShowDeleteModal(false);\n    }\n  }, [requisitionList.uid, routeRequisitionListGrid, onAlert]);\n\n  return (\n    <>\n      <RequisitionListHeaderComponent\n        name={requisitionList.name}\n        description={requisitionList.description}\n        backLink={\n          routeRequisitionListGrid\n            ? {\n                url: '#',\n                label: translations.actionBackToRequisitionLists,\n                onClick: (e: Event) => {\n                  e.preventDefault();\n                  const result = routeRequisitionListGrid();\n                  // If a URL is returned, navigate to it\n                  if (result && typeof result === 'string') {\n                    window.location.href = result;\n                  }\n                },\n              }\n            : undefined\n        }\n        actions={{\n          onRename: handleRename,\n          onDelete: handleDeleteList,\n          renameLabel: translations.actionRename,\n          deleteLabel: translations.actionDeleteList,\n        }}\n      />\n\n      {/* Rename Modal */}\n      {showRenameModal && (\n        <RequisitionListModal\n          isOpen={showRenameModal}\n          isLoading={false}\n          title={translations.updateTitle}\n          modalContent={\n            <RequisitionListForm\n              mode=\"update\"\n              defaultValues={{\n                name: requisitionList.name,\n                description: requisitionList.description || '',\n              }}\n              onSubmit={handleRenameSubmit}\n              onCancel={() => setShowRenameModal(false)}\n            />\n          }\n          handleModalOnClose={() => setShowRenameModal(false)}\n        />\n      )}\n\n      {/* Delete Confirmation Modal */}\n      {showDeleteModal && (\n        <RequisitionListModal\n          isOpen={showDeleteModal}\n          isLoading={isDeleting}\n          title={translations.deleteListTitle}\n          modalContent={translations.deleteListMessage}\n          confirmBtnCaption={translations.confirmAction}\n          closeBtnCaption={translations.cancelAction}\n          handleModalOnClose={() => setShowDeleteModal(false)}\n          handleModalOnConfirm={handleDeleteConfirm}\n        />\n      )}\n    </>\n  );\n};\n"],"names":["RequisitionListHeader","name","description","backLink","actions","className","props","jsxs","jsx","e","_a","requisitionList","routeRequisitionListGrid","onUpdate","onAlert","showRenameModal","setShowRenameModal","useState","showDeleteModal","setShowDeleteModal","isDeleting","setIsDeleting","translations","useText","handleRename","useCallback","handleRenameSubmit","values","updatedList","updateRequisitionList","_b","handleDeleteList","handleDeleteConfirm","deleteRequisitionList","alertPayload","url","Fragment","RequisitionListHeaderComponent","result","RequisitionListModal","RequisitionListForm"],"mappings":"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"}