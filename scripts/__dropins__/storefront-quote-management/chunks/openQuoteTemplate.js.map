{"version":3,"file":"openQuoteTemplate.js","sources":["/@dropins/storefront-quote-management/src/api/sendQuoteTemplateForReview/graphql/sendQuoteTemplateForReview.ts","/@dropins/storefront-quote-management/src/api/sendQuoteTemplateForReview/sendQuoteTemplateForReview.ts","/@dropins/storefront-quote-management/src/api/acceptQuoteTemplate/graphql/acceptQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/acceptQuoteTemplate/acceptQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/cancelQuoteTemplate/graphql/cancelQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/cancelQuoteTemplate/cancelQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/deleteQuoteTemplate/graphql/deleteQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/deleteQuoteTemplate/deleteQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/openQuoteTemplate/graphql/openQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/openQuoteTemplate/openQuoteTemplate.ts"],"sourcesContent":["/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteTemplateFragment';\n\nexport const SEND_QUOTE_TEMPLATE_FOR_REVIEW_MUTATION = /* GraphQL */ `\n  mutation SEND_QUOTE_TEMPLATE_FOR_REVIEW_MUTATION(\n    $templateId: ID!\n    $comment: String\n    $name: String\n    $referenceDocumentLinks: [NegotiableQuoteTemplateReferenceDocumentLinkInput]\n    $attachments: [NegotiableQuoteCommentAttachmentInput]\n  ) {\n    submitNegotiableQuoteTemplateForReview(input: { template_id: $templateId, name: $name, comment: $comment, reference_document_links: $referenceDocumentLinks, attachments: $attachments }) {\n      ...NegotiableQuoteTemplateFragment\n    }\n  }\n  ${NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { SEND_QUOTE_TEMPLATE_FOR_REVIEW_MUTATION } from './graphql/sendQuoteTemplateForReview';\nimport { transformQuoteTemplate } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface ReferenceDocumentLinkInput {\n  uid?: string;\n  name: string;\n  identifier?: string;\n  url: string;\n}\n\nexport interface SendQuoteTemplateForReviewParams {\n  templateId: string;\n  name?: string;\n  comment?: string;\n  referenceDocumentLinks?: ReferenceDocumentLinkInput[];\n  attachments?: { key: string }[];\n}\n\nexport const sendQuoteTemplateForReview = async (\n  params: SendQuoteTemplateForReviewParams\n) => {\n  if (!params.templateId) {\n    throw new Error('Template ID is required');\n  }\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    // Transform reference document links from camelCase to snake_case for GraphQL\n    const referenceDocumentLinks = params.referenceDocumentLinks?.map((link) => ({\n      link_id: link.uid,\n      document_name: link.name,\n      document_identifier: link.identifier,\n      reference_document_url: link.url,\n    }));\n\n    // Format attachments for GraphQL (separate field, not nested in comment)\n    const attachments = params.attachments?.length \n      ? params.attachments.map(att => ({ key: att.key }))\n      : undefined;\n\n    const results: any = await fetchGraphQl(\n      SEND_QUOTE_TEMPLATE_FOR_REVIEW_MUTATION,\n      {\n        variables: {\n          templateId: params.templateId,\n          name: params.name,\n          comment: params.comment || undefined,\n          referenceDocumentLinks,\n          attachments,\n        },\n      }\n    );\n\n    if (!results?.data?.submitNegotiableQuoteTemplateForReview) {\n      throw new Error('No quote template data received');\n    }\n\n    const transformedData = transformQuoteTemplate(\n      results.data.submitNegotiableQuoteTemplateForReview\n    );\n\n    if (!transformedData) {\n      throw new Error('Failed to transform quote template data');\n    }\n\n    events.emit('quote-management/quote-template-data', {\n      quoteTemplate: transformedData,\n      permissions: state.permissions,\n    });\n\n    return transformedData;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteTemplateFragment';\n\nexport const ACCEPT_QUOTE_TEMPLATE_MUTATION = /* GraphQL */ `\n  mutation ACCEPT_QUOTE_TEMPLATE_MUTATION($templateId: ID!) {\n    acceptNegotiableQuoteTemplate(input: { template_id: $templateId }) {\n      ...NegotiableQuoteTemplateFragment\n    }\n  }\n  \n  ${NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT}\n`;\n\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { ACCEPT_QUOTE_TEMPLATE_MUTATION } from './graphql/acceptQuoteTemplate';\nimport { transformQuoteTemplate } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface AcceptQuoteTemplateParams {\n  templateId: string;\n}\n\nexport const acceptQuoteTemplate = async (\n  params: AcceptQuoteTemplateParams\n) => {\n  if (!params.templateId) {\n    throw new Error('Template ID is required');\n  }\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(ACCEPT_QUOTE_TEMPLATE_MUTATION, {\n      variables: { templateId: params.templateId },\n    });\n\n    if (!results?.data?.acceptNegotiableQuoteTemplate) {\n      throw new Error('No quote template data received');\n    }\n\n    const transformedData = transformQuoteTemplate(\n      results.data.acceptNegotiableQuoteTemplate\n    );\n\n    if (!transformedData) {\n      throw new Error('Failed to transform quote template data');\n    }\n\n    events.emit('quote-management/quote-template-data', {\n      quoteTemplate: transformedData,\n      permissions: state.permissions,\n    });\n\n    return transformedData;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteTemplateFragment';\n\nexport const CANCEL_QUOTE_TEMPLATE_MUTATION = /* GraphQL */ `\n  mutation CANCEL_QUOTE_TEMPLATE_MUTATION(\n    $templateId: ID!\n    $comment: String\n  ) {\n    cancelNegotiableQuoteTemplate(\n      input: {\n        template_id: $templateId\n        cancellation_comment: $comment\n      }\n    ) {\n      ...NegotiableQuoteTemplateFragment\n    }\n  }\n  ${NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { CANCEL_QUOTE_TEMPLATE_MUTATION } from './graphql/cancelQuoteTemplate';\nimport { transformQuoteTemplate } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface CancelQuoteTemplateParams {\n  templateId: string;\n  comment?: string;\n}\n\nexport const cancelQuoteTemplate = async (\n  params: CancelQuoteTemplateParams\n) => {\n  if (!params.templateId) {\n    throw new Error('Template ID is required');\n  }\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(CANCEL_QUOTE_TEMPLATE_MUTATION, {\n      variables: { templateId: params.templateId, comment: params.comment },\n    });\n\n    if (!results?.data?.cancelNegotiableQuoteTemplate) {\n      throw new Error('No quote template data received');\n    }\n\n    const transformedData = transformQuoteTemplate(\n      results.data.cancelNegotiableQuoteTemplate\n    );\n\n    if (!transformedData) {\n      throw new Error('Failed to transform quote template data');\n    }\n\n    events.emit('quote-management/quote-template-data', {\n      quoteTemplate: transformedData,\n      permissions: state.permissions,\n    });\n\n    return transformedData;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nexport const DELETE_QUOTE_TEMPLATE_MUTATION = /* GraphQL */ `\n  mutation DELETE_QUOTE_TEMPLATE_MUTATION($templateId: ID!) {\n    deleteNegotiableQuoteTemplate(input: { template_id: $templateId })\n  }\n`;\n\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { DELETE_QUOTE_TEMPLATE_MUTATION } from './graphql/deleteQuoteTemplate';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface DeleteQuoteTemplateParams {\n  templateId: string;\n}\n\nexport const deleteQuoteTemplate = async (\n  params: DeleteQuoteTemplateParams\n) => {\n  if (!params.templateId) {\n    throw new Error('Template ID is required');\n  }\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(DELETE_QUOTE_TEMPLATE_MUTATION, {\n      variables: { templateId: params.templateId },\n    });\n\n    if (results?.errors && results.errors.length > 0) {\n      const errorMessages = results.errors\n        .map((e: any) => e?.message)\n        .filter(Boolean)\n        .join('; ');\n      throw new Error(errorMessages || 'Failed to delete quote template');\n    }\n\n    const deleted = results?.data?.deleteNegotiableQuoteTemplate;\n\n    if (!deleted) {\n      throw new Error('Failed to delete quote template');\n    }\n\n    events.emit('quote-management/quote-template-deleted', {\n      templateId: params.templateId,\n    });\n\n    return { templateId: params.templateId };\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteTemplateFragment';\n\nexport const OPEN_QUOTE_TEMPLATE_MUTATION = /* GraphQL */ `\n  mutation OPEN_QUOTE_TEMPLATE_MUTATION($templateId: ID!) {\n    openNegotiableQuoteTemplate(input: { template_id: $templateId }) {\n      ...NegotiableQuoteTemplateFragment\n    }\n  }\n\n  ${NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { OPEN_QUOTE_TEMPLATE_MUTATION } from './graphql/openQuoteTemplate';\nimport { transformQuoteTemplate } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface OpenQuoteTemplateParams {\n  templateId: string;\n}\n\nexport const openQuoteTemplate = async (params: OpenQuoteTemplateParams) => {\n  if (!params.templateId) {\n    throw new Error('Template ID is required');\n  }\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(OPEN_QUOTE_TEMPLATE_MUTATION, {\n      variables: { templateId: params.templateId },\n    });\n\n    if (!results?.data?.openNegotiableQuoteTemplate) {\n      throw new Error('No quote template data received');\n    }\n\n    const transformedData = transformQuoteTemplate(\n      results.data.openNegotiableQuoteTemplate\n    );\n\n    if (!transformedData) {\n      throw new Error('Failed to transform quote template data');\n    }\n\n    events.emit('quote-management/quote-template-data', {\n      quoteTemplate: transformedData,\n      permissions: state.permissions,\n    });\n\n    return transformedData;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n"],"names":["SEND_QUOTE_TEMPLATE_FOR_REVIEW_MUTATION","NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT","sendQuoteTemplateForReview","params","state","referenceDocumentLinks","_a","link","attachments","_b","att","results","fetchGraphQl","_c","transformedData","transformQuoteTemplate","events","error","ACCEPT_QUOTE_TEMPLATE_MUTATION","acceptQuoteTemplate","CANCEL_QUOTE_TEMPLATE_MUTATION","cancelQuoteTemplate","DELETE_QUOTE_TEMPLATE_MUTATION","deleteQuoteTemplate","errorMessages","e","OPEN_QUOTE_TEMPLATE_MUTATION","openQuoteTemplate"],"mappings":"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"}