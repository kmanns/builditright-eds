{"version":3,"file":"requestNegotiableQuote.js","sources":["/@dropins/storefront-quote-management/src/api/requestNegotiableQuote/graphql/RequestNegotiableQuoteMutation.ts","/@dropins/storefront-quote-management/src/api/requestNegotiableQuote/requestNegotiableQuote.ts"],"sourcesContent":["/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteFragment';\n\nexport const REQUEST_NEGOTIABLE_QUOTE_MUTATION = `\n  mutation REQUEST_NEGOTIABLE_QUOTE_MUTATION(\n    $cartId: ID!\n    $quoteName: String!\n    $comment: NegotiableQuoteCommentInput!\n    $isDraft: Boolean\n  ) {\n    requestNegotiableQuote(\n      input: {\n        cart_id: $cartId\n        quote_name: $quoteName\n        comment: $comment\n        is_draft: $isDraft\n      }\n    ) {\n      quote {\n        ...NegotiableQuoteFragment\n      }\n    }\n  }\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { events } from '@adobe-commerce/event-bus';\nimport { REQUEST_NEGOTIABLE_QUOTE_MUTATION } from './graphql/RequestNegotiableQuoteMutation';\nimport { NegotiableQuoteModel } from '@/quote-management/data/models/negotiable-quote-model';\nimport { transformQuote } from '@/quote-management/data/transforms';\n\nexport interface RequestNegotiableQuoteInput {\n  cartId: string;\n  quoteName: string;\n  comment: string;\n  isDraft?: boolean;\n  attachments?: { key: string }[];\n}\n\nexport const requestNegotiableQuote = async (\n  input: RequestNegotiableQuoteInput\n): Promise<NegotiableQuoteModel | null> => {\n  const { cartId, quoteName, comment, attachments, isDraft } = input;\n\n  if (!cartId) {\n    throw new Error('Cart ID is required');\n  }\n\n  if (!quoteName) {\n    throw new Error('Quote name is required');\n  }\n\n  if (!comment) {\n    throw new Error('Comment is required');\n  }\n\n  return fetchGraphQl(REQUEST_NEGOTIABLE_QUOTE_MUTATION, {\n    variables: {\n      cartId,\n      quoteName,\n      comment: attachments?.length ? { comment, attachments } : { comment },\n      isDraft,\n    },\n  }).then((response) => {\n    const { errors } = response;\n\n    if (errors) {\n      // Provide more detailed error information\n      const errorMessages = errors.map((error) => error.message).join('; ');\n      throw new Error(`Failed to request negotiable quote: ${errorMessages}`);\n    }\n\n    // Transform the quote data\n    const quoteData = transformQuote(response.data?.requestNegotiableQuote?.quote);\n\n    if (!quoteData) {\n      throw new Error(\n        'Failed to transform quote data: Invalid response structure'\n      );\n    }\n\n    // Emit event with transformed  quote data on success\n    events.emit('quote-management/negotiable-quote-requested', {\n      quote: quoteData,\n      input: { cartId, quoteName, comment, attachments, isDraft },\n    });\n\n    return quoteData;\n  });\n};\n"],"names":["REQUEST_NEGOTIABLE_QUOTE_MUTATION","NEGOTIABLE_QUOTE_FRAGMENT","requestNegotiableQuote","input","cartId","quoteName","comment","attachments","isDraft","fetchGraphQl","response","errors","errorMessages","error","quoteData","transformQuote","_b","_a","events"],"mappings":"oKAWO,MAAMA,EAAoC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAoB7CC,CAAyB;AAAA,ECRhBC,EAAyB,MACpCC,GACyC,CACzC,KAAM,CAAE,OAAAC,EAAQ,UAAAC,EAAW,QAAAC,EAAS,YAAAC,EAAa,QAAAC,GAAYL,EAE7D,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,qBAAqB,EAGvC,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,wBAAwB,EAG1C,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,qBAAqB,EAGvC,OAAOG,EAAaT,EAAmC,CACrD,UAAW,CACT,OAAAI,EACA,UAAAC,EACA,QAASE,GAAA,MAAAA,EAAa,OAAS,CAAE,QAAAD,EAAS,YAAAC,CAAA,EAAgB,CAAE,QAAAD,CAAA,EAC5D,QAAAE,CAAA,CACF,CACD,EAAE,KAAME,GAAa,SACpB,KAAM,CAAE,OAAAC,GAAWD,EAEnB,GAAIC,EAAQ,CAEV,MAAMC,EAAgBD,EAAO,IAAKE,GAAUA,EAAM,OAAO,EAAE,KAAK,IAAI,EACpE,MAAM,IAAI,MAAM,uCAAuCD,CAAa,EAAE,CACxE,CAGA,MAAME,EAAYC,GAAeC,GAAAC,EAAAP,EAAS,OAAT,YAAAO,EAAe,yBAAf,YAAAD,EAAuC,KAAK,EAE7E,GAAI,CAACF,EACH,MAAM,IAAI,MACR,4DAAA,EAKJ,OAAAI,EAAO,KAAK,8CAA+C,CACzD,MAAOJ,EACP,MAAO,CAAE,OAAAV,EAAQ,UAAAC,EAAW,QAAAC,EAAS,YAAAC,EAAa,QAAAC,CAAA,CAAQ,CAC3D,EAEMM,CACT,CAAC,CACH"}