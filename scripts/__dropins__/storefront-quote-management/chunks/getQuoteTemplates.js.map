{"version":3,"file":"getQuoteTemplates.js","sources":["/@dropins/storefront-quote-management/src/api/getQuoteTemplates/graphql/getQuoteTemplates.ts","/@dropins/storefront-quote-management/src/api/getQuoteTemplates/getQuoteTemplates.ts"],"sourcesContent":["/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nexport const QUOTE_TEMPLATES_QUERY = /* GraphQL */ `\n  query QUOTE_TEMPLATES_QUERY(\n    $filter: NegotiableQuoteTemplateFilterInput\n    $pageSize: Int\n    $currentPage: Int\n    $sort: NegotiableQuoteTemplateSortInput\n  ) {\n    negotiableQuoteTemplates(\n      filter: $filter\n      pageSize: $pageSize\n      currentPage: $currentPage\n      sort: $sort\n    ) {\n      items {\n        uid\n        template_id\n        name\n        created_at\n        updated_at\n        last_ordered_at\n        status\n        state\n        min_negotiated_grand_total\n        last_shared_at\n        expiration_date\n        orders_placed\n        prices {\n          grand_total {\n            currency\n            value\n          }\n        }\n      }\n      page_info {\n        current_page\n        page_size\n        total_pages\n      }\n      total_count\n      sort_fields {\n        default\n        options {\n          label\n          value\n        }\n      }\n    }\n  }\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { QUOTE_TEMPLATES_QUERY } from './graphql/getQuoteTemplates';\nimport { transformQuoteTemplatesList } from '@/quote-management/data/transforms';\nimport { NegotiableQuoteTemplatesListModel } from '@/quote-management/data/models/negotiable-quote-template-model';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport enum QuoteTemplateFilterStatus {\n  ACTIVE = 'ACTIVE',\n  IN_REVIEW = 'IN_REVIEW',\n  INACTIVE = 'INACTIVE',\n}\n\nexport interface QuoteTemplateFilterInput {\n  status?: QuoteTemplateFilterStatus[];\n  name?: {\n    match?: string;\n  };\n}\n\nexport enum QuoteTemplateSortField {\n  NAME = 'NAME',\n  CREATED_AT = 'CREATED_AT',\n  UPDATED_AT = 'UPDATED_AT',\n}\n\nexport enum SortDirection {\n  ASC = 'ASC',\n  DESC = 'DESC',\n}\n\nexport interface QuoteTemplateSortInput {\n  sortField: QuoteTemplateSortField;\n  sortDirection: SortDirection;\n}\n\nexport interface GetQuoteTemplatesParams {\n  filter?: QuoteTemplateFilterInput;\n  pageSize?: number;\n  currentPage?: number;\n  sort?: QuoteTemplateSortInput;\n}\n\nexport const getQuoteTemplates = async (\n  params: GetQuoteTemplatesParams = {}\n): Promise<NegotiableQuoteTemplatesListModel> => {\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(QUOTE_TEMPLATES_QUERY, {\n      variables: {\n        filter: params.filter || null,\n        pageSize: params.pageSize || 20,\n        currentPage: params.currentPage || 1,\n        sort: params.sort || null,\n      },\n    });\n\n    if (!results?.data?.negotiableQuoteTemplates) {\n      throw new Error('No quote templates data received');\n    }\n\n    const transformedData = transformQuoteTemplatesList(results.data.negotiableQuoteTemplates);\n\n    if (!transformedData) {\n      throw new Error('Failed to transform quote templates data');\n    }\n\n    events.emit('quote-management/quote-templates-data', {\n      quoteTemplates: transformedData,\n      permissions: state.permissions,\n    });\n\n    return transformedData;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};"],"names":["QUOTE_TEMPLATES_QUERY","QuoteTemplateFilterStatus","QuoteTemplateSortField","SortDirection","getQuoteTemplates","params","state","results","fetchGraphQl","_a","transformedData","transformQuoteTemplatesList","events","error"],"mappings":"+KASO,MAAMA,EAAsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECO5C,IAAKC,GAAAA,IACVA,EAAA,OAAS,SACTA,EAAA,UAAY,YACZA,EAAA,SAAW,WAHDA,IAAAA,GAAA,CAAA,CAAA,EAaAC,GAAAA,IACVA,EAAA,KAAO,OACPA,EAAA,WAAa,aACbA,EAAA,WAAa,aAHHA,IAAAA,GAAA,CAAA,CAAA,EAMAC,GAAAA,IACVA,EAAA,IAAM,MACNA,EAAA,KAAO,OAFGA,IAAAA,GAAA,CAAA,CAAA,EAiBL,MAAMC,EAAoB,MAC/BC,EAAkC,KACa,OAC/C,GAAI,CAACC,EAAM,cACT,MAAM,IAAI,MAAM,cAAc,EAGhC,GAAI,CACF,MAAMC,EAAe,MAAMC,EAAaR,EAAuB,CAC7D,UAAW,CACT,OAAQK,EAAO,QAAU,KACzB,SAAUA,EAAO,UAAY,GAC7B,YAAaA,EAAO,aAAe,EACnC,KAAMA,EAAO,MAAQ,IAAA,CACvB,CACD,EAED,GAAI,GAACI,EAAAF,GAAA,YAAAA,EAAS,OAAT,MAAAE,EAAe,0BAClB,MAAM,IAAI,MAAM,kCAAkC,EAGpD,MAAMC,EAAkBC,EAA4BJ,EAAQ,KAAK,wBAAwB,EAEzF,GAAI,CAACG,EACH,MAAM,IAAI,MAAM,0CAA0C,EAG5D,OAAAE,EAAO,KAAK,wCAAyC,CACnD,eAAgBF,EAChB,YAAaJ,EAAM,WAAA,CACpB,EAEMI,CACT,OAASG,EAAO,CACd,OAAO,QAAQ,OAAOA,CAAK,CAC7B,CACF"}