{"version":3,"file":"duplicateNegotiableQuote.js","sources":["/@dropins/storefront-quote-management/src/api/getQuoteData/graphql/QuoteDataQuery.ts","/@dropins/storefront-quote-management/src/api/getQuoteData/getQuoteData.ts","/@dropins/storefront-quote-management/src/api/deleteQuote/graphql/DeleteQuoteMutation.ts","/@dropins/storefront-quote-management/src/api/deleteQuote/deleteQuote.ts","/@dropins/storefront-quote-management/src/api/sendForReview/graphql/SendNegotiableQuoteForReviewMutation.ts","/@dropins/storefront-quote-management/src/api/sendForReview/sendForReview.ts","/@dropins/storefront-quote-management/src/api/closeNegotiableQuote/graphql/CloseNegotiableQuoteMutation.ts","/@dropins/storefront-quote-management/src/api/closeNegotiableQuote/closeNegotiableQuote.ts","/@dropins/storefront-quote-management/src/api/createQuoteTemplate/graphql/createQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/createQuoteTemplate/createQuoteTemplate.ts","/@dropins/storefront-quote-management/src/api/renameNegotiableQuote/graphql/RenameNegotiableQuoteMutation.ts","/@dropins/storefront-quote-management/src/api/renameNegotiableQuote/renameNegotiableQuote.ts","/@dropins/storefront-quote-management/src/api/duplicateNegotiableQuote/graphql/duplicateNegotiableQuoteMutation.ts","/@dropins/storefront-quote-management/src/api/duplicateNegotiableQuote/duplicateNegotiableQuote.ts"],"sourcesContent":["import { NEGOTIABLE_QUOTE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteFragment';\n\nexport const QUOTE_DATA_QUERY = `\n    query QUOTE_DATA_QUERY(\n        $quoteId: ID!\n    ) {\n        negotiableQuote(\n            uid: $quoteId\n        ) {\n            ...NegotiableQuoteFragment\n        }\n    }\n\n    ${NEGOTIABLE_QUOTE_FRAGMENT}\n`","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api/';\nimport { QUOTE_DATA_QUERY } from './graphql/QuoteDataQuery';\nimport { transformQuote } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport const getQuoteData = async (quoteId: string) => { \n    if (!state.authenticated) {\n        return Promise.reject(new Error('Unauthorized'));\n    }\n\n    if (!state.permissions.editQuote) {\n        return Promise.reject(new Error('Unauthorized'));\n    }\n\n    try {\n        const results: any = await fetchGraphQl(QUOTE_DATA_QUERY, {\n            variables: {\n                quoteId\n            }\n        });\n\n        const transformedQuote = transformQuote(results?.data?.negotiableQuote);\n\n        if (!transformedQuote) {\n            throw new Error('Failed to transform quote data');\n        }\n\n        events.emit('quote-management/quote-data', {\n            quote: transformedQuote,\n            permissions: state.permissions,\n        });\n        \n        return transformedQuote;\n    } catch (error) {\n        return Promise.reject(error);\n    }\n}\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const DELETE_QUOTE_MUTATION = `\n  mutation DELETE_QUOTE_MUTATION($quoteUids: [ID!]!) {\n    deleteNegotiableQuotes(\n      input: {\n        quote_uids: $quoteUids\n      }\n    ) {\n      result_status\n      operation_results {\n        __typename\n        ... on NegotiableQuoteUidOperationSuccess {\n          quote_uid\n        }\n        ... on DeleteNegotiableQuoteOperationFailure {\n          quote_uid\n          errors {\n            __typename\n            ... on ErrorInterface {\n              message\n            }\n            ... on NoSuchEntityUidError {\n              uid\n              message\n            }\n            ... on NegotiableQuoteInvalidStateError {\n              message\n            }\n          }\n        }\n      }\n    }\n  }\n`;\n\n\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n \nimport { fetchGraphQl } from '@/quote-management/api';\nimport { state } from '@/quote-management/lib/state';\nimport { DELETE_QUOTE_MUTATION } from '@/quote-management/api/deleteQuote/graphql/DeleteQuoteMutation';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport interface DeleteQuoteSuccessResult {\n  __typename: 'NegotiableQuoteUidOperationSuccess';\n  quoteUid: string;\n}\n\nexport interface DeleteQuoteFailureError {\n  __typename: string;\n  message?: string;\n  uid?: string;\n}\n\nexport interface DeleteQuoteFailureResult {\n  __typename: 'DeleteNegotiableQuoteOperationFailure';\n  quoteUid: string;\n  errors: DeleteQuoteFailureError[];\n}\n\nexport interface DeleteQuoteOutput {\n  resultStatus: string;\n  operationResults: Array<DeleteQuoteSuccessResult | DeleteQuoteFailureResult>;\n}\n\nexport const deleteQuote = async ( quoteUids: string[] | string ): Promise<DeleteQuoteOutput> => {\n  if (!state.authenticated) {\n    return Promise.reject(new Error('Unauthorized'));\n  }\n\n  const quoteUidsArray = Array.isArray(quoteUids) ? quoteUids : [quoteUids];\n\n  try {\n    const response: any = await fetchGraphQl(DELETE_QUOTE_MUTATION, {\n      variables: {\n        quoteUids: quoteUidsArray,\n      },\n    });\n\n    const { errors } = response || {};\n    if (errors && errors.length) {\n      const errorMessages = errors.map((e: any) => e?.message).filter(Boolean).join('; ');\n      throw new Error(errorMessages || 'Failed to delete negotiable quotes');\n    }\n\n    const raw = response?.data?.deleteNegotiableQuotes;\n    if (!raw) {\n      throw new Error('No delete result returned');\n    }\n\n    const transformed: DeleteQuoteOutput = {\n      resultStatus: raw.result_status,\n      operationResults: (raw.operation_results || []).map((result: any) => {\n        const typename = result?.__typename;\n        if (typename === 'NegotiableQuoteUidOperationSuccess') {\n          const success: DeleteQuoteSuccessResult = {\n            __typename: 'NegotiableQuoteUidOperationSuccess',\n            quoteUid: result?.quote_uid,\n          };\n          return success;\n        }\n        const failure: DeleteQuoteFailureResult = {\n          __typename: 'DeleteNegotiableQuoteOperationFailure',\n          quoteUid: result?.quote_uid,\n          errors: (result?.errors || []).map((err: any) => ({\n            __typename: err?.__typename,\n            message: err?.message,\n            uid: err?.uid,\n          })),\n        };\n        return failure;\n      }),\n    };\n\n    // Emit event with successfully deleted quote UIDs\n    const deletedUids = transformed.operationResults\n      .filter((res) => res.__typename === 'NegotiableQuoteUidOperationSuccess')\n      .map((res) => (res as DeleteQuoteSuccessResult).quoteUid);\n\n    if (deletedUids.length > 0) {\n      events.emit('quote-management/negotiable-quote-deleted', {\n        deletedQuoteUids: deletedUids,\n        resultStatus: transformed.resultStatus,\n      });\n    }\n\n    return transformed;\n  } catch (error) {\n    // Emit error event for integration layer\n    events.emit('quote-management/negotiable-quote-delete-error', {\n      error: error instanceof Error ? error : new Error(String(error)),\n      attemptedQuoteUids: quoteUidsArray,\n    });\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteFragment';\n\nexport const SEND_NEGOTIABLE_QUOTE_FOR_REVIEW_MUTATION = `\n  mutation SEND_NEGOTIABLE_QUOTE_FOR_REVIEW_MUTATION(\n    $quoteUid: ID!\n    $comment: NegotiableQuoteCommentInput\n  ) {\n    sendNegotiableQuoteForReview(\n      input: {\n        quote_uid: $quoteUid\n        comment: $comment\n      }\n    ) {\n      quote {\n        ...NegotiableQuoteFragment\n      }\n    }\n  }\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { events } from '@adobe-commerce/event-bus';\nimport { SEND_NEGOTIABLE_QUOTE_FOR_REVIEW_MUTATION } from './graphql/SendNegotiableQuoteForReviewMutation';\nimport { NegotiableQuoteModel } from '@/quote-management/data/models/negotiable-quote-model';\nimport { transformQuote } from '@/quote-management/data/transforms';\n\nexport interface SendForReviewInput {\n  quoteUid: string;\n  comment?: string;\n  attachments?: { key: string }[];\n}\n\nexport const sendForReview = async (\n  input: SendForReviewInput\n): Promise<NegotiableQuoteModel | null> => {\n  const { quoteUid, comment, attachments } = input;\n\n  if (!quoteUid) {\n    throw new Error('Quote UID is required');\n  }\n\n  // Build the comment object with attachments if provided\n  const commentInput = attachments?.length \n    ? { comment: comment || '', attachments } \n    : comment \n    ? { comment } \n    : null;\n\n  return fetchGraphQl(SEND_NEGOTIABLE_QUOTE_FOR_REVIEW_MUTATION, {\n    variables: {\n      quoteUid,\n      comment: commentInput,\n    },\n  }).then((response) => {\n    const { errors } = response;\n\n    if (errors) {\n      // Provide more detailed error information\n      const errorMessages = errors.map((error) => error.message).join('; ');\n      throw new Error(`Failed to send quote for review: ${errorMessages}`);\n    }\n\n    // Transform the quote data\n    const quoteData = transformQuote(\n      response.data?.sendNegotiableQuoteForReview?.quote\n    );\n\n    if (!quoteData) {\n      throw new Error(\n        'Failed to transform quote data: Invalid response structure'\n      );\n    }\n\n    // Emit event with transformed quote data on success\n    events.emit('quote-management/quote-sent-for-review', {\n      quote: quoteData,\n      input: { quoteUid, comment, attachments },\n    });\n\n    return quoteData;\n  });\n};\n\n","export const CLOSE_NEGOTIABLE_QUOTE_MUTATION = `\n  mutation CLOSE_NEGOTIABLE_QUOTE_MUTATION(\n    $quoteUids: [ID!]!\n  ) {\n    closeNegotiableQuotes(input: { quote_uids: $quoteUids }) {\n      result_status\n      operation_results {\n        ... on NegotiableQuoteUidOperationSuccess {\n          __typename\n          quote_uid\n        }\n        ... on CloseNegotiableQuoteOperationFailure {\n          __typename\n          quote_uid\n          errors {\n            __typename\n            ... on ErrorInterface {\n              message\n            }\n            ... on NoSuchEntityUidError {\n              uid\n            }\n            ... on NegotiableQuoteInvalidStateError {\n              message\n            }\n          }\n        }\n      }\n    }\n  }\n`;","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { state } from '@/quote-management/lib/state';\nimport { events } from '@adobe-commerce/event-bus';\nimport { CLOSE_NEGOTIABLE_QUOTE_MUTATION } from './graphql/CloseNegotiableQuoteMutation';\n\nexport interface CloseNegotiableQuoteInput {\n  quoteUids: string[];\n}\n\nexport interface CloseNegotiableQuoteSuccessResult {\n  __typename: 'NegotiableQuoteUidOperationSuccess';\n  quoteUid: string;\n}\n\nexport interface CloseNegotiableQuoteFailureError {\n  __typename: string;\n  message?: string;\n  uid?: string;\n}\n\nexport interface CloseNegotiableQuoteFailureResult {\n  __typename: 'CloseNegotiableQuoteOperationFailure';\n  quoteUid: string;\n  errors: CloseNegotiableQuoteFailureError[];\n}\n\nexport interface CloseNegotiableQuoteResult {\n  resultStatus: string;\n  operationResults: Array<CloseNegotiableQuoteSuccessResult | CloseNegotiableQuoteFailureResult>;\n}\n\nexport const closeNegotiableQuote = async (input: CloseNegotiableQuoteInput): Promise<CloseNegotiableQuoteResult> => { \n  if (!state.authenticated) {\n    return Promise.reject(new Error('Unauthorized'));\n  }\n\n  const { quoteUids } = input;\n\n  if (!quoteUids || quoteUids.length === 0) {\n    throw new Error('Quote UIDs are required');\n  }\n\n  try {\n    const response: any = await fetchGraphQl(CLOSE_NEGOTIABLE_QUOTE_MUTATION, {\n      variables: {\n        quoteUids,\n      },\n    });\n\n    const { errors } = response || {};\n    if (errors && errors.length) {\n      const errorMessages = errors\n        .map((e: any) => e?.message)\n        .filter(Boolean)\n        .join('; ');\n      throw new Error(errorMessages || 'Failed to close negotiable quotes');\n    }\n\n    const raw = response?.data?.closeNegotiableQuotes;\n    if (!raw) {\n      throw new Error('No close result returned');\n    }\n\n    const transformed: CloseNegotiableQuoteResult = {\n      resultStatus: raw.result_status,\n      operationResults: (raw.operation_results || []).map((result: any) => {\n        const typename = result?.__typename;\n        if (typename === 'NegotiableQuoteUidOperationSuccess') {\n          const success: CloseNegotiableQuoteSuccessResult = {\n            __typename: 'NegotiableQuoteUidOperationSuccess',\n            quoteUid: result?.quote_uid,\n          };\n          return success;\n        }\n        const failure: CloseNegotiableQuoteFailureResult = {\n          __typename: 'CloseNegotiableQuoteOperationFailure',\n          quoteUid: result?.quote_uid,\n          errors: (result?.errors || []).map((err: any) => ({\n            __typename: err?.__typename,\n            message: err?.message,\n            uid: err?.uid,\n          })),\n        };\n        return failure;\n      }),\n    };\n\n    // Check for operation failures\n    const failures = transformed.operationResults\n      .filter(\n        (res) => res.__typename === 'CloseNegotiableQuoteOperationFailure'\n      )\n      .map((res) => res as CloseNegotiableQuoteFailureResult);\n\n    if (failures.length > 0) {\n      // Create error message from failures\n      const failureMessages = failures\n        .map((failure) => {\n          if (failure.errors && failure.errors.length > 0) {\n            return failure.errors\n              .map(\n                (err) =>\n                  err.message || `Failed to close quote ${failure.quoteUid}`\n              )\n              .join(', ');\n          }\n          return `Failed to close quote ${failure.quoteUid}`;\n        })\n        .join('; ');\n\n      throw new Error(failureMessages);\n    }\n\n    // Emit success event with closed quote UIDs\n    const closedUids = transformed.operationResults\n      .filter((res) => res.__typename === 'NegotiableQuoteUidOperationSuccess')\n      .map((res) => (res as CloseNegotiableQuoteSuccessResult).quoteUid);\n\n    if (closedUids.length > 0) {\n      events.emit('quote-management/negotiable-quote-closed', {\n        closedQuoteUids: closedUids,\n        resultStatus: transformed.resultStatus,\n      });\n    }\n\n    return transformed;\n  } catch (error) {\n    // Emit error event for integration layer\n    events.emit('quote-management/negotiable-quote-close-error', {\n      error: error instanceof Error ? error : new Error(String(error)),\n      attemptedQuoteUids: quoteUids,\n    });\n    return Promise.reject(error);\n  }\n}\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT } from \"../../graphql/NegotiableQuoteTemplateFragment\";\n\nexport const CREATE_QUOTE_TEMPLATE_MUTATION = /* GraphQL */ `\n  mutation CREATE_QUOTE_TEMPLATE_MUTATION($cartId: ID!) {\n    requestNegotiableQuoteTemplateFromQuote(input: { cart_id: $cartId }) {\n      ...NegotiableQuoteTemplateFragment\n    }\n  }\n\n  ${NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { events } from '@adobe-commerce/event-bus';\nimport { fetchGraphQl } from '@/quote-management/api/';\nimport { CREATE_QUOTE_TEMPLATE_MUTATION } from './graphql/createQuoteTemplate';\nimport { state } from '@/quote-management/lib/state';\nimport { transformQuoteTemplate } from '@/quote-management/data/transforms';\nimport { NegotiableQuoteTemplateModel } from '@/quote-management/data/models/negotiable-quote-template-model';\n\nexport const createQuoteTemplate = async (\n  quoteId: string\n): Promise<NegotiableQuoteTemplateModel | null> => {\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  if (!quoteId) {\n    throw new Error('Cart ID is required');\n  }\n\n  try {\n    const results: any = await fetchGraphQl(CREATE_QUOTE_TEMPLATE_MUTATION, {\n      variables: {\n        cartId: quoteId,\n      },\n    });\n\n    if (!results?.data?.requestNegotiableQuoteTemplateFromQuote) {\n      throw new Error('Failed to create quote template');\n    }\n\n    const transformedQuoteTemplate = transformQuoteTemplate(\n      results.data.requestNegotiableQuoteTemplateFromQuote\n    );\n\n    if (!transformedQuoteTemplate) {\n      throw new Error('Failed to transform quote template data');\n    }\n\n    events.emit('quote-management/quote-template-data', {\n      quoteTemplate: transformedQuoteTemplate,\n      permissions: state.permissions,\n    });\n\n    return transformedQuoteTemplate;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteFragment';\n\nexport const RENAME_NEGOTIABLE_QUOTE_MUTATION = `\n  mutation renameNegotiableQuote($input: RenameNegotiableQuoteInput!) {\n    renameNegotiableQuote(input: $input) {\n      quote {\n        ...NegotiableQuoteFragment\n      }\n    }\n  }\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { events } from '@adobe-commerce/event-bus';\nimport { RENAME_NEGOTIABLE_QUOTE_MUTATION } from './graphql/RenameNegotiableQuoteMutation';\nimport { NegotiableQuoteModel } from '@/quote-management/data/models/negotiable-quote-model';\nimport { transformQuote } from '@/quote-management/data/transforms';\n\nexport interface RenameNegotiableQuoteInput {\n  quoteUid: string;\n  quoteName: string;\n  quoteComment?: string;\n}\n\nexport const renameNegotiableQuote = async (\n  input: RenameNegotiableQuoteInput\n): Promise<NegotiableQuoteModel | null> => {\n  const { quoteUid, quoteName, quoteComment } = input;\n\n  if (!quoteUid) {\n    throw new Error('Quote UID is required');\n  }\n\n  if (!quoteName) {\n    throw new Error('Quote name is required');\n  }\n\n  // Backend requires quote_comment to be present (even if empty string)\n  const mutationInput = {\n    quote_uid: quoteUid,\n    quote_name: quoteName,\n    quote_comment: quoteComment || '',  // Always include, use empty string if not provided\n  };\n\n  return fetchGraphQl(RENAME_NEGOTIABLE_QUOTE_MUTATION, {\n    variables: {\n      input: mutationInput,\n    },\n  }).then((response) => {\n    const { errors } = response;\n\n    if (errors) {\n      // Provide more detailed error information\n      const errorMessages = errors.map((error) => error.message).join('; ');\n      throw new Error(`Failed to rename quote: ${errorMessages}`);\n    }\n\n    // Transform the quote data\n    const quoteData = transformQuote(\n      response.data?.renameNegotiableQuote?.quote\n    );\n\n    if (!quoteData) {\n      throw new Error(\n        'Failed to transform quote data: Invalid response structure'\n      );\n    }\n\n    // Emit event with transformed quote data on success\n    events.emit('quote-management/quote-renamed', {\n      quote: quoteData,\n      input: { quoteUid, quoteName, quoteComment },\n    });\n\n    return quoteData;\n  });\n};\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this\n * file in accordance with the terms of the Adobe license agreement\n * accompanying it.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/quote-management/api/graphql/NegotiableQuoteFragment';\n\nexport const DUPLICATE_NEGOTIABLE_QUOTE_MUTATION = `\n  mutation DUPLICATE_NEGOTIABLE_QUOTE_MUTATION($quoteUid: ID!, $duplicatedQuoteUid: ID!) {\n    duplicateNegotiableQuote(input: { quote_uid: $quoteUid, duplicated_quote_uid: $duplicatedQuoteUid }) {\n      quote {\n        ...NegotiableQuoteFragment\n      }\n    }\n  }\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n","/********************************************************************\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { fetchGraphQl } from '@/quote-management/api';\nimport { events } from '@adobe-commerce/event-bus';\nimport { DUPLICATE_NEGOTIABLE_QUOTE_MUTATION } from './graphql/duplicateNegotiableQuoteMutation';\nimport { NegotiableQuoteModel } from '@/quote-management/data/models/negotiable-quote-model';\nimport { transformQuote } from '@/quote-management/data/transforms';\nimport { state } from '@/quote-management/lib/state';\n\nexport interface DuplicateQuoteInput {\n  quoteUid: string;\n  duplicatedQuoteUid: string;\n  hasOutOfStockItems?: boolean;\n}\n\nexport const duplicateQuote = async (\n  input: DuplicateQuoteInput\n): Promise<NegotiableQuoteModel | null> => {\n\n  if (!state.authenticated) {\n    throw new Error('Unauthorized');\n  }\n\n  const { quoteUid, duplicatedQuoteUid, hasOutOfStockItems } = input;\n\n  if (!quoteUid || !quoteUid.trim()) {\n    throw new Error('Quote UID is required');\n  }\n\n  if (!duplicatedQuoteUid || !duplicatedQuoteUid.trim()) {\n    throw new Error('Duplicated Quote UID is required');\n  }\n\n  return fetchGraphQl(DUPLICATE_NEGOTIABLE_QUOTE_MUTATION, {\n    variables: { quoteUid, duplicatedQuoteUid },\n  }).then((response) => {\n    const { errors } = response;\n\n    if (errors) {\n      const errorMessages = errors.map((error) => error.message).join('; ');\n      throw new Error(`Failed to duplicate quote: ${errorMessages}`);\n    }\n\n    const quoteData = transformQuote(\n      response.data?.duplicateNegotiableQuote?.quote\n    );\n\n    if (!quoteData) {\n      throw new Error(\n        'Failed to transform quote data: Invalid response structure'\n      );\n    }\n\n    events.emit('quote-management/quote-duplicated', {\n      quote: quoteData,\n      input: { quoteUid, duplicatedQuoteUid },\n      hasOutOfStockItems,\n    });\n\n    return quoteData;\n  });\n};\n"],"names":["QUOTE_DATA_QUERY","NEGOTIABLE_QUOTE_FRAGMENT","getQuoteData","quoteId","state","results","fetchGraphQl","transformedQuote","transformQuote","_a","events","error","DELETE_QUOTE_MUTATION","deleteQuote","quoteUids","quoteUidsArray","response","errors","errorMessages","e","raw","transformed","result","err","deletedUids","res","SEND_NEGOTIABLE_QUOTE_FOR_REVIEW_MUTATION","sendForReview","input","quoteUid","comment","attachments","commentInput","quoteData","_b","CLOSE_NEGOTIABLE_QUOTE_MUTATION","closeNegotiableQuote","failures","failureMessages","failure","closedUids","CREATE_QUOTE_TEMPLATE_MUTATION","NEGOTIABLE_QUOTE_TEMPLATE_FRAGMENT","createQuoteTemplate","transformedQuoteTemplate","transformQuoteTemplate","RENAME_NEGOTIABLE_QUOTE_MUTATION","renameNegotiableQuote","quoteName","quoteComment","DUPLICATE_NEGOTIABLE_QUOTE_MUTATION","duplicateQuote","duplicatedQuoteUid","hasOutOfStockItems"],"mappings":"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"}