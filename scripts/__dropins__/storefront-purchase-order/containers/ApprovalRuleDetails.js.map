{"version":3,"file":"ApprovalRuleDetails.js","sources":["/@dropins/storefront-purchase-order/src/hooks/useApprovalRuleDetails.tsx","/@dropins/storefront-purchase-order/src/components/ApprovalRuleDetailsContent/ApprovalRuleDetailsContent.tsx","/@dropins/storefront-purchase-order/src/containers/ApprovalRuleDetails/ApprovalRuleDetails.tsx"],"sourcesContent":["/*******************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useEffect, useState, useMemo } from 'preact/hooks';\nimport { getPurchaseOrderApprovalRule } from '@/b2b-purchase-order/api';\nimport { UseApprovalRuleDetailsProps } from '@/b2b-purchase-order/types/hooks';\nimport { PriceRange } from '@adobe-commerce/elsie/components';\nimport { PurchaseOrderApprovalRuleModel } from '@/b2b-purchase-order/data/models';\nimport { Text } from '@adobe-commerce/elsie/i18n';\n\nexport const useApprovalRuleDetails = ({\n  approvalRuleID,\n  routeApprovalRulesList,\n}: UseApprovalRuleDetailsProps) => {\n  const [loading, setLoading] = useState(true);\n  const [approvalRule, setApprovalRule] =\n    useState<PurchaseOrderApprovalRuleModel | null>(null);\n\n  useEffect(() => {\n    if (!approvalRuleID) return;\n\n    setLoading(true);\n\n    getPurchaseOrderApprovalRule(approvalRuleID)\n      .then((data) => {\n        if (!data.uid) return;\n\n        setApprovalRule(data);\n      })\n      .catch(() => {\n        setApprovalRule(null);\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [approvalRuleID]);\n\n  const formValues = useMemo(() => {\n    if (!approvalRule || loading) return [];\n\n    const {\n      name,\n      status,\n      description,\n      appliesToRoles,\n      approverRoles,\n      condition,\n    } = approvalRule;\n\n    return [\n      {\n        label: <Text id=\"PurchaseOrders.approvalRuleDetails.fields.ruleName\" />,\n        value: name,\n      },\n      {\n        label: <Text id=\"PurchaseOrders.approvalRuleDetails.fields.status\" />,\n        value: (\n          <Text\n            id={`PurchaseOrders.approvalRuleDetails.fields.statusView.${status.toLocaleLowerCase()}`}\n          />\n        ),\n      },\n      {\n        label: (\n          <Text id=\"PurchaseOrders.approvalRuleDetails.fields.description\" />\n        ),\n        value: description,\n      },\n      {\n        label: (\n          <Text id=\"PurchaseOrders.approvalRuleDetails.fields.appliesTo\" />\n        ),\n        value: (\n          <ul>\n            {appliesToRoles.map((item) => (\n              <li key={item.id}>{item.name}</li>\n            ))}\n          </ul>\n        ),\n      },\n      {\n        label: <Text id=\"PurchaseOrders.approvalRuleDetails.fields.ruleType\" />,\n        value: (\n          <Text\n            id={`PurchaseOrders.approvalRuleDetails.fields.condition.attribute.${condition.attribute.toLocaleLowerCase()}`}\n          />\n        ),\n      },\n      {\n        label: (\n          <>\n            <Text\n              id={`PurchaseOrders.approvalRuleDetails.fields.condition.attribute.${condition.attribute.toLocaleLowerCase()}`}\n            />\n            {':'}\n          </>\n        ),\n        value: (\n          <div>\n            <Text\n              id={`PurchaseOrders.approvalRuleDetails.fields.condition.operator.${condition.operator.toLocaleLowerCase()}`}\n            />\n            <Text id=\"PurchaseOrders.approvalRuleDetails.fields.amount.label\" />\n            <PriceRange\n              amount={condition.amount.value}\n              currency={condition.amount.currency}\n            />\n          </div>\n        ),\n      },\n      {\n        label: (\n          <Text id=\"PurchaseOrders.approvalRuleDetails.fields.requiresApprovalFrom\" />\n        ),\n        value: (\n          <ul>\n            {approverRoles.map((item) => (\n              <li key={item.id}>{item.name}</li>\n            ))}\n          </ul>\n        ),\n      },\n    ];\n  }, [approvalRule, loading]);\n\n  const handleRedirectToList = () => {\n    window.location.href = routeApprovalRulesList?.() ?? '';\n  };\n\n  return { handleRedirectToList, loading, formValues };\n};\n","/*******************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent } from 'preact';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport '@/b2b-purchase-order/components/ApprovalRuleDetailsContent/ApprovalRuleDetailsContent.css';\nimport { ApprovalRuleDetailsContentProps } from '@/b2b-purchase-order/types/components';\n\nexport const ApprovalRuleDetailsContent: FunctionComponent<\n  ApprovalRuleDetailsContentProps\n> = ({ formValues }) => {\n  return (\n    <div\n      className={classes(['b2b-purchase-order-approval-rule-details-content'])}\n    >\n      {formValues.map((item, i) => {\n        return (\n          <div\n            key={i}\n            className={classes([\n              'b2b-purchase-order-approval-rule-details-content__item',\n            ])}\n          >\n            <span className=\"b2b-purchase-order-approval-rule-details-content__label\">\n              {item.label}\n            </span>\n            <div className=\"b2b-purchase-order-approval-rule-details-content__value\">\n              {item.value}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","/*******************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  ApprovalRuleDetailsContent,\n  FormLoader,\n  PurchaseOrdersHeader,\n} from '@/b2b-purchase-order/components';\nimport { useApprovalRuleDetails } from '@/b2b-purchase-order/hooks';\nimport { ApprovalRuleDetailsProps } from '@/b2b-purchase-order/types/containers';\nimport { Button, Card } from '@adobe-commerce/elsie/components';\nimport { Text, useText } from '@adobe-commerce/elsie/i18n';\nimport { classes, Container } from '@adobe-commerce/elsie/lib';\n\nexport const ApprovalRuleDetails: Container<ApprovalRuleDetailsProps> = ({\n  withHeader = true,\n  withWrapper = true,\n  className,\n  approvalRuleID,\n  routeApprovalRulesList,\n}) => {\n  const t = useText({\n    headerText: 'PurchaseOrders.approvalRuleDetails.containerTitle',\n  });\n  const { handleRedirectToList, loading, formValues } = useApprovalRuleDetails({\n    routeApprovalRulesList,\n    approvalRuleID,\n  });\n\n  if (!approvalRuleID) return null;\n\n  const renderDetailsContent = !loading ? (\n    <>\n      <ApprovalRuleDetailsContent formValues={formValues} />\n      <Button\n        className={'approval-rule-details__button'}\n        onClick={handleRedirectToList}\n      >\n        <Text id=\"PurchaseOrders.approvalRuleDetails.buttons.back\" />\n      </Button>\n    </>\n  ) : (\n    <FormLoader\n      className={'approval-rule-details--loader'}\n      data-testid=\"approval-rule-details-container--loader\"\n    />\n  );\n\n  return (\n    <div\n      className={classes(['approval-rule-details', className])}\n      data-testid=\"approval-rule-details-container\"\n    >\n      {withHeader ? <PurchaseOrdersHeader headerText={t.headerText} /> : null}\n      {withWrapper ? (\n        <Card variant={'secondary'} data-testid=\"approvalRuleDetailsCard\">\n          {renderDetailsContent}\n        </Card>\n      ) : (\n        renderDetailsContent\n      )}\n    </div>\n  );\n};\n"],"names":["useApprovalRuleDetails","approvalRuleID","routeApprovalRulesList","loading","setLoading","useState","approvalRule","setApprovalRule","useEffect","getPurchaseOrderApprovalRule","data","formValues","useMemo","name","status","description","appliesToRoles","approverRoles","condition","jsx","Text","item","jsxs","Fragment","PriceRange","ApprovalRuleDetailsContent","classes","i","ApprovalRuleDetails","withHeader","withWrapper","className","t","useText","handleRedirectToList","renderDetailsContent","FormLoader","Button","PurchaseOrdersHeader","Card"],"mappings":"owBAwBO,MAAMA,EAAyB,CAAC,CACrC,eAAAC,EACA,uBAAAC,CACF,IAAmC,CACjC,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAS,EAAI,EACrC,CAACC,EAAcC,CAAe,EAClCF,EAAgD,IAAI,EAEtDG,EAAU,IAAM,CACTP,IAELG,EAAW,EAAI,EAEfK,EAA6BR,CAAc,EACxC,KAAMS,GAAS,CACTA,EAAK,KAEVH,EAAgBG,CAAI,CACtB,CAAC,EACA,MAAM,IAAM,CACXH,EAAgB,IAAI,CACtB,CAAC,EACA,QAAQ,IAAM,CACbH,EAAW,EAAK,CAClB,CAAC,EACL,EAAG,CAACH,CAAc,CAAC,EAEnB,MAAMU,EAAaC,EAAQ,IAAM,CAC/B,GAAI,CAACN,GAAgBH,EAAS,MAAO,CAAA,EAErC,KAAM,CACJ,KAAAU,EACA,OAAAC,EACA,YAAAC,EACA,eAAAC,EACA,cAAAC,EACA,UAAAC,CAAA,EACEZ,EAEJ,MAAO,CACL,CACE,MAAOa,EAACC,EAAA,CAAK,GAAG,oDAAA,CAAqD,EACrE,MAAOP,CAAA,EAET,CACE,MAAOM,EAACC,EAAA,CAAK,GAAG,kDAAA,CAAmD,EACnE,MACED,EAACC,EAAA,CACC,GAAI,wDAAwDN,EAAO,kBAAA,CAAmB,EAAA,CAAA,CACxF,EAGJ,CACE,MACEK,EAACC,EAAA,CAAK,GAAG,uDAAA,CAAwD,EAEnE,MAAOL,CAAA,EAET,CACE,MACEI,EAACC,EAAA,CAAK,GAAG,qDAAA,CAAsD,EAEjE,MACED,EAAC,KAAA,CACE,SAAAH,EAAe,IAAKK,GACnBF,EAAC,KAAA,CAAkB,SAAAE,EAAK,IAAA,EAAfA,EAAK,EAAe,CAC9B,CAAA,CACH,CAAA,EAGJ,CACE,MAAOF,EAACC,EAAA,CAAK,GAAG,oDAAA,CAAqD,EACrE,MACED,EAACC,EAAA,CACC,GAAI,iEAAiEF,EAAU,UAAU,mBAAmB,EAAA,CAAA,CAC9G,EAGJ,CACE,MACEI,EAAAC,EAAA,CACE,SAAA,CAAAJ,EAACC,EAAA,CACC,GAAI,iEAAiEF,EAAU,UAAU,mBAAmB,EAAA,CAAA,EAE7G,GAAA,EACH,EAEF,QACG,MAAA,CACC,SAAA,CAAAC,EAACC,EAAA,CACC,GAAI,gEAAgEF,EAAU,SAAS,mBAAmB,EAAA,CAAA,EAE5GC,EAACC,EAAA,CAAK,GAAG,wDAAA,CAAyD,EAClED,EAACK,EAAA,CACC,OAAQN,EAAU,OAAO,MACzB,SAAUA,EAAU,OAAO,QAAA,CAAA,CAC7B,CAAA,CACF,CAAA,EAGJ,CACE,MACEC,EAACC,EAAA,CAAK,GAAG,gEAAA,CAAiE,EAE5E,MACED,EAAC,KAAA,CACE,SAAAF,EAAc,IAAKI,GAClBF,EAAC,KAAA,CAAkB,SAAAE,EAAK,IAAA,EAAfA,EAAK,EAAe,CAC9B,CAAA,CACH,CAAA,CAEJ,CAEJ,EAAG,CAACf,EAAcH,CAAO,CAAC,EAM1B,MAAO,CAAE,qBAJoB,IAAM,CACjC,OAAO,SAAS,MAAOD,GAAA,YAAAA,MAA8B,EACvD,EAE+B,QAAAC,EAAS,WAAAQ,CAAA,CAC1C,EC1Hac,EAET,CAAC,CAAE,WAAAd,KAEHQ,EAAC,MAAA,CACC,UAAWO,EAAQ,CAAC,kDAAkD,CAAC,EAEtE,SAAAf,EAAW,IAAI,CAACU,EAAMM,IAEnBL,EAAC,MAAA,CAEC,UAAWI,EAAQ,CACjB,wDAAA,CACD,EAED,SAAA,CAAAP,EAAC,OAAA,CAAK,UAAU,0DACb,SAAAE,EAAK,MACR,EACAF,EAAC,MAAA,CAAI,UAAU,0DACZ,WAAK,KAAA,CACR,CAAA,CAAA,EAVKQ,CAAA,CAaV,CAAA,CAAA,ECjBMC,EAA2D,CAAC,CACvE,WAAAC,EAAa,GACb,YAAAC,EAAc,GACd,UAAAC,EACA,eAAA9B,EACA,uBAAAC,CACF,IAAM,CACJ,MAAM8B,EAAIC,EAAQ,CAChB,WAAY,mDAAA,CACb,EACK,CAAE,qBAAAC,EAAsB,QAAA/B,EAAS,WAAAQ,CAAA,EAAeX,EAAuB,CAC3E,uBAAAE,EACA,eAAAD,CAAA,CACD,EAED,GAAI,CAACA,EAAgB,OAAO,KAE5B,MAAMkC,EAAwBhC,EAW5BgB,EAACiB,EAAA,CACC,UAAW,gCACX,cAAY,yCAAA,CAAA,EAZdd,EAAAC,EAAA,CACE,SAAA,CAAAJ,EAACM,GAA2B,WAAAd,EAAwB,EACpDQ,EAACkB,EAAA,CACC,UAAW,gCACX,QAASH,EAET,SAAAf,EAACC,EAAA,CAAK,GAAG,iDAAA,CAAkD,CAAA,CAAA,CAC7D,CAAA,CACF,EAQF,OACEE,EAAC,MAAA,CACC,UAAWI,EAAQ,CAAC,wBAAyBK,CAAS,CAAC,EACvD,cAAY,kCAEX,SAAA,CAAAF,EAAaV,EAACmB,EAAA,CAAqB,WAAYN,EAAE,WAAY,EAAK,KAClEF,IACES,EAAA,CAAK,QAAS,YAAa,cAAY,0BACrC,WACH,EAEAJ,CAAA,CAAA,CAAA,CAIR"}