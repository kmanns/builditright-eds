{"version":3,"file":"PurchaseOrderCommentForm.js","sources":["/@dropins/storefront-purchase-order/src/components/PurchaseOrderCommentFormContent/PurchaseOrderCommentFormContent.tsx","/@dropins/storefront-purchase-order/src/containers/PurchaseOrderCommentForm/PurchaseOrderCommentForm.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useState, useMemo, useCallback } from 'preact/hooks';\nimport { FunctionComponent } from 'preact';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport { Button, TextArea } from '@adobe-commerce/elsie/components';\nimport { addPurchaseOrderComment } from '@/b2b-purchase-order/api';\nimport '@/b2b-purchase-order/components/PurchaseOrderCommentFormContent/PurchaseOrderCommentFormContent.css';\nimport { PurchaseOrderCommentFormContentProps } from '@/b2b-purchase-order/types/components';\nimport { events } from '@adobe-commerce/event-bus';\n\nexport const PurchaseOrderCommentFormContent: FunctionComponent<\n  PurchaseOrderCommentFormContentProps\n> = ({ t, purchaseOrderData }) => {\n  const [loading, setLoading] = useState(false);\n  const [textAreaValue, setTextAreaValue] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const isSubmitDisabled = useMemo(\n    () => !textAreaValue.trim().length || !purchaseOrderData?.uid || loading,\n    [textAreaValue, purchaseOrderData, loading]\n  );\n\n  const handleUpdateCommentValue = useCallback(\n    (event: Event) => {\n      const value = (event.target as HTMLTextAreaElement).value;\n      setTextAreaValue(value);\n      if (errorMessage) {\n        setErrorMessage('');\n      }\n    },\n    [errorMessage]\n  );\n\n  const handleSubmitComment = useCallback(() => {\n    const uid = purchaseOrderData?.uid ?? '';\n    if (!uid || !textAreaValue.trim().length) {\n      return;\n    }\n\n    setLoading(true);\n\n    addPurchaseOrderComment(uid, textAreaValue)\n      .then((data) => {\n        if (data && purchaseOrderData?.uid) {\n          events.emit('purchase-order/refresh', true);\n          setTextAreaValue('');\n        }\n      })\n      .catch(() => {\n        setErrorMessage(\n          t.errorMessage || 'Failed to add comment. Please try again.'\n        );\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [purchaseOrderData, textAreaValue, t]);\n\n  return (\n    <div className={classes(['b2b-purchase-order-comment-form-content'])}>\n      <TextArea\n        errorMessage={errorMessage}\n        disabled={loading}\n        value={textAreaValue}\n        label={t.textAreaPlaceholder}\n        onChange={handleUpdateCommentValue}\n      />\n      <Button\n        variant=\"primary\"\n        disabled={isSubmitDisabled}\n        onClick={handleSubmitComment}\n      >\n        {t.buttonText}\n      </Button>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { classes, Container } from '@adobe-commerce/elsie/lib';\nimport {\n  PurchaseOrderCommentFormContent,\n  PurchaseOrdersHeader,\n} from '@/b2b-purchase-order/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { Card, Skeleton, SkeletonRow } from '@adobe-commerce/elsie/components';\nimport { usePurchaseOrderData } from '@/b2b-purchase-order/hooks';\nimport { PurchaseOrderCommentFormProps } from '@/b2b-purchase-order/types/containers';\n\nexport const PurchaseOrderCommentForm: Container<\n  PurchaseOrderCommentFormProps\n> = ({ withHeader = true, withWrapper = true, className }) => {\n  const { poDataLoading, purchaseOrderData } = usePurchaseOrderData();\n\n  const t = useText({\n    headerText: 'PurchaseOrders.comments.add.headerText',\n    buttonText: 'PurchaseOrders.comments.add.submit',\n    textAreaPlaceholder: 'PurchaseOrders.comments.add.placeholder',\n  });\n\n  const renderCommentForm = (\n    <>\n      {withHeader && withWrapper ? (\n        <PurchaseOrdersHeader headerText={t.headerText} divider={true} />\n      ) : null}\n      {!poDataLoading ? (\n        <PurchaseOrderCommentFormContent\n          purchaseOrderData={purchaseOrderData}\n          t={t}\n        />\n      ) : (\n        <Skeleton rowGap=\"medium\" data-testid=\"comment-form-loader\">\n          <SkeletonRow\n            size=\"xlarge\"\n            variant=\"row\"\n            fullWidth\n            lines={2}\n            style={{ maxWidth: 500 }}\n          />\n          <SkeletonRow size=\"medium\" variant=\"row\" lines={1} />\n        </Skeleton>\n      )}\n    </>\n  );\n\n  return (\n    <div\n      className={classes(['b2b-purchase-order-comment-form', className])}\n      data-testid=\"order-history-log-container\"\n    >\n      {withHeader && !withWrapper ? (\n        <PurchaseOrdersHeader headerText={t.headerText} />\n      ) : null}\n      {withWrapper ? (\n        <Card variant={'secondary'} data-testid=\"orderCommentFormCard\">\n          {renderCommentForm}\n        </Card>\n      ) : (\n        renderCommentForm\n      )}\n    </div>\n  );\n};\n"],"names":["PurchaseOrderCommentFormContent","t","purchaseOrderData","loading","setLoading","useState","textAreaValue","setTextAreaValue","errorMessage","setErrorMessage","isSubmitDisabled","useMemo","handleUpdateCommentValue","useCallback","event","value","handleSubmitComment","uid","addPurchaseOrderComment","data","events","classes","jsx","TextArea","Button","PurchaseOrderCommentForm","withHeader","withWrapper","className","poDataLoading","usePurchaseOrderData","useText","renderCommentForm","jsxs","Fragment","PurchaseOrdersHeader","Skeleton","SkeletonRow","Card"],"mappings":"mvBA0BO,MAAMA,EAET,CAAC,CAAE,EAAAC,EAAG,kBAAAC,KAAwB,CAChC,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAS,EAAK,EACtC,CAACC,EAAeC,CAAgB,EAAIF,EAAS,EAAE,EAC/C,CAACG,EAAcC,CAAe,EAAIJ,EAAS,EAAE,EAE7CK,EAAmBC,EACvB,IAAM,CAACL,EAAc,KAAA,EAAO,QAAU,EAACJ,GAAA,MAAAA,EAAmB,MAAOC,EACjE,CAACG,EAAeJ,EAAmBC,CAAO,CAAA,EAGtCS,EAA2BC,EAC9BC,GAAiB,CAChB,MAAMC,EAASD,EAAM,OAA+B,MACpDP,EAAiBQ,CAAK,EAClBP,GACFC,EAAgB,EAAE,CAEtB,EACA,CAACD,CAAY,CAAA,EAGTQ,EAAsBH,EAAY,IAAM,CAC5C,MAAMI,GAAMf,GAAA,YAAAA,EAAmB,MAAO,GAClC,CAACe,GAAO,CAACX,EAAc,KAAA,EAAO,SAIlCF,EAAW,EAAI,EAEfc,EAAwBD,EAAKX,CAAa,EACvC,KAAMa,GAAS,CACVA,IAAQjB,GAAA,MAAAA,EAAmB,OAC7BkB,EAAO,KAAK,yBAA0B,EAAI,EAC1Cb,EAAiB,EAAE,EAEvB,CAAC,EACA,MAAM,IAAM,CACXE,EACER,EAAE,cAAgB,0CAAA,CAEtB,CAAC,EACA,QAAQ,IAAM,CACbG,EAAW,EAAK,CAClB,CAAC,EACL,EAAG,CAACF,EAAmBI,EAAeL,CAAC,CAAC,EAExC,SACG,MAAA,CAAI,UAAWoB,EAAQ,CAAC,yCAAyC,CAAC,EACjE,SAAA,CAAAC,EAACC,EAAA,CACC,aAAAf,EACA,SAAUL,EACV,MAAOG,EACP,MAAOL,EAAE,oBACT,SAAUW,CAAA,CAAA,EAEZU,EAACE,EAAA,CACC,QAAQ,UACR,SAAUd,EACV,QAASM,EAER,SAAAf,EAAE,UAAA,CAAA,CACL,EACF,CAEJ,ECjEawB,EAET,CAAC,CAAE,WAAAC,EAAa,GAAM,YAAAC,EAAc,GAAM,UAAAC,KAAgB,CAC5D,KAAM,CAAE,cAAAC,EAAe,kBAAA3B,CAAA,EAAsB4B,EAAA,EAEvC7B,EAAI8B,EAAQ,CAChB,WAAY,yCACZ,WAAY,qCACZ,oBAAqB,yCAAA,CACtB,EAEKC,EACJC,EAAAC,EAAA,CACG,SAAA,CAAAR,GAAcC,IACZQ,EAAA,CAAqB,WAAYlC,EAAE,WAAY,QAAS,GAAM,EAC7D,KACF4B,EAMAI,EAACG,EAAA,CAAS,OAAO,SAAS,cAAY,sBACpC,SAAA,CAAAd,EAACe,EAAA,CACC,KAAK,SACL,QAAQ,MACR,UAAS,GACT,MAAO,EACP,MAAO,CAAE,SAAU,GAAA,CAAI,CAAA,IAExBA,EAAA,CAAY,KAAK,SAAS,QAAQ,MAAM,MAAO,CAAA,CAAG,CAAA,CAAA,CACrD,EAdAf,EAACtB,EAAA,CACC,kBAAAE,EACA,EAAAD,CAAA,CAAA,CAYF,EAEJ,EAGF,OACEgC,EAAC,MAAA,CACC,UAAWZ,EAAQ,CAAC,kCAAmCO,CAAS,CAAC,EACjE,cAAY,8BAEX,SAAA,CAAAF,GAAc,CAACC,EACdL,EAACa,GAAqB,WAAYlC,EAAE,WAAY,EAC9C,KACH0B,IACEW,EAAA,CAAK,QAAS,YAAa,cAAY,uBACrC,WACH,EAEAN,CAAA,CAAA,CAAA,CAIR"}