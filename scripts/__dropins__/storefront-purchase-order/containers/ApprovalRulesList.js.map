{"version":3,"file":"ApprovalRulesList.js","sources":["/@dropins/storefront-purchase-order/src/configs/purchaseOrderApprovalRules.config.ts","/@dropins/storefront-purchase-order/src/hooks/useApprovalRulesList.tsx","/@dropins/storefront-purchase-order/src/containers/ApprovalRulesList/ApprovalRulesList.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { Column } from '@/b2b-purchase-order/types/components';\n\nexport const defaultApprovalRulesColumns: Column[] = [\n  { key: 'ruleName', label: 'Rule Name' },\n  { key: 'status', label: 'Status' },\n  {\n    key: 'createdBy',\n    label: 'Created By',\n  },\n  { key: 'action', label: 'Actions' },\n];\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  UseApprovalRulesList,\n  UseApprovalRulesListReturn,\n} from '@/b2b-purchase-order/types/hooks';\nimport { useCallback, useEffect, useMemo, useState } from 'preact/hooks';\nimport { events } from '@adobe-commerce/event-bus';\nimport { getStatusVariant, isValidUrl } from '@/b2b-purchase-order/lib';\nimport { Text } from '@adobe-commerce/elsie/i18n';\nimport { defaultApprovalRulesColumns } from '@/b2b-purchase-order/configs';\nimport {\n  deletePurchaseOrderApprovalRule,\n  getPurchaseOrderApprovalRules,\n} from '@/b2b-purchase-order/api';\nimport { PurchaseOrderApprovalRuleModel } from '@/b2b-purchase-order/data/models';\nimport { ActionButton, Tag } from '@adobe-commerce/elsie/components';\n\nconst DEFAULT_PAGE_SIZE = 20;\n\nexport const useApprovalRulesList = ({\n  routeApprovalRuleDetails,\n  routeCreateApprovalRule,\n  routeEditApprovalRule,\n  setColumns,\n  setRowsData,\n  initialPageSize,\n  permissions,\n  loadingPermissions,\n  t,\n}: UseApprovalRulesList): UseApprovalRulesListReturn => {\n  const [approvalRules, setApprovalRules] = useState<\n    PurchaseOrderApprovalRuleModel[]\n  >([]);\n  const [shouldRefetch, setShouldRefetch] = useState(true);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [pageSizeOptionsList, setPageSizeOptionsList] =\n    useState(initialPageSize);\n  const [pagination, setPagination] = useState({\n    currentPage: 1,\n    totalPages: 1,\n    totalCount: 0,\n  });\n  const [expandedRowIndices, setExpandedRowIndices] = useState<Set<number>>(\n    new Set()\n  );\n\n  // Refetch data on the purchase-order/refresh event\n  useEffect(() => {\n    const event = events.on(\n      'purchase-order/refresh',\n      () => {\n        setShouldRefetch(true);\n      },\n      { eager: true }\n    );\n\n    return () => {\n      event?.off();\n    };\n  }, []);\n\n  // Derive pagination values\n  const { currentPage, totalPages, totalCount } = pagination;\n\n  const handlePageChange = useCallback((page: number) => {\n    setPagination((prev) => {\n      return { ...prev, currentPage: page };\n    });\n\n    setExpandedRowIndices(new Set());\n    setShouldRefetch(true);\n  }, []);\n\n  const handleChangePageSize = useCallback(\n    (event: Event) => {\n      const size = (event.target as HTMLSelectElement).value;\n\n      setPageSizeOptionsList((prev) => {\n        return prev.map((option) => ({\n          ...option,\n          selected: option.value === size,\n        }));\n      });\n\n      // Reset the current page to 1 on page size change\n      handlePageChange(1);\n\n      setExpandedRowIndices(new Set());\n      setShouldRefetch(true);\n    },\n    [handlePageChange]\n  );\n\n  const toggleExpandedRow = useCallback((rowIndex: number) => {\n    setExpandedRowIndices((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(rowIndex)) {\n        newSet.delete(rowIndex);\n      } else {\n        newSet.add(rowIndex);\n      }\n      return newSet;\n    });\n  }, []);\n\n  useEffect(() => {\n    // Re-fetch controlled by shouldRefetch flag\n    if (!shouldRefetch) {\n      return;\n    }\n\n    // Don't fetch approval rules until permissions are loaded\n    if (loadingPermissions) {\n      return;\n    }\n\n    setLoading(true);\n    const pageSize = pageSizeOptionsList?.find(\n      (option) => option.selected\n    )?.value;\n    const selectedPageSize = parseInt(\n      pageSize ?? DEFAULT_PAGE_SIZE.toString(),\n      10\n    );\n\n    getPurchaseOrderApprovalRules(currentPage, selectedPageSize)\n      .then((data) => {\n        const responseApprovalRules = data?.items ?? [];\n        const responseCurrentPage = data?.pageInfo?.currentPage;\n        const responseTotalPages = data?.pageInfo?.totalPages;\n        const responseTotalCount = data?.totalCount;\n\n        setPagination({\n          currentPage:\n            responseCurrentPage > responseTotalPages\n              ? responseTotalPages || 1\n              : responseCurrentPage,\n          totalPages: responseTotalPages,\n          totalCount: responseTotalCount,\n        });\n        setApprovalRules(responseApprovalRules);\n      })\n      .catch((error) => {\n        console.error('Error fetching approval rules:', error);\n        setApprovalRules([]);\n      })\n      .finally(() => {\n        setLoading(false);\n        setShouldRefetch(false);\n      });\n  }, [\n    shouldRefetch,\n    currentPage,\n    pageSizeOptionsList,\n    totalPages,\n    loadingPermissions,\n  ]);\n\n  const handleCreateUrl = useCallback(\n    (id: string, type: 'edit' | 'new' | 'view'): string => {\n      let url = '';\n\n      switch (type) {\n        case 'new': {\n          url = routeCreateApprovalRule?.(id) as string;\n          break;\n        }\n        case 'edit': {\n          url = routeEditApprovalRule?.(id) as string;\n          break;\n        }\n        case 'view': {\n          url = routeApprovalRuleDetails?.(id) as string;\n          break;\n        }\n      }\n\n      if (!isValidUrl(url ?? '')) return '#';\n\n      return url;\n    },\n    [routeCreateApprovalRule, routeEditApprovalRule, routeApprovalRuleDetails]\n  );\n\n  const columns = useMemo(() => {\n    return (\n      setColumns?.(defaultApprovalRulesColumns) ??\n      defaultApprovalRulesColumns.map((col) => ({\n        ...col,\n        label: t[col.key as keyof typeof t] || col.label,\n      }))\n    );\n  }, [setColumns, t]);\n\n  const handleDeleteRule = useCallback((e: Event, id: string) => {\n    e.preventDefault();\n    setLoading(true);\n    deletePurchaseOrderApprovalRule(id)\n      .then(() => {\n        events.emit('purchase-order/refresh', true);\n      })\n      .finally(() => {\n        setExpandedRowIndices(new Set());\n      });\n  }, []);\n\n  const rows = useMemo(() => {\n    const modifiedApprovalRules = approvalRules?.map((ar, rowIndex) => {\n      const {\n        isAdmin,\n        permissions: { manageApprovalRules },\n      } = permissions;\n\n      const isExpanded = expandedRowIndices.has(rowIndex);\n      const canManage = isAdmin || manageApprovalRules;\n\n      // Main row action\n      const action = (\n        <ActionButton onClick={() => toggleExpandedRow(rowIndex)}>\n          <Text\n            id={`PurchaseOrders.purchaseOrdersTable.buttons.${\n              isExpanded ? 'expandedHidden' : 'expandedShow'\n            }`}\n          />\n        </ActionButton>\n      );\n\n      // Expanded row details\n      const _rowDetails = (\n        <div className=\"b2b-purchase-order-purchase-orders-table__row-details\">\n          <div className=\"b2b-purchase-order-purchase-orders-table__row-details-content\">\n            <p>\n              <span>\n                <Text id=\"PurchaseOrders.purchaseOrdersTable.expandedRowLabels.ruleType\" />\n              </span>{' '}\n              <Text\n                id={`PurchaseOrders.purchaseOrdersTable.ruleTypes.${ar.condition?.attribute?.toLocaleLowerCase()}`}\n              />\n            </p>\n            <p>\n              <span>\n                <Text id=\"PurchaseOrders.purchaseOrdersTable.expandedRowLabels.appliesTo\" />\n              </span>\n            </p>\n            <ul>\n              {ar?.appliesToRoles?.length <= 0 ? (\n                <li>{t.appliesToAll}</li>\n              ) : (\n                ar?.appliesToRoles?.map((role, idx) => (\n                  <li key={idx}>{role.name}</li>\n                ))\n              )}\n            </ul>\n            <p>\n              <span>\n                <Text id=\"PurchaseOrders.purchaseOrdersTable.expandedRowLabels.approver\" />\n              </span>\n            </p>\n            <ul>\n              {ar?.approverRoles?.map((role, idx) => (\n                <li key={idx}>{role?.name}</li>\n              ))}\n            </ul>\n          </div>\n          {canManage ? (\n            <div className=\"b2b-purchase-order-purchase-orders-table__row-details-action\">\n              <div className=\"b2b-purchase-order-purchase-orders-table__row-details-action-inner-wrapper\">\n                <ActionButton\n                  onClick={() => {\n                    window.location.href = handleCreateUrl(ar.uid, 'edit');\n                  }}\n                  aria-label={t.ariaLabelEditRule.replace(\n                    '{{ruleName}}',\n                    ar.name\n                  )}\n                  data-testid={`edit-approval-rule-${ar.uid}`}\n                >\n                  {t.actionEdit}\n                </ActionButton>\n                <ActionButton\n                  onClick={(e) => handleDeleteRule(e, ar.uid)}\n                  aria-label={t.ariaLabelDeleteRule.replace(\n                    '{{ruleName}}',\n                    ar.name\n                  )}\n                  data-testid={`delete-approval-rule-${ar.uid}`}\n                >\n                  {t.actionDelete}\n                </ActionButton>\n              </div>\n            </div>\n          ) : (\n            <div className=\"b2b-purchase-order-purchase-orders-table__row-details-action\">\n              <ActionButton\n                onClick={() => {\n                  window.location.href = handleCreateUrl(ar.uid, 'view');\n                }}\n                aria-label={t.ariaLabelViewRule.replace(\n                  '{{ruleName}}',\n                  ar.name\n                )}\n                data-testid={`view-approval-rule-${ar.uid}`}\n              >\n                {t.actionView}\n              </ActionButton>\n            </div>\n          )}\n        </div>\n      );\n\n      return {\n        ruleName: ar.name,\n        status: (\n          <Tag\n            className={`b2b-purchase-order-purchase-orders-table__status b2b-purchase-order-purchase-orders-table__status--${getStatusVariant(\n              ar.status\n            )}`}\n          >\n            <Text\n              id={`PurchaseOrders.purchaseOrdersTable.rulesStatus.${ar.status?.toLocaleLowerCase()}`}\n            />\n          </Tag>\n        ),\n        createdBy: ar.createdBy,\n        action,\n        _rowDetails,\n      };\n    });\n\n    let finalRows = modifiedApprovalRules;\n\n    if (setRowsData) {\n      const customRows = setRowsData(modifiedApprovalRules);\n      // If setRowsData returns something, use it, otherwise keep original data\n      if (customRows !== undefined && Array.isArray(customRows)) {\n        finalRows = customRows as typeof modifiedApprovalRules;\n      }\n    }\n\n    return finalRows;\n  }, [\n    approvalRules,\n    expandedRowIndices,\n    permissions,\n    setRowsData,\n    t,\n    handleCreateUrl,\n    handleDeleteRule,\n    toggleExpandedRow,\n  ]);\n\n  return {\n    tableConfig: {\n      columns,\n      rows,\n      expandedRows: expandedRowIndices,\n    },\n    paginationConfig: {\n      currentPage,\n      totalPages,\n      handlePageChange,\n    },\n    pageSizeConfig: {\n      pageSizeOptionsList,\n      onChange: handleChangePageSize,\n    },\n    totalCount,\n    loading,\n    handleCreateUrl,\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { classes, Container } from '@adobe-commerce/elsie/lib';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport {\n  PurchaseOrdersHeader,\n  PurchaseOrdersTable,\n} from '@/b2b-purchase-order/components';\nimport { ApprovalRulesListProps } from '@/b2b-purchase-order/types/containers';\nimport {\n  useApprovalRulesList,\n  useCustomerRolePermissions,\n} from '@/b2b-purchase-order/hooks';\nimport {\n  Button,\n  Skeleton,\n  SkeletonRow,\n} from '@adobe-commerce/elsie/components';\nimport { defaultPageSizeConfig } from '@/b2b-purchase-order/configs';\n\nexport const ApprovalRulesList: Container<ApprovalRulesListProps> = ({\n  routeCreateApprovalRule,\n  routeEditApprovalRule,\n  routeApprovalRuleDetails,\n  setColumns,\n  setRowsData,\n  className = '',\n  withHeader = true,\n  withWrapper = true,\n  skeletonRowCount = 5,\n  initialPageSize = defaultPageSizeConfig,\n}) => {\n  const t = useText({\n    headerText: 'PurchaseOrders.approvalRulesList.containerTitle',\n    ruleName: 'PurchaseOrders.purchaseOrdersTable.tableColumns.ruleName',\n    ruleType: 'PurchaseOrders.purchaseOrdersTable.tableColumns.ruleType',\n    appliesTo: 'PurchaseOrders.purchaseOrdersTable.tableColumns.appliesTo',\n    approver: 'PurchaseOrders.purchaseOrdersTable.tableColumns.approver',\n    createdBy: 'PurchaseOrders.purchaseOrdersTable.tableColumns.createdBy',\n    status: 'PurchaseOrders.purchaseOrdersTable.tableColumns.status',\n    actionEdit: 'PurchaseOrders.purchaseOrdersTable.actionEdit',\n    actionDelete: 'PurchaseOrders.purchaseOrdersTable.actionDelete',\n    addNewRule: 'PurchaseOrders.approvalRulesList.buttons.newRule',\n    actionView: 'PurchaseOrders.purchaseOrdersTable.actionView',\n    appliesToAll: 'PurchaseOrders.purchaseOrdersTable.appliesToAll',\n    emptyTitle: 'PurchaseOrders.approvalRulesList.emptyTitle',\n    ariaLabelEditRule: 'PurchaseOrders.approvalRulesList.ariaLabel.editRule',\n    ariaLabelDeleteRule:\n      'PurchaseOrders.approvalRulesList.ariaLabel.deleteRule',\n    ariaLabelViewRule: 'PurchaseOrders.approvalRulesList.ariaLabel.viewRule',\n  });\n\n  const { permissions, loadingPermissions } = useCustomerRolePermissions();\n  const {\n    loading,\n    tableConfig,\n    paginationConfig,\n    totalCount,\n    pageSizeConfig,\n    handleCreateUrl,\n  } = useApprovalRulesList({\n    routeCreateApprovalRule,\n    routeEditApprovalRule,\n    routeApprovalRuleDetails,\n    setColumns,\n    setRowsData,\n    permissions,\n    initialPageSize,\n    loadingPermissions,\n    t,\n  });\n\n  const {\n    isAdmin,\n    permissions: { manageApprovalRules },\n  } = permissions;\n\n  const renderFooterButton =\n    isAdmin || manageApprovalRules ? (\n      <Button\n        variant=\"primary\"\n        onClick={() => {\n          window.location.href = handleCreateUrl('', 'new');\n        }}\n        data-testid=\"add-new-rule-button\"\n      >\n        {t.addNewRule}\n      </Button>\n    ) : null;\n\n  const footerContent =\n    loading || loadingPermissions ? (\n      <Skeleton data-testid=\"approval-rules-skeleton\">\n        <SkeletonRow variant=\"row\" size=\"small\" />\n      </Skeleton>\n    ) : (\n      renderFooterButton\n    );\n\n  return (\n    <div\n      className={classes(['purchase-orders', className])}\n      data-testid=\"purchase-orders-container\"\n    >\n      {withHeader ? <PurchaseOrdersHeader headerText={t.headerText} /> : null}\n      <PurchaseOrdersTable\n        totalCount={totalCount}\n        columns={tableConfig.columns}\n        rows={tableConfig.rows}\n        expandedRows={tableConfig.expandedRows}\n        paginationConfig={paginationConfig}\n        loading={loading || loadingPermissions}\n        skeletonRowCount={skeletonRowCount}\n        pageSizeConfig={pageSizeConfig}\n        emptyTitle={t.emptyTitle}\n        withWrapper={withWrapper}\n        footer={footerContent}\n      />\n    </div>\n  );\n};\n"],"names":["defaultApprovalRulesColumns","DEFAULT_PAGE_SIZE","useApprovalRulesList","routeApprovalRuleDetails","routeCreateApprovalRule","routeEditApprovalRule","setColumns","setRowsData","initialPageSize","permissions","loadingPermissions","t","approvalRules","setApprovalRules","useState","shouldRefetch","setShouldRefetch","loading","setLoading","pageSizeOptionsList","setPageSizeOptionsList","pagination","setPagination","expandedRowIndices","setExpandedRowIndices","useEffect","event","events","currentPage","totalPages","totalCount","handlePageChange","useCallback","page","prev","handleChangePageSize","size","option","toggleExpandedRow","rowIndex","newSet","pageSize","_a","selectedPageSize","getPurchaseOrderApprovalRules","data","responseApprovalRules","responseCurrentPage","responseTotalPages","_b","responseTotalCount","error","handleCreateUrl","id","type","url","isValidUrl","columns","useMemo","col","handleDeleteRule","e","deletePurchaseOrderApprovalRule","rows","modifiedApprovalRules","ar","isAdmin","manageApprovalRules","isExpanded","canManage","action","jsx","ActionButton","Text","_rowDetails","jsxs","_c","_d","role","idx","_e","Tag","getStatusVariant","_f","finalRows","customRows","ApprovalRulesList","className","withHeader","withWrapper","skeletonRowCount","defaultPageSizeConfig","useText","useCustomerRolePermissions","tableConfig","paginationConfig","pageSizeConfig","renderFooterButton","Button","footerContent","Skeleton","SkeletonRow","classes","PurchaseOrdersHeader","PurchaseOrdersTable"],"mappings":"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"}