{"version":3,"file":"fetch-graphql.js","sources":["/@dropins/storefront-purchase-order/src/lib/fetch-error.ts","/@dropins/storefront-purchase-order/src/lib/network-error.ts","/@dropins/storefront-purchase-order/src/api/fetch-graphql/fetch-graphql.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\n/** Actions */\nexport const handleFetchError = (\n  errors: Array<{ message: string; path: string[] }>\n) => {\n  // We only allow silently skipping the error if it's a SINGLE error.\n  const isSingleError = errors.length === 1;\n\n  /**\n   * TODO: Temporary workaround to avoid UX regressions.\n   * Data is still valid even when these specific errors occur.\n   * Remove this logic once the following issues are resolved:\n   *  - https://jira.corp.adobe.com/browse/LYNX-986\n   *  - https://jira.corp.adobe.com/browse/LYNX-989\n   */\n  if (isSingleError && errors[0]?.path?.length > 0) {\n    const lastStep = errors[0].path[errors[0].path.length - 1];\n\n    const allowedErrorPaths = [\n      'applied_coupons',\n      'applied_gift_cards',\n      'available_payment_methods',\n    ];\n\n    // If the single error's path ends with an allowed step - skip throwing\n    if (allowedErrorPaths.includes(lastStep)) {\n      return;\n    }\n  }\n\n  const errorMessage = errors.map((e: any) => e.message).join(' ');\n\n  throw Error(errorMessage);\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { events } from '@adobe-commerce/event-bus';\n\n/**\n * A function which can be attached to fetchGraphQL to handle thrown errors in\n * a generic way.\n */\nexport const handleNetworkError = (error: Error) => {\n  const isAbortError =\n    error instanceof DOMException && error?.name === 'AbortError';\n\n  const isPlaceOrderError = error?.name === 'PlaceOrderError';\n\n  if (!isAbortError && !isPlaceOrderError) {\n    events.emit('purchase-order/error', {\n      source: 'purchase-order',\n      type: 'network',\n      error: error.message,\n    });\n  }\n  throw error;\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FetchGraphQL } from '@adobe-commerce/fetch-graphql';\n\nexport const {\n  setEndpoint,\n  setFetchGraphQlHeader,\n  removeFetchGraphQlHeader,\n  setFetchGraphQlHeaders,\n  fetchGraphQl,\n  getConfig,\n} = new FetchGraphQL().getMethods();\n"],"names":["handleFetchError","errors","_b","_a","lastStep","errorMessage","e","handleNetworkError","error","isAbortError","isPlaceOrderError","events","setEndpoint","setFetchGraphQlHeader","removeFetchGraphQlHeader","setFetchGraphQlHeaders","fetchGraphQl","getConfig","FetchGraphQL"],"mappings":"oHAkBO,MAAMA,EACXC,GACG,SAWH,GATsBA,EAAO,SAAW,KASnBC,GAAAC,EAAAF,EAAO,CAAC,IAAR,YAAAE,EAAW,OAAX,YAAAD,EAAiB,QAAS,EAAG,CAChD,MAAME,EAAWH,EAAO,CAAC,EAAE,KAAKA,EAAO,CAAC,EAAE,KAAK,OAAS,CAAC,EASzD,GAP0B,CACxB,kBACA,qBACA,2BAAA,EAIoB,SAASG,CAAQ,EACrC,MAEJ,CAEA,MAAMC,EAAeJ,EAAO,IAAKK,GAAWA,EAAE,OAAO,EAAE,KAAK,GAAG,EAE/D,MAAM,MAAMD,CAAY,CAC1B,EC1BaE,EAAsBC,GAAiB,CAClD,MAAMC,EACJD,aAAiB,eAAgBA,GAAA,YAAAA,EAAO,QAAS,aAE7CE,GAAoBF,GAAA,YAAAA,EAAO,QAAS,kBAE1C,KAAI,CAACC,GAAgB,CAACC,GACpBC,EAAO,KAAK,uBAAwB,CAClC,OAAQ,iBACR,KAAM,UACN,MAAOH,EAAM,OAAA,CACd,EAEGA,CACR,EClBa,CACX,YAAAI,EACA,sBAAAC,EACA,yBAAAC,EACA,uBAAAC,EACA,aAAAC,EACA,UAAAC,CACF,EAAI,IAAIC,EAAA,EAAe,WAAA"}