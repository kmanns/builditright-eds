{"version":3,"file":"ShippingMethods.js","sources":["../../node_modules/@adobe-commerce/elsie/src/icons/Delivery.svg","/@dropins/storefront-checkout/src/components/ShippingMethods/ShippingMethodsSkeleton.tsx","/@dropins/storefront-checkout/src/components/ShippingMethods/ShippingMethods.tsx","/@dropins/storefront-checkout/src/containers/ShippingMethods/ShippingMethods.tsx"],"sourcesContent":["import * as React from \"react\";\nconst SvgDelivery = (props) => /* @__PURE__ */ React.createElement(\"svg\", { width: 24, height: 24, viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M2.47266 4.90002H15.1851V10.9645H21.2495L23 12.715V17.6124H20.073\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M15.1758 5.87573H19.0019L21.0394 10.7636\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M9.76151 16.7898C9.76151 18.0525 8.72845 19.076 7.46582 19.076C6.20318 19.076 5.17969 18.0429 5.17969 16.7803C5.17969 15.5176 6.20318 14.4941 7.46582 14.4941C8.72845 14.4941 9.75195 15.5176 9.76151 16.7803C9.76151 16.7803 9.76151 16.7803 9.76151 16.7898Z\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M19.8726 16.7898C19.8726 18.062 18.8491 19.0855 17.5769 19.0855C16.3047 19.0855 15.2812 18.062 15.2812 16.7898C15.2812 15.5176 16.3047 14.4941 17.5769 14.4941C18.8491 14.4941 19.8726 15.5176 19.8726 16.7898Z\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M8.08792 7.63574H1.69824\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M7.11229 10.3619H1\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M5.16084 13.0402H1.92773\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M9.76172 16.7611H15.2809\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M2.38672 16.7611H5.17025\", stroke: \"currentColor\", strokeWidth: 1, strokeLinecap: \"round\", strokeLinejoin: \"round\" }));\nexport default SvgDelivery;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { FunctionComponent } from 'preact';\nimport { Skeleton, SkeletonRow } from '@adobe-commerce/elsie/components';\n\nexport const ShippingMethodsSkeleton: FunctionComponent = () => {\n  return (\n    <Skeleton data-testid=\"shipping-methods-skeleton\">\n      <SkeletonRow size=\"small\" variant=\"heading\" />\n      <SkeletonRow size=\"small\" variant=\"empty\" />\n      <SkeletonRow fullWidth={true} size=\"medium\" />\n      <SkeletonRow fullWidth={true} size=\"medium\" />\n    </Skeleton>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { WithConditionals } from '@/checkout/components/ConditionalWrapper/ConditionalWrapper';\nimport '@/checkout/components/ShippingMethods/ShippingMethods.css';\nimport { ShippingMethodsSkeleton } from '@/checkout/components/ShippingMethods/ShippingMethodsSkeleton';\nimport { ShippingMethod } from '@/checkout/data/models';\nimport { scrollToElement } from '@/checkout/lib';\nimport { UIComponentType } from '@/checkout/types';\nimport {\n  Icon,\n  IllustratedMessage,\n  InLineAlert,\n  Price,\n  RadioButton,\n  ToggleButton,\n} from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { Delivery } from '@adobe-commerce/elsie/icons';\nimport { classes, VComponent } from '@adobe-commerce/elsie/lib';\nimport { FunctionComponent, VNode } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\nimport { useEffect, useRef } from 'preact/hooks';\n\nexport interface ShippingMethodsProps\n  extends Omit<HTMLAttributes<HTMLDivElement>, 'title'> {\n  UIComponentType?: UIComponentType;\n  busy?: boolean;\n  error?: string | null;\n  onDismissError?: () => void;\n  onSelectionChange?: (method: ShippingMethod) => void;\n  options: ShippingMethod[];\n  selection: ShippingMethod | null;\n  title?: VNode;\n}\n\nconst ShippingMethodsComponent: FunctionComponent<ShippingMethodsProps> = ({\n  className,\n  busy = false,\n  onSelectionChange = () => {},\n  options,\n  selection,\n  title,\n  UIComponentType = 'RadioButton',\n  error = null,\n  onDismissError = () => {},\n  ...props\n}) => {\n  const translations = useText({\n    EmptyState: 'Checkout.ShippingMethods.emptyState',\n  });\n\n  const hasError = error !== null;\n  const errorRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (hasError && errorRef.current) {\n      scrollToElement(errorRef.current);\n    }\n  }, [hasError]);\n\n  const renderShippingMethod = (\n    method: ShippingMethod,\n    type: UIComponentType\n  ) => {\n    const commonProps = {\n      busy,\n      className: 'checkout-shipping-methods__method',\n      key: method.value,\n      name: 'shipping-method',\n      value: method.value,\n      onChange: () => onSelectionChange(method),\n    };\n\n    if (type === 'RadioButton') {\n      return (\n        <RadioButton\n          {...commonProps}\n          checked={selection?.value === method.value}\n          data-testid=\"shipping-method-radioButton\"\n          description={method.title}\n          disabled={busy}\n          id={method.value}\n          label={\n            <>\n              <Price\n                amount={method.amount.value}\n                currency={method.amount.currency}\n              />\n              &nbsp;\n              <span>{method.carrier.title}</span>\n            </>\n          }\n        />\n      );\n    }\n\n    return (\n      <ToggleButton\n        {...commonProps}\n        data-testid=\"shipping-method-toggleButton\"\n        label={\n          <>\n            <span>{method.carrier.title}</span>\n            <Price\n              amount={method.amount.value}\n              currency={method.amount.currency}\n            />\n          </>\n        }\n        selected={selection?.value === method.value}\n      />\n    );\n  };\n\n  return (\n    <div\n      {...props}\n      className={classes(['checkout-shipping-methods', className])}\n      data-testid=\"checkout-shipping-methods\"\n    >\n      {title && (\n        <VComponent className=\"checkout-shipping-methods__title\" node={title} />\n      )}\n\n      <div className={classes(['checkout-shipping-methods__content'])}>\n        <div\n          className={classes([\n            'checkout-shipping-methods__options',\n            ['checkout-shipping-methods__options--busy', busy],\n            [\n              'checkout-shipping-methods__options--toggleButton',\n              UIComponentType === 'ToggleButton',\n            ],\n          ])}\n          data-testid=\"checkout-shipping-methods-options\"\n        >\n          {options.length === 0 ? (\n            <IllustratedMessage\n              data-testid=\"checkout-shipping-methods-empty\"\n              icon={<Icon source={Delivery} />}\n              message={<p>{translations.EmptyState}</p>}\n            />\n          ) : (\n            options.map((method: ShippingMethod) =>\n              renderShippingMethod(method, UIComponentType)\n            )\n          )}\n        </div>\n      </div>\n\n      {hasError && (\n        <div\n          ref={errorRef}\n          className=\"checkout-shipping-methods__error\"\n          data-testid=\"checkout-shipping-methods-alert\"\n        >\n          <InLineAlert\n            heading={error}\n            type=\"error\"\n            variant=\"primary\"\n            onDismiss={onDismissError}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const ShippingMethods = WithConditionals(\n  ShippingMethodsComponent,\n  ShippingMethodsSkeleton\n);\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { config, setShippingMethods } from '@/checkout/api';\nimport { ShippingMethods as ShippingMethodsComponent } from '@/checkout/components/ShippingMethods';\nimport {\n  Cart,\n  NegotiableQuote,\n  ShippingEstimate,\n  ShippingMethod,\n  ShippingMethodInput,\n} from '@/checkout/data/models';\nimport { transformShippingEstimateShippingMethod } from '@/checkout/data/transforms';\nimport {\n  getLatestCheckoutUpdate,\n  getValue,\n  hasPendingShippingEstimate,\n  hasPendingUpdates,\n  hasShippingAddress,\n  isQuoteCheckout,\n  notifyValues,\n} from '@/checkout/lib';\nimport { Filter, TitleProps, UIComponentType } from '@/checkout/types';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { Container, Slot } from '@adobe-commerce/elsie/lib';\nimport { events } from '@adobe-commerce/event-bus';\nimport { HTMLAttributes } from 'preact/compat';\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\ninterface CartSyncError {\n  method: ShippingMethod;\n  error: Error;\n}\n\nexport type ShippingOptionsFilter = Filter<ShippingMethod>;\n\nexport interface ShippingMethodsProps\n  extends HTMLAttributes<HTMLDivElement>,\n    TitleProps {\n  UIComponentType?: UIComponentType;\n  active?: boolean;\n  autoSync?: boolean;\n  onCartSyncError?: (error: CartSyncError) => void;\n  onSelectionChange?: (method: ShippingMethod) => void;\n}\n\nfunction isMethodAvailable(\n  method: ShippingMethod | null,\n  options: ShippingMethod[]\n) {\n  if (!method) return false;\n  return options.some((option) => isEqual(option, method));\n}\n\nfunction isEqual(a: ShippingMethod | null, b: ShippingMethod | null) {\n  if (!a || !b) return false;\n  if (a.amount.value !== b.amount.value) return false;\n  return a.code === b.code && a.carrier.code === b.carrier.code;\n}\n\nexport function emitShippingEstimateEvent(selection: ShippingMethod) {\n  const shippingEstimatedEvent = events.lastPayload('shipping/estimate');\n\n  if (!shippingEstimatedEvent) return;\n\n  events.emit('shipping/estimate', {\n    ...shippingEstimatedEvent,\n    shippingMethod: transformShippingEstimateShippingMethod(selection),\n  });\n}\n\nexport const ShippingMethods: Container<ShippingMethodsProps> = ({\n  UIComponentType = 'RadioButton',\n  active = true,\n  autoSync = true,\n  displayTitle = true,\n  initialData,\n  slots,\n  onCartSyncError,\n  onSelectionChange,\n  ...props\n}) => {\n  const [error, setError] = useState<string | null>(null);\n  const [isVirtual, setIsVirtual] = useState(false);\n  const [options, setOptions] = useState<ShippingMethod[] | undefined>();\n  const [selection, setSelection] = useState<ShippingMethod | null>(null);\n  const initialQuoteOptions = useRef<ShippingMethod[] | null>(null);\n\n  const hasQueuedUpdates = hasPendingUpdates.value;\n  const hasPendingEstimations = hasPendingShippingEstimate.value;\n\n  const { cartSyncError, defaultTitle } = useText({\n    cartSyncError: 'Checkout.ShippingMethods.cartSyncError',\n    defaultTitle: 'Checkout.ShippingMethods.title',\n  });\n\n  const filterOptions = useCallback(\n    (shippingMethods: ShippingMethod[] | undefined) => {\n      if (!shippingMethods || shippingMethods.length === 0) return [];\n      const { shipping } = config.getConfig();\n      if (!shipping?.filterOptions) return shippingMethods;\n      return shippingMethods.filter(shipping.filterOptions);\n    },\n    []\n  );\n\n  const preselectOption = useCallback((shippingMethods: ShippingMethod[]) => {\n    if (shippingMethods.length === 0) return null;\n    const { defaults } = config.getConfig();\n    return defaults!.selectedShippingMethod!(shippingMethods);\n  }, []);\n\n  const filteredOptions = useMemo(() => {\n    return filterOptions(options);\n  }, [options, filterOptions]);\n\n  const handleDismissError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const setUserSelection = useCallback(\n    (shippingMethod: ShippingMethod | null) => {\n      setError(null);\n      setSelection((prev) => {\n        if (isEqual(prev, shippingMethod)) return prev;\n        notifyValues({ selectedShippingMethod: shippingMethod });\n        return shippingMethod;\n      });\n    },\n    []\n  );\n\n  const setUserSelectionOnCart = useCallback(\n    async (selection: ShippingMethod, fallback?: ShippingMethod | null) => {\n      if (!autoSync || !hasShippingAddress()) return;\n\n      const shippingMethodInput: ShippingMethodInput = {\n        carrierCode: selection.carrier.code,\n        methodCode: selection.code,\n      };\n\n      setShippingMethods([shippingMethodInput]).catch((error) => {\n        setUserSelection(fallback ?? null);\n        onCartSyncError?.({ method: selection, error });\n\n        if (!onCartSyncError) {\n          setError(cartSyncError);\n        }\n      });\n    },\n    [autoSync, setUserSelection, onCartSyncError, cartSyncError]\n  );\n\n  const handleSelectionChange = useCallback(\n    async (selection: ShippingMethod) => {\n      const prevSelection = getValue('selectedShippingMethod');\n\n      setUserSelection(selection);\n      onSelectionChange?.(selection);\n\n      if (!hasShippingAddress()) {\n        emitShippingEstimateEvent(selection);\n      }\n\n      await setUserSelectionOnCart(selection, prevSelection);\n    },\n    [onSelectionChange, setUserSelection, setUserSelectionOnCart]\n  );\n\n  const handleCheckoutData = useCallback(\n    (data: Cart | NegotiableQuote | null) => {\n      const isEmptyCart = !data || data.isEmpty;\n      const isVirtualCart = Boolean(data?.isVirtual);\n\n      if (isEmptyCart || isVirtualCart) {\n        setIsVirtual(isVirtualCart);\n        setUserSelection(null);\n        setOptions([]);\n        return;\n      }\n\n      const primaryAddress = data!.shippingAddresses?.[0];\n\n      // If there is no primary address, options are handled by the shipping estimation\n      if (!primaryAddress) return;\n\n      const availableOptions = primaryAddress.availableShippingMethods ?? [];\n\n      // For quote checkouts, preserve initial shipping methods. After the first method is selected,\n      // the backend only returns that selected method, preventing users from changing to other\n      // options. We maintain all initial options to match Luma's behavior.\n      if (isQuoteCheckout() && !initialQuoteOptions.current) {\n        initialQuoteOptions.current = availableOptions;\n      }\n\n      const effectiveOptions =\n        isQuoteCheckout() && initialQuoteOptions.current\n          ? initialQuoteOptions.current\n          : availableOptions;\n\n      setOptions(effectiveOptions);\n      const filteredOptions = filterOptions(effectiveOptions);\n\n      // If there are no filtered options, reset the user selection\n      if (filteredOptions.length === 0) {\n        setUserSelection(null);\n        return;\n      }\n\n      const cartSelection = primaryAddress.selectedShippingMethod ?? null;\n\n      const userSelection = getValue('selectedShippingMethod');\n      const isAvailable = isMethodAvailable(userSelection, filteredOptions);\n      const haveSameSelection = isEqual(userSelection, cartSelection);\n\n      // Handle user selection that's available but different from cart\n      if (userSelection && isAvailable && !haveSameSelection) {\n        setUserSelectionOnCart(userSelection, cartSelection);\n        return;\n      }\n\n      // If no user selection or not available, decide what to do based on cart and filtered options\n      if ((!userSelection || !isAvailable) && cartSelection) {\n        // Check if cart selection is still available after filtering\n        const isCartSelectionAvailable = isMethodAvailable(\n          cartSelection,\n          filteredOptions\n        );\n        if (isCartSelectionAvailable) {\n          setUserSelection(cartSelection);\n          return;\n        }\n      }\n\n      if (\n        (!userSelection || !isAvailable) &&\n        (!cartSelection || !isMethodAvailable(cartSelection, filteredOptions))\n      ) {\n        const newSelection = preselectOption(filteredOptions);\n        setUserSelection(newSelection);\n        if (newSelection) setUserSelectionOnCart(newSelection);\n      }\n    },\n    [filterOptions, preselectOption, setUserSelection, setUserSelectionOnCart]\n  );\n\n  const handleShippingEstimate = useCallback(\n    (estimation: ShippingEstimate | undefined) => {\n      if (estimation === undefined) return;\n\n      const { shippingMethod, availableShippingMethods } = estimation;\n\n      const selectedShippingMethod =\n        availableShippingMethods?.find(\n          (method) =>\n            method.code === shippingMethod?.methodCode &&\n            method.carrier.code === shippingMethod?.carrierCode\n        ) ?? null;\n\n      setOptions(availableShippingMethods);\n      setUserSelection(selectedShippingMethod);\n    },\n    [setUserSelection]\n  );\n\n  useEffect(() => {\n    if (!active) return;\n\n    const pastUpdate = getLatestCheckoutUpdate();\n\n    if (pastUpdate) {\n      // When component becomes active, restore key state so handleCheckoutData can work properly\n      const userSelection = getValue('selectedShippingMethod');\n      if (userSelection) {\n        setSelection(userSelection);\n      }\n\n      handleCheckoutData(pastUpdate);\n      return;\n    }\n\n    const onCheckoutInit = events.on(\n      'checkout/initialized',\n      handleCheckoutData,\n      { eager: true }\n    );\n\n    return () => {\n      onCheckoutInit?.off();\n    };\n  }, [active, handleCheckoutData]);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const onCheckoutUpdated = events.on(\n      'checkout/updated',\n      handleCheckoutData,\n      { eager: false }\n    );\n\n    return () => {\n      onCheckoutUpdated?.off();\n    };\n  }, [active, handleCheckoutData]);\n\n  useEffect(() => {\n    if (!active || hasShippingAddress()) return;\n\n    const onShippingEstimate = events.on(\n      'shipping/estimate',\n      handleShippingEstimate,\n      { eager: true }\n    );\n\n    return () => {\n      onShippingEstimate?.off();\n    };\n  }, [active, handleShippingEstimate]);\n\n  const titleContent = useMemo(() => {\n    if (!displayTitle) return undefined;\n\n    return (\n      <Slot name=\"checkout-shipping-methods-title\" slot={slots?.Title}>\n        <h3>{defaultTitle}</h3>\n      </Slot>\n    );\n  }, [displayTitle, slots?.Title, defaultTitle]);\n\n  return (\n    <ShippingMethodsComponent\n      {...props}\n      UIComponentType={UIComponentType}\n      busy={hasQueuedUpdates || hasPendingEstimations}\n      error={error}\n      initialized={options !== undefined}\n      options={filteredOptions}\n      selection={selection}\n      title={titleContent}\n      visible={active && !isVirtual}\n      onDismissError={handleDismissError}\n      onSelectionChange={handleSelectionChange}\n    />\n  );\n};\n"],"names":["SvgDelivery","props","React","ShippingMethodsSkeleton","jsxs","Skeleton","jsx","SkeletonRow","ShippingMethodsComponent","className","busy","onSelectionChange","options","selection","title","UIComponentType","error","onDismissError","translations","useText","hasError","errorRef","useRef","useEffect","scrollToElement","renderShippingMethod","method","type","commonProps","RadioButton","Fragment","Price","ToggleButton","classes","VComponent","IllustratedMessage","Icon","Delivery","InLineAlert","ShippingMethods","WithConditionals","isMethodAvailable","option","isEqual","a","b","emitShippingEstimateEvent","shippingEstimatedEvent","events","transformShippingEstimateShippingMethod","active","autoSync","displayTitle","initialData","slots","onCartSyncError","setError","useState","isVirtual","setIsVirtual","setOptions","setSelection","initialQuoteOptions","hasQueuedUpdates","hasPendingUpdates","hasPendingEstimations","hasPendingShippingEstimate","cartSyncError","defaultTitle","filterOptions","useCallback","shippingMethods","shipping","config","preselectOption","defaults","filteredOptions","useMemo","handleDismissError","setUserSelection","shippingMethod","prev","notifyValues","setUserSelectionOnCart","fallback","hasShippingAddress","shippingMethodInput","setShippingMethods","handleSelectionChange","prevSelection","getValue","handleCheckoutData","data","isEmptyCart","isVirtualCart","primaryAddress","_a","availableOptions","isQuoteCheckout","effectiveOptions","cartSelection","userSelection","isAvailable","haveSameSelection","newSelection","handleShippingEstimate","estimation","availableShippingMethods","selectedShippingMethod","pastUpdate","getLatestCheckoutUpdate","onCheckoutInit","onCheckoutUpdated","onShippingEstimate","titleContent","Slot"],"mappings":"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","x_google_ignoreList":[0]}