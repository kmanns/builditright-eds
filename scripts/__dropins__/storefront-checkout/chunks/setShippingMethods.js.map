{"version":3,"file":"setShippingMethods.js","sources":["/@dropins/storefront-checkout/src/api/setShippingMethods/graphql/setShippingMethodsOnCart.graphql.ts","/@dropins/storefront-checkout/src/api/setShippingMethods/graphql/setShippingMethodsOnQuote.graphql.ts","/@dropins/storefront-checkout/src/api/setShippingMethods/setShippingMethods.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { CHECKOUT_DATA_FRAGMENT } from '@/checkout/api/graphql/CheckoutDataFragment.graphql';\n\nexport const setShippingMethodsOnCartMutation = /* GraphQL */ `\n  mutation setShippingMethodsOnCart(\n    $cartId: String!\n    $shippingMethods: [ShippingMethodInput]!\n  ) {\n    setShippingMethodsOnCart(\n      input: { cart_id: $cartId, shipping_methods: $shippingMethods }\n    ) {\n      cart {\n        ...CHECKOUT_DATA_FRAGMENT\n      }\n    }\n  }\n\n  ${CHECKOUT_DATA_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/checkout/api/graphql/NegotiableQuoteFragment.graphql';\n\nexport const setShippingMethodsOnQuoteMutation = /* GraphQL */ `\n  mutation setShippingMethodsOnQuote(\n    $quoteId: ID!\n    $shippingMethods: [ShippingMethodInput]!\n  ) {\n    setNegotiableQuoteShippingMethods(\n      input: { quote_uid: $quoteId, shipping_methods: $shippingMethods }\n    ) {\n      quote {\n        ...NEGOTIABLE_QUOTE_FRAGMENT\n      }\n    }\n  }\n\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  setShippingMethodsOnCartMutation,\n  setShippingMethodsOnQuoteMutation,\n} from '@/checkout/api/setShippingMethods/graphql';\nimport { ShippingMethodInput as ShippingMethodInputModel } from '@/checkout/data/models/api';\nimport {\n  transformCart,\n  transformNegotiableQuote,\n  transformShippingMethodsInputModel,\n} from '@/checkout/data/transforms';\nimport { dispatchApiCall } from '@/checkout/lib/dispatchApiCall';\nimport { QueueName } from '@/checkout/lib/enqueueRequest';\nimport { MissingShippingMethod } from '@/checkout/lib/errors/customErrors';\nimport { ensureHasCartOrQuoteId } from '@/checkout/lib/guards';\nimport { state } from '@/checkout/lib/state';\n\nconst createShippingMethodsSetter = <TTransformedOutput>(\n  entityId: string,\n  entityKey: string,\n  mutation: string,\n  transformer: (data: any) => TTransformedOutput,\n  path: string\n) => {\n  return async (\n    input: Array<ShippingMethodInputModel>\n  ): Promise<TTransformedOutput> => {\n    return await dispatchApiCall({\n      type: 'mutation',\n      query: mutation,\n      queueName: QueueName.Updates,\n      options: {\n        variables: {\n          [entityKey]: entityId,\n          shippingMethods: transformShippingMethodsInputModel(input),\n        },\n      },\n      path,\n      transformer,\n    });\n  };\n};\n\nconst ensureIsValidInput = (input: Array<ShippingMethodInputModel>) => {\n  if (!Array.isArray(input) || input.length === 0) {\n    throw new MissingShippingMethod();\n  }\n};\n\nexport const setShippingMethods = async (\n  input: Array<ShippingMethodInputModel>\n) => {\n  ensureHasCartOrQuoteId();\n  ensureIsValidInput(input);\n\n  const isCart = Boolean(state.cartId);\n\n  const setter = isCart\n    ? createShippingMethodsSetter(\n        state.cartId!,\n        'cartId',\n        setShippingMethodsOnCartMutation,\n        transformCart,\n        'setShippingMethodsOnCart.cart'\n      )\n    : createShippingMethodsSetter(\n        state.quoteId!,\n        'quoteId',\n        setShippingMethodsOnQuoteMutation,\n        transformNegotiableQuote,\n        'setNegotiableQuoteShippingMethods.quote'\n      );\n\n  return await setter(input);\n};\n"],"names":["setShippingMethodsOnCartMutation","CHECKOUT_DATA_FRAGMENT","setShippingMethodsOnQuoteMutation","NEGOTIABLE_QUOTE_FRAGMENT","createShippingMethodsSetter","entityId","entityKey","mutation","transformer","path","input","dispatchApiCall","QueueName","transformShippingMethodsInputModel","ensureIsValidInput","MissingShippingMethod","setShippingMethods","ensureHasCartOrQuoteId","state","transformCart","transformNegotiableQuote"],"mappings":"iTAmBa,MAAAA,EAAiD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAc1DC,CAAsB;AAAA,ECdbC,EAAkD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAc3DC,CAAyB;AAAA,ECAvBC,EAA8B,CAClCC,EACAC,EACAC,EACAC,EACAC,IAEO,MACLC,GAEO,MAAMC,EAAgB,CAC3B,KAAM,WACN,MAAOJ,EACP,UAAWK,EAAU,QACrB,QAAS,CACP,UAAW,CACT,CAACN,CAAS,EAAGD,EACb,gBAAiBQ,EAAmCH,CAAK,CAAA,CAE7D,EACA,KAAAD,EACA,YAAAD,CAAA,CACD,EAICM,EAAsBJ,GAA2C,CACrE,GAAI,CAAC,MAAM,QAAQA,CAAK,GAAKA,EAAM,SAAW,EAC5C,MAAM,IAAIK,CAEd,EAEaC,EAAqB,MAChCN,IAEuBO,EAAA,EACvBH,EAAmBJ,CAAK,EAoBjB,MAlBQ,EAAQQ,EAAM,OAGzBd,EACEc,EAAM,OACN,SACAlB,EACAmB,EACA,+BAAA,EAEFf,EACEc,EAAM,QACN,UACAhB,EACAkB,EACA,yCACF,GAEgBV,CAAK"}