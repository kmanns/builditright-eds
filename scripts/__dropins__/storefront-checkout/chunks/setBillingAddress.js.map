{"version":3,"file":"setBillingAddress.js","sources":["/@dropins/storefront-checkout/src/api/setBillingAddress/graphql/setBillingAddressOnCartMutation.graphql.ts","/@dropins/storefront-checkout/src/api/setBillingAddress/graphql/setBillingAddressOnQuoteMutation.graphql.ts","/@dropins/storefront-checkout/src/api/setBillingAddress/setBillingAddress.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { CHECKOUT_DATA_FRAGMENT } from '@/checkout/api/graphql/CheckoutDataFragment.graphql';\n\nexport const setBillingAddressOnCartMutation = /* GraphQL */ `\n  mutation setBillingAddress(\n    $cartId: String!\n    $billingAddress: BillingAddressInput!\n  ) {\n    setBillingAddressOnCart(\n      input: { cart_id: $cartId, billing_address: $billingAddress }\n    ) {\n      cart {\n        ...CHECKOUT_DATA_FRAGMENT\n      }\n    }\n  }\n\n  ${CHECKOUT_DATA_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { NEGOTIABLE_QUOTE_FRAGMENT } from '@/checkout/api/graphql/NegotiableQuoteFragment.graphql';\n\nexport const setBillingAddressOnQuoteMutation = /* GraphQL */ `\n  mutation setBillingAddressOnQuote(\n    $quoteId: ID!\n    $billingAddress: NegotiableQuoteBillingAddressInput!\n  ) {\n    setNegotiableQuoteBillingAddress(\n      input: { quote_uid: $quoteId, billing_address: $billingAddress }\n    ) {\n      quote {\n        ...NEGOTIABLE_QUOTE_FRAGMENT\n      }\n    }\n  }\n\n  ${NEGOTIABLE_QUOTE_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  setBillingAddressOnCartMutation,\n  setBillingAddressOnQuoteMutation,\n} from '@/checkout/api/setBillingAddress/graphql';\nimport { BillingAddressInput as BillingAddressInputModel } from '@/checkout/data/models';\nimport {\n  transformBillingAddressInputModelToCartInput,\n  transformBillingAddressInputModelToQuoteInput,\n  transformCart,\n  transformNegotiableQuote,\n} from '@/checkout/data/transforms';\nimport { dispatchApiCall } from '@/checkout/lib/dispatchApiCall';\nimport { QueueName } from '@/checkout/lib/enqueueRequest';\nimport { InvalidInput, MissingBillingAddress } from '@/checkout/lib/errors';\nimport { ensureHasCartOrQuoteId } from '@/checkout/lib/guards';\nimport { state } from '@/checkout/lib/state';\n\nconst createBillingAddressSetter = <TTransformedInput, TTransformedOutput>(\n  entityId: string,\n  entityKey: string,\n  mutation: string,\n  transformer: (data: any) => TTransformedOutput,\n  transformInput: (input: BillingAddressInputModel) => TTransformedInput,\n  path: string\n) => {\n  return async (\n    input: BillingAddressInputModel\n  ): Promise<TTransformedOutput> => {\n    return await dispatchApiCall({\n      type: 'mutation',\n      query: mutation,\n      options: {\n        variables: {\n          [entityKey]: entityId,\n          billingAddress: transformInput(input),\n        },\n      },\n      path,\n      queueName: QueueName.Updates,\n      transformer,\n    });\n  };\n};\n\nconst ensureIsValidCartInput = ({\n  address,\n  customerAddressId,\n  customerAddressUid,\n  sameAsShipping = false,\n}: BillingAddressInputModel) => {\n  if (!customerAddressId && customerAddressUid) {\n    throw new InvalidInput('customerAddressUid is not supported');\n  }\n\n  if (!sameAsShipping && !customerAddressId && !address) {\n    throw new MissingBillingAddress();\n  }\n};\n\nconst ensureIsValidQuoteInput = ({\n  address,\n  customerAddressId,\n  customerAddressUid,\n  sameAsShipping = false,\n}: BillingAddressInputModel) => {\n  if (!customerAddressUid && customerAddressId) {\n    throw new InvalidInput('customerAddressId is not supported');\n  }\n\n  if (!sameAsShipping && !customerAddressUid && !address) {\n    throw new MissingBillingAddress();\n  }\n};\n\nconst ensureIsValidInput = (input: BillingAddressInputModel) => {\n  const isCart = Boolean(state.cartId);\n  const isQuote = Boolean(state.quoteId);\n\n  if (isCart) {\n    ensureIsValidCartInput(input);\n  } else if (isQuote) {\n    ensureIsValidQuoteInput(input);\n  }\n};\n\nexport const setBillingAddress = async (input: BillingAddressInputModel) => {\n  ensureHasCartOrQuoteId();\n  ensureIsValidInput(input);\n\n  const isCart = Boolean(state.cartId);\n\n  const setter = isCart\n    ? createBillingAddressSetter(\n        state.cartId!,\n        'cartId',\n        setBillingAddressOnCartMutation,\n        transformCart,\n        transformBillingAddressInputModelToCartInput,\n        'setBillingAddressOnCart.cart'\n      )\n    : createBillingAddressSetter(\n        state.quoteId!,\n        'quoteId',\n        setBillingAddressOnQuoteMutation,\n        transformNegotiableQuote,\n        transformBillingAddressInputModelToQuoteInput,\n        'setNegotiableQuoteBillingAddress.quote'\n      );\n\n  return await setter(input);\n};\n"],"names":["setBillingAddressOnCartMutation","CHECKOUT_DATA_FRAGMENT","setBillingAddressOnQuoteMutation","NEGOTIABLE_QUOTE_FRAGMENT","createBillingAddressSetter","entityId","entityKey","mutation","transformer","transformInput","path","input","dispatchApiCall","QueueName","ensureIsValidCartInput","address","customerAddressId","customerAddressUid","sameAsShipping","InvalidInput","MissingBillingAddress","ensureIsValidQuoteInput","ensureIsValidInput","isCart","state","isQuote","setBillingAddress","ensureHasCartOrQuoteId","transformCart","transformBillingAddressInputModelToCartInput","transformNegotiableQuote","transformBillingAddressInputModelToQuoteInput"],"mappings":"+TAmBa,MAAAA,EAAgD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAczDC,CAAsB;AAAA,ECdbC,EAAiD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAc1DC,CAAyB;AAAA,ECCvBC,EAA6B,CACjCC,EACAC,EACAC,EACAC,EACAC,EACAC,IAEO,MACLC,GAEO,MAAMC,EAAgB,CAC3B,KAAM,WACN,MAAOL,EACP,QAAS,CACP,UAAW,CACT,CAACD,CAAS,EAAGD,EACb,eAAgBI,EAAeE,CAAK,CAAA,CAExC,EACA,KAAAD,EACA,UAAWG,EAAU,QACrB,YAAAL,CAAA,CACD,EAICM,EAAyB,CAAC,CAC9B,QAAAC,EACA,kBAAAC,EACA,mBAAAC,EACA,eAAAC,EAAiB,EACnB,IAAgC,CAC1B,GAAA,CAACF,GAAqBC,EAClB,MAAA,IAAIE,EAAa,qCAAqC,EAG9D,GAAI,CAACD,GAAkB,CAACF,GAAqB,CAACD,EAC5C,MAAM,IAAIK,CAEd,EAEMC,EAA0B,CAAC,CAC/B,QAAAN,EACA,kBAAAC,EACA,mBAAAC,EACA,eAAAC,EAAiB,EACnB,IAAgC,CAC1B,GAAA,CAACD,GAAsBD,EACnB,MAAA,IAAIG,EAAa,oCAAoC,EAG7D,GAAI,CAACD,GAAkB,CAACD,GAAsB,CAACF,EAC7C,MAAM,IAAIK,CAEd,EAEME,EAAsBX,GAAoC,CACxD,MAAAY,EAAS,EAAQC,EAAM,OACvBC,EAAU,EAAQD,EAAM,QAE1BD,EACFT,EAAuBH,CAAK,EACnBc,GACTJ,EAAwBV,CAAK,CAEjC,EAEae,EAAoB,MAAOf,IACfgB,EAAA,EACvBL,EAAmBX,CAAK,EAsBjB,MApBQ,EAAQa,EAAM,OAGzBpB,EACEoB,EAAM,OACN,SACAxB,EACA4B,EACAC,EACA,8BAAA,EAEFzB,EACEoB,EAAM,QACN,UACAtB,EACA4B,EACAC,EACA,wCACF,GAEgBpB,CAAK"}